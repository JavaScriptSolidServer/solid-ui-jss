import*as e from"rdflib";var t={52(e,t,n){n.r(t),n.d(t,{AJARImage:()=>T,RDFComparePredicateObject:()=>B,RDFComparePredicateSubject:()=>D,addLoadEvent:()=>k,ancestor:()=>A,beep:()=>f,clearVariableNames:()=>p,emptyNode:()=>w,escapeForXML:()=>P,findPos:()=>_,genUuid:()=>m,getAbout:()=>x,getEyeFocus:()=>S,getTarget:()=>b,getTerm:()=>E,hashColor:()=>h,include:()=>C,label:()=>c.P,labelForXML:()=>N,labelWithOntology:()=>I,newVariableName:()=>d,ontologyLabel:()=>L,predParentOf:()=>U,predicateLabel:()=>M,predicateLabelForXML:()=>O,shortName:()=>R,stackString:()=>y,syncTableToArray:()=>g,syncTableToArrayReOrdered:()=>v});var r,i=n(4158),a=n(5175),o=n(1795),s=n(4961),c=n(9612),l={log:i,ns:o.A,rdf:s},u=0;function d(){return"v"+u++}function p(){u=0}function f(){if(r){var e=new r;return function(t,n,r,i){t=+(t||.3),r=r||"sine","function"!=typeof i&&(i=function(){});var a=e.createOscillator();a.type=r,a.frequency.value=n||256,a.connect(e.destination),a.start(0),a.stop(t)}}}function h(e){e=e.uri||e;var t;return"#"+(16777215&(t=e,t.split("").reduce(function(e,t){return(e=(e<<5)-e+t.charCodeAt(0))&e},0))|12632256).toString(16)}function m(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function g(e,t,n){var r,i,a;for(a=0;a<e.children.length;a++)(i=e.children[a]).trashMe=!0;for(var o=0;o<t.length;o++){var s=t[o];for(r=!1,a=0;a<e.children.length;a++)if((i=e.children[a]).subject&&i.subject.sameTerm(s)){i.trashMe=!1,r=!0;break}if(!r){var c=n(s);if(o>=e.children.length)e.appendChild(c);else{var l=e.children[o];e.insertBefore(c,l)}c.subject=s}}for(a=0;a<e.children.length;a++)(i=e.children[a]).trashMe&&e.removeChild(i)}function v(e,t,n){for(var r={},i=0;i<e.children.length;i++){var a=e.children[i];r[a.subject.toNT()]=a}for(var o=0;o<t.length;o++){var s=t[o];if(o>=e.children.length){var c=n(s);c.subject=s,e.appendChild(c)}else{var l=e.children[o];if(l.subject.sameTerm(s));else{var u=r[s.toNT()];if(u)e.removeChild(u),e.insertBefore(u,l);else{var d=n(s);l.before(d),d.subject=s}}}}for(;e.children.length>t.length;)e.removeChild(e.children[e.children.length-1])}function y(e){var t,n=e+"\n";if(!e.stack)return n+"No stack available.\n";var r=e.stack.toString().split("\n"),i=[];for(t=0;t<r.length;t++){var a=r[t];if(a.indexOf("ecmaunit.js")>-1)break;"("===a.charAt(0)&&(a="function"+a);var o=a.split("@");i.push(o)}for(t=0;t<i.length;t++)n+="  "+i[t][1]+"\n    "+i[t][0];return n}function w(e){for(var t=e.childNodes,n=t.length-1;n>=0;n--)e.removeChild(t[n]);return e}function b(e){var t;return(e=e||window.event).target?t=e.target:e.srcElement&&(t=e.srcElement),3===t.nodeType&&(t=t.parentNode),t}function A(e,t){var n;for(n=e;n;n=n.parentNode)try{if(n.tagName===t)return n}catch(e){return}}function x(e,t){var n,r;for(n=t;n&&1===n.nodeType;n=n.parentNode)if(r=n.getAttribute("about"))return e.fromNT(r);l.log.debug("getAbout: No about found")}function E(e){var t=e.parentNode,n=t?t.AJAR_statement:void 0;switch(n?e.className:""){case"pred":case"pred selected":return n.predicate;case"obj":case"obj selected":return t.AJAR_inverse?n.subject:n.object;case"":case"selected":return x(a.M_,e);case"undetermined selected":return e.nextSibling?n.predicate:t.AJAR_inverse?n.subject:n.object}}function C(e,t){var n=e.createElement("script");return n.setAttribute("type","text/javascript"),n.setAttribute("src",t),n}function k(e){var t=window.onload;"function"!=typeof window.onload?window.onload=e:window.onload=function(){t(),e()}}function _(e){var t=e.ownerDocument.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return[n.left-t.left,n.top-t.top]}function S(e,t,n,r){r||(r=window);var i=_(e)[1],a=window.SolidAppContext||{},o=i-(a&&a.scroll||52)-r.scrollY;if(t)return n?void r.scrollBy(0,i+e.clientHeight-(r.scrollY+r.innerHeight)):void r.scrollBy(0,o);var s=r.setInterval(function(){r.scrollBy(0,o/10),10===++c&&r.clearInterval(s)},50),c=0}function T(e,t,n,r){r||(r=document);var i=r.createElement("img");return i.setAttribute("src",e),i.addEventListener("copy",function(e){e.clipboardData.setData("text/plain",""),e.clipboardData.setData("text/html",""),e.preventDefault()}),void 0!==n&&i.setAttribute("title",n),i}function R(e){var t=e;"#/".indexOf(t[t.length-1])>=0&&(t=t.slice(0,-1));var n,r=[];for(var i in this.prefixes)r[this.prefixes[i]]=i;var a,o=function(e){return"ns"!==e&&(n=e,!0)},s=t.lastIndexOf("#");for(s>=0&&(t=t.slice(s-1));;){var c=t.lastIndexOf("/");for(c>=0&&(t=t.slice(c+1)),a=0;a<t.length&&this.prefixchars.indexOf(t[a]);)a++;if((t=t.slice(0,a)).length<6&&o(t))return n;if(o(t.slice(0,3)))return n;if(o(t.slice(0,2)))return n;if(o(t.slice(0,4)))return n;if(o(t.slice(0,1)))return n;if(o(t.slice(0,5)))return n;for(a=0;;a++)if(o(t.slice(0,3)+a))return n}}function L(e){if(void 0===e.uri)return"??";var t,n=e.uri,r=[],i=n.lastIndexOf("#");if(i>=0)n=n.slice(0,i+1);else{if(!((i=n.lastIndexOf("/"))>=0))return e.uri+"?!";n=n.slice(0,i+1)}for(var a in l.ns)r[l.ns[a]]=a;try{return r[n]}catch(e){}for(n=n.slice(0,-1);n;){if(!((i=n.lastIndexOf("/"))>=0))return e.uri+"!?";if(t=n.slice(i+1),n=n.slice(0,i),"ns"!==t&&"0123456789".indexOf(t[0])<0)return t}}function I(e,t){var n=a.M_.findTypeURIs(e);return n[l.ns.rdf("Predicate").uri]||n[l.ns.rdfs("Class").uri]?(0,c.P)(e,t)+" ("+L(e)+")":(0,c.P)(e,t)}function P(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;")}function N(e){return P((0,c.P)(e))}function O(e,t){return P(M(e,t))}function M(e,t){var n=(0,c.P)(e);if(t){var r=a.M_.any(e,l.ns.owl("inverseOf"))||a.M_.any(void 0,l.ns.owl("inverseOf"),e);return r?(0,c.P)(r):"type"===n?"...":"is "+n+" of"}return n}function B(e,t){var n=e.predicate.compareTerm(t.predicate);return 0!==n?n:e.object.compareTerm(t.object)}function D(e,t){var n=e.predicate.compareTerm(t.predicate);return 0!==n?n:e.subject.compareTerm(t.subject)}function U(e){for(var t=e;;){if(t.getAttribute("predTR"))return t;if(!t.previousSibling||"TR"!==t.previousSibling.nodeName)return l.log.error("Could not find predParent"),e;t=t.previousSibling}}"undefined"!=typeof AudioContext?r=AudioContext:"undefined"!=typeof window&&(r=window.AudioContext||window.webkitAudioContext)},202(e,t,n){function r(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}n.d(t,{A:()=>r})},386(e,t,n){n.d(t,{DK:()=>o,Zn:()=>c,eB:()=>s});var r=n(7423),i=n(6355),a=n(675);function o(e,t,n){var i=function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"},o=function(e){r.Rm("dragenter event dropEffect: "+e.dataTransfer.dropEffect),this.localStyle&&(this.savedStyle||(this.savedStyle=a.i.dragEvent)),e.dataTransfer.dropEffect="link",r.Rm("dragenter event dropEffect 2: "+e.dataTransfer.dropEffect)},s=function(e){r.Rm("dragleave event dropEffect: "+e.dataTransfer.dropEffect),this.savedStyle?this.localStyle=this.savedStyle:this.localStyle=a.i.dropEvent},c=function(e){e.preventDefault&&e.preventDefault(),r.Rm("Drop event. dropEffect: "+e.dataTransfer.dropEffect),r.Rm("Drop event. types: "+(e.dataTransfer.types?e.dataTransfer.types.join(", "):"NOPE"));var i,o=null;if(e.dataTransfer.types){for(var s=0;s<e.dataTransfer.types.length;s++){var c=e.dataTransfer.types[s];if("text/uri-list"===c)o=e.dataTransfer.getData(c).split("\n"),r.Rm("Dropped text/uri-list: "+o);else if("text/plain"===c)i=e.dataTransfer.getData(c);else if("Files"===c&&n){for(var l=e.dataTransfer.files,u=0;l[u];u++){var d=l[u];r.Rm("Filename: "+d.name+", type: "+(d.type||"n/a")+" size: "+d.size+" bytes, last modified: "+(d.lastModifiedDate?d.lastModifiedDate.toLocaleDateString():"n/a"))}n(l)}}null===o&&i&&"http"===i.slice(0,4)&&(o=i,r.Rm("Waring: Poor man's drop: using text for URI"))}else o=[e.dataTransfer.getData("Text")],r.Rm("WARNING non-standard drop event: "+o[0]);return r.Rm("Dropped URI list (2): "+o),o&&t(o),this.localStyle=a.i.restoreStyle,!1};!function(e){e||r.Rm("@@@ addTargetListeners: ele "+e),e.addEventListener("dragover",i),e.addEventListener("dragenter",o),e.addEventListener("dragleave",s),e.addEventListener("drop",c)}(e)}function s(e,t){e.setAttribute("draggable","true"),e.addEventListener("dragstart",function(n){e.style.fontWeight="bold",n.dataTransfer.setData("text/uri-list",t.uri),n.dataTransfer.setData("text/plain",t.uri),n.dataTransfer.setData("text/html",e.outerHTML),r.Rm("Dragstart: "+e+" -> "+t+"de: "+n.dataTransfer.dropEffect)},!1),e.addEventListener("drag",function(e){e.preventDefault(),e.stopPropagation()},!1),e.addEventListener("dragend",function(n){e.style.fontWeight="normal",r.Rm("Dragend dropeffect: "+n.dataTransfer.dropEffect),r.Rm("Dragend: "+e+" -> "+t)},!1)}function c(e,t,n,a,o){for(var s=0;t[s];s++){var c=t[s];r.Rm(" dropped: Filename: "+c.name+", type: "+(c.type||"n/a")+" size: "+c.size+" bytes, last modified: "+(c.lastModifiedDate?c.lastModifiedDate.toLocaleDateString():"n/a"));var l=new FileReader;l.onload=function(t){return function(s){var c=s.target.result,l="";r.Rm(" File read byteLength : "+c.byteLength);var u=t.type;if(t.type&&""!==t.type){var d=i.ck(t.type);d&&"false"!==d&&!t.name.endsWith("."+d)&&t.type!==i.$I(t.name)&&(l="_."+d)}else if(!(u=i.$I(t.name))){var p="Filename needs to have an extension which gives a type we know: "+t.name;throw r.Rm(p),alert(p),new Error(p)}var f=t.type.startsWith("image/")&&a||n,h=f+(f.endsWith("/")?"":"/")+encodeURIComponent(t.name)+l;e.webOperation("PUT",h,{data:c,contentType:u}).then(function(e){r.Rm(" Upload: put OK: "+h),o(t,h)},function(e){var t=" Upload: FAIL "+h+", Error: "+e;throw r.Rm(t),alert(t),new Error(t)})}}(c),l.readAsArrayBuffer(c)}}},467(e,t,n){function r(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,a){var o=e.apply(t,n);function s(e){r(o,i,a,s,c,"next",e)}function c(e){r(o,i,a,s,c,"throw",e)}s(void 0)})}}n.d(t,{A:()=>i})},519(e,t,n){function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{A:()=>r})},579(e,t,n){var r=n(3738).default;e.exports=function(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(r(e)+" is not iterable")},e.exports.__esModule=!0,e.exports.default=e.exports},580(e){
/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */
var t=/["'&<>]/;e.exports=function(e){var n,r=""+e,i=t.exec(r);if(!i)return r;var a="",o=0,s=0;for(o=i.index;o<r.length;o++){switch(r.charCodeAt(o)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 39:n="&#39;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;default:continue}s!==o&&(a+=r.substring(s,o)),s=o+1,a+=n}return s!==o?a+r.substring(s,o):a}},588(e,t,n){n.d(t,{t:()=>s});var r,i=n(4467),a=n(1795),o=n(675),s=(r={},(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(r,a.A.ui("ColorField").uri,{size:9,type:"color",style:"height: 3em;",dt:"color",pattern:/^\s*#[0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f][0-9a-f]([0-9a-f][0-9a-f])?\s*$/}),a.A.ui("DateField").uri,{size:20,type:"date",dt:"date",pattern:/^\s*[0-9][0-9][0-9][0-9](-[0-1]?[0-9]-[0-3]?[0-9])?Z?\s*$/}),a.A.ui("DateTimeField").uri,{size:20,type:"datetime-local",dt:"dateTime",pattern:/^\s*[0-9][0-9][0-9][0-9](-[0-1]?[0-9]-[0-3]?[0-9])?(T[0-2][0-9]:[0-5][0-9](:[0-5][0-9])?)?Z?\s*$/}),a.A.ui("TimeField").uri,{size:10,type:"time",dt:"time",pattern:/^\s*([0-2]?[0-9]:[0-5][0-9](:[0-5][0-9])?)\s*$/}),a.A.ui("IntegerField").uri,{size:12,style:"text-align: right;",dt:"integer",pattern:/^\s*-?[0-9]+\s*$/}),a.A.ui("DecimalField").uri,{size:12,style:"text-align: right;",dt:"decimal",pattern:/^\s*-?[0-9]*(\.[0-9]*)?\s*$/}),a.A.ui("FloatField").uri,{size:12,style:"text-align: right;",dt:"float",pattern:/^\s*-?[0-9]*(\.[0-9]*)?((e|E)-?[0-9]*)?\s*$/}),a.A.ui("SingleLineTextField").uri,{}),a.A.ui("NamedNodeURIField").uri,{namedNode:!0}),a.A.ui("TextField").uri,{}),(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)(r,a.A.ui("PhoneField").uri,{size:20,uriPrefix:"tel:",pattern:/^\+?[\d-]+[\d]*$/}),a.A.ui("EmailField").uri,{size:30,uriPrefix:"mailto:",pattern:/^\s*.*@.*\..*\s*$/}),a.A.ui("Group").uri,{style:o.i.formGroupStyle}),a.A.ui("Comment").uri,{element:"p",style:o.i.commentStyle}),a.A.ui("Heading").uri,{element:"h3",style:o.i.formHeadingStyle}))},615(e,t,n){n.d(t,{Ak:()=>c,UT:()=>x,Xf:()=>b,fH:()=>w,hT:()=>y,u0:()=>s});var r=n(1848),i=n(8030);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const a=BigInt(0),o=BigInt(1);function s(e,t){const n=t.negate();return e?n:t}function c(e,t){const n=(0,i.pS)(e.Fp,t.map(e=>e.Z));return t.map((t,r)=>e.fromAffine(t.toAffine(n[r])))}function l(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function u(e,t){l(e,t);const n=2**e;return{windows:Math.ceil(t/e)+1,windowSize:2**(e-1),mask:(0,r.OG)(e),maxNumber:n,shiftBy:BigInt(e)}}function d(e,t,n){const{windowSize:r,mask:i,maxNumber:a,shiftBy:s}=n;let c=Number(e&i),l=e>>s;c>r&&(c-=a,l+=o);const u=t*r;return{nextN:l,offset:u+Math.abs(c)-1,isZero:0===c,isNeg:c<0,isNegF:t%2!=0,offsetF:u}}function p(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((e,n)=>{if(!(e instanceof t))throw new Error("invalid point at index "+n)})}function f(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((e,n)=>{if(!t.isValid(e))throw new Error("invalid scalar at index "+n)})}const h=new WeakMap,m=new WeakMap;function g(e){return m.get(e)||1}function v(e){if(e!==a)throw new Error("invalid wNAF")}class y{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,n=this.ZERO){let r=e;for(;t>a;)t&o&&(n=n.add(r)),r=r.double(),t>>=o;return n}precomputeWindow(e,t){const{windows:n,windowSize:r}=u(t,this.bits),i=[];let a=e,o=a;for(let e=0;e<n;e++){o=a,i.push(o);for(let e=1;e<r;e++)o=o.add(a),i.push(o);a=o.double()}return i}wNAF(e,t,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let r=this.ZERO,i=this.BASE;const a=u(e,this.bits);for(let e=0;e<a.windows;e++){const{nextN:o,offset:c,isZero:l,isNeg:u,isNegF:p,offsetF:f}=d(n,e,a);n=o,l?i=i.add(s(p,t[f])):r=r.add(s(u,t[c]))}return v(n),{p:r,f:i}}wNAFUnsafe(e,t,n,r=this.ZERO){const i=u(e,this.bits);for(let e=0;e<i.windows&&n!==a;e++){const{nextN:a,offset:o,isZero:s,isNeg:c}=d(n,e,i);if(n=a,!s){const e=t[o];r=r.add(c?e.negate():e)}}return v(n),r}getPrecomputes(e,t,n){let r=h.get(t);return r||(r=this.precomputeWindow(t,e),1!==e&&("function"==typeof n&&(r=n(r)),h.set(t,r))),r}cached(e,t,n){const r=g(e);return this.wNAF(r,this.getPrecomputes(r,e,n),t)}unsafe(e,t,n,r){const i=g(e);return 1===i?this._unsafeLadder(e,t,r):this.wNAFUnsafe(i,this.getPrecomputes(i,e,n),t,r)}createCache(e,t){l(t,this.bits),m.set(e,t),h.delete(e)}hasCache(e){return 1!==g(e)}}function w(e,t,n,r){let i=t,s=e.ZERO,c=e.ZERO;for(;n>a||r>a;)n&o&&(s=s.add(i)),r&o&&(c=c.add(i)),i=i.double(),n>>=o,r>>=o;return{p1:s,p2:c}}function b(e,t,n,i){p(n,e),f(i,t);const a=n.length,o=i.length;if(a!==o)throw new Error("arrays of points and scalars must have equal length");const s=e.ZERO,c=(0,r.dJ)(BigInt(a));let l=1;c>12?l=c-3:c>4?l=c-2:c>0&&(l=2);const u=(0,r.OG)(l),d=new Array(Number(u)+1).fill(s);let h=s;for(let e=Math.floor((t.BITS-1)/l)*l;e>=0;e-=l){d.fill(s);for(let t=0;t<o;t++){const r=i[t],a=Number(r>>BigInt(e)&u);d[a]=d[a].add(n[t])}let t=s;for(let e=d.length-1,n=s;e>0;e--)n=n.add(d[e]),t=t.add(n);if(h=h.add(t),0!==e)for(let e=0;e<l;e++)h=h.double()}return h}function A(e,t,n){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return(0,i.jr)(t),t}return(0,i.D0)(e,{isLE:n})}function x(e,t,n={},r){if(void 0===r&&(r="edwards"===e),!t||"object"!=typeof t)throw new Error(`expected valid ${e} CURVE object`);for(const e of["p","n","h"]){const n=t[e];if(!("bigint"==typeof n&&n>a))throw new Error(`CURVE.${e} must be positive bigint`)}const i=A(t.p,n.Fp,r),o=A(t.n,n.Fn,r),s=["Gx","Gy","a","weierstrass"===e?"b":"d"];for(const e of s)if(!i.isValid(t[e]))throw new Error(`CURVE.${e} must be valid field element of CURVE.Fp`);return{CURVE:t=Object.freeze(Object.assign({},t)),Fp:i,Fn:o}}},675(e,t,n){n.d(t,{i:()=>i});var r=n(4762),i={checkboxStyle:"color: black; font-size: 100%; padding-left: 0.5 em; padding-right: 0.5 em;",checkboxInputStyle:"font-size: 150%; height: 1.2em; width: 1.2em; background-color: #eef; border-radius:0.2em; margin: 0.1em;",fieldLabelStyle:"color: #3B5998; text-decoration: none;",formSelectStyle:"background-color: #eef; padding: 0.5em;  border: .05em solid #88c; border-radius:0.2em; font-size: 100%; margin:0.4em;",textInputStyle:"background-color: #eef; padding: 0.5em;  border: .05em solid #88c; border-radius:0.2em; font-size: 100%; margin:0.4em;",textInputStyleUneditable:"background-color: white; padding: 0.5em;  border: .05em solid white; border-radius:0.2em; font-size: 100%; margin:0.4em;",buttonStyle:"background-color: #fff; padding: 0.7em;  border: .01em solid white; border-radius:0.2em; font-size: 100%; margin: 0.3em;",commentStyle:"padding: 0.7em;  border: none; font-size: 100%; white-space: pre-wrap;",iconStyle:"width: 3em; height: 3em; margin: 0.1em; border-radius: 1em;",smallButtonStyle:"margin: 0.2em; width: 1em; height:1em;",classIconStyle:"width: 3em; height: 3em; margin: 0.1em; border-radius: 0.2em; border: 0.1em solid green; padding: 0.2em; background-color: #efe;",confirmPopupStyle:"padding: 0.7em; border-radius: 0.2em; border: 0.1em solid orange; background-color: white; box-shadow: 0.5em 0.9em #888;",messageBodyStyle:"white-space: pre-wrap; width: 99%; font-size:100%; border: 0.07em solid #eee; border-radius:0.2em; padding: .3em 0.5em; margin: 0.1em;",pendingeditModifier:"color: #bbb;",personaBarStyle:"width: 100%; height: 4em; background-color: #eee; vertical-align: middle;",searchInputStyle:"border: 0.1em solid #444; border-radius: 0.2em; width: 100%; font-size: 100%; padding: 0.1em 0.6em; margin 0.2em;",autocompleteRowStyle:"border: 0.2em solid straw;",signInAndUpButtonStyle:"padding: 1em; border-radius:0.2em; font-size: 100%;",headerBannerLoginInput:"margin: 0.75em 0 0.75em 0.5em !important; padding: 0.5em !important;",signUpBackground:"background-color: #eef;",signInBackground:"background-color: #efe;",heading1Style:"font-size: 180%; font-weight: bold; color: #888888; padding: 0.5em; margin: 0.7em 0.0m;",heading2Style:"font-size: 130%; font-weight: bold; color: #888888; padding: 0.4em; margin: 0.7em 0.0em;",heading3Style:"font-size: 120%; font-weight: bold; color: #888888; padding: 0.3em; margin: 0.7em 0.0em;",heading4Style:"font-size: 110%; font-weight: bold; color: #888888; padding: 0.2em; margin: 0.7em 0.0em;",formHeadingStyle:"font-size: 110%; font-weight: bold; color: #888888; padding: 0.2em;  margin: 0.7em 0.0em;",formTextInput:"font-size: 100%; margin: 0.1em; padding: 0.1em;",formGroupStyle:["padding-left: 0em; border: 0.0em solid ".concat(r.A.formBorderColor,"; border-radius: 0.2em;"),"padding-left: 2em; border: 0.05em solid ".concat(r.A.formBorderColor,"; border-radius: 0.2em;"),"padding-left: 2em; border: 0.1em solid ".concat(r.A.formBorderColor,"; border-radius: 0.2em;"),"padding-left: 2em; border: 0.2em solid ".concat(r.A.formBorderColor,"; border-radius: 0.2em;")],formFieldLabelStyle:"color: ".concat(r.A.lowProfileLinkColor,"; text-decoration: none;"),formFieldNameBoxStyle:"padding: 0.3em; vertical-align: middle; width:".concat(r.A.formFieldNameBoxWidth,";"),multilineTextInputStyle:"font-size:100%; white-space: pre-wrap; background-color: #eef; border: 0.07em solid gray; padding: 1em 0.5em; margin: 1em 1em;",renderAsDivStyle:"display: flex; align-items: center; justify-content: space-between; height: 2.5em; padding: 1em;",imageDivStyle:"width:2.5em; padding:0.5em; height: 2.5em;",linkDivStyle:"width:2em; padding:0.5em; height: 4em;",aclControlBoxContainer:"margin: 1em;",aclControlBoxHeader:"font-size: 120%; margin: 0 0 1rem;",aclControlBoxStatus:"display: none; margin: 1rem 0;",aclControlBoxStatusRevealed:"display: block;",aclGroupContent:"maxWidth: 650;",accessGroupList:"display: grid; grid-template-columns: 1fr; margin: 1em; width: 100%;",accessGroupListItem:"display: grid; grid-template-columns: 100px auto 30%;",defaultsController:"display: flex;",defaultsControllerNotice:"color: #888; flexGrow: 1; fontSize: 80%;",bigButton:"background-color: white; border: 0.1em solid #888; border-radius: 0.3em; max-width: 50%; padding-bottom: 1em; padding-top: 1em;",group:"color: #888;",group1:"color: green;",group2:"color: #cc0;",group3:"color: orange;",group5:"color: red;",group9:"color: blue;",group13:"color: purple;",trustedAppAddApplicationsTable:"background-color: #eee;",trustedAppCancelButton:"float: right;",trustedAppControllerI:"border-color: orange; border-radius: 1em; border-width: 0.1em;",temporaryStatusInit:"background: green;",temporaryStatusEnd:"background: transparent; transition: background 5s linear;",headerUserMenuLink:"background: none; border: 0; color: black; cursor: pointer; display: block; font-family: Arial; font-size: 1em; text-align: left; padding: 1em;  width: 100%; text-decoration: none;",headerUserMenuLinkHover:"background: none; border: 0; color: black; cursor: pointer; display: block; font-family: Arial; font-size: 1em; text-align: left; padding: 1em;  width: 100%; text-decoration: none; background-image: linear-gradient(to right, #7C4DFF 0%, #18A9E6 50%, #01C9EA 100%);",headerUserMenuTrigger:"background: none; border: 0; cursor: pointer; width: 60px; height: 60px;",headerUserMenuTriggerImg:"border-radius: 50%; height: 56px; width: 28px !important;",headerUserMenuButton:"background: none; border: 0; color: black; cursor: pointer; display: block; font-family: Arial; font-size: 1em; text-align: left; padding: 1em; width: 100%;",headerUserMenuButtonHover:"background: none; border: 0; color: black; cursor: pointer; display: block; font-family: Arial; font-size: 1em; text-align: left; padding: 1em; width: 100%; background-image: linear-gradient(to right, #7C4DFF 0%, #18A9E6 50%, #01C9EA 100%);",headerUserMenuList:"list-style: none; margin: 0; padding: 0;",headerUserMenuListDisplay:"list-style: none; margin: 0; padding: 0; display:true;",headerUserMenuNavigationMenu:"background: white; border: solid 1px #000000; border-right: 0; position: absolute; right: 0; top: 60px; width: 200px; z-index: 1; display: true;",headerUserMenuNavigationMenuNotDisplayed:"background: white; border: solid 1px #000000; border-right: 0; position: absolute; right: 0; top: 60px; width: 200px; z-index: 1; display: none;",headerUserMenuListItem:"border-bottom: solid 1px #000000;",headerUserMenuPhoto:"border-radius: 50%; background-position: center; background-repeat: no-repeat; background-size: cover; height: 50px; width: 50px;",headerBanner:"box-shadow: 0px 1px 4px #000000; display: flex; justify-content: space-between; padding: 0 1.5em; margin-bottom: 4px;",headerBannerLink:"display: block;",headerBannerRightMenu:"display: flex;",headerBannerLogin:"margin-left: auto;",allChildrenVisible:"display:true;",headerBannerUserMenu:"border-left: solid 1px #000000; margin-left: auto;",headerBannerHelpMenu:"border-left: solid 1px #000000; margin-left: auto;",headerBannerIcon:"background-size: 65px 60px !important; height: 60px !important; width: 65px !important;",footer:"border-top: solid 1px $divider-color; font-size: 0.9em; padding: 0.5em 1.5em;",primaryButton:"background-color: #7c4dff; color: #ffffff; font-family: Raleway, Roboto, sans-serif; border-radius: 0.25em; border-color: #7c4dff; border: 1px solid; cursor: pointer; font-size: .8em; text-decoration: none; padding: 0.5em 4em; transition: 0.25s all ease-in-out; outline: none;",primaryButtonHover:"background-color: #9f7dff; color: #ffffff; font-family: Raleway, Roboto, sans-serif;border-radius: 0.25em; border-color: #7c4dff; border: 1px solid; cursor: pointer; font-size: .8em; text-decoration: none; padding: 0.5em 4em; transition: 0.25s all ease-in-out; outline: none; transition: 0.25s all ease-in-out;",primaryButtonNoBorder:"background-color: #ffffff; color: #7c4dff; font-family: Raleway, Roboto, sans-serif;border-radius: 0.25em; border-color: #7c4dff; border: 1px solid; cursor: pointer; font-size: .8em; text-decoration: none; padding: 0.5em 4em; transition: 0.25s all ease-in-out; outline: none;",primaryButtonNoBorderHover:"background-color: #7c4dff; color: #ffffff; font-family: Raleway, Roboto, sans-serif; border-radius: 0.25em; border-color: #7c4dff; border: 1px solid; cursor: pointer; font-size: .8em; text-decoration: none; padding: 0.5em 4em; transition: 0.25s all ease-in-out; outline: none; transition: 0.25s all ease-in-out;",secondaryButton:"background-color: #01c9ea; color: #ffffff; font-family: Raleway, Roboto, sans-serif;border-radius: 0.25em; border-color: #01c9ea; border: 1px solid; cursor: pointer; font-size: .8em; text-decoration: none; padding: 0.5em 4em; transition: 0.25s all ease-in-out; outline: none;",secondaryButtonHover:"background-color: #37cde6; color: #ffffff; font-family: Raleway, Roboto, sans-serif;border-radius: 0.25em; border-color: #7c4dff; border: 1px solid; cursor: pointer; font-size: .8em; text-decoration: none; padding: 0.5em 4em; transition: 0.25s all ease-in-out; outline: none; transition: 0.25s all ease-in-out;",secondaryButtonNoBorder:"background-color: #ffffff; color: #01c9ea; font-family: Raleway, Roboto, sans-serif; border-radius: 0.25em; border-color: #01c9ea; border: 1px solid; cursor: pointer; font-size: .8em; text-decoration: none; padding: 0.5em 4em; transition: 0.25s all ease-in-out; outline: none;",secondaryButtonNoBorderHover:"background-color: #01c9ea; color: #ffffff; font-family: Raleway, Roboto, sans-serif; border-radius: 0.25em; border-color: #01c9ea; border: 1px solid; cursor: pointer; font-size: .8em; text-decoration: none; padding: 0.5em 4em; transition: 0.25s all ease-in-out; outline: none; transition: 0.25s all ease-in-out;",controlStyle:"border-radius: 0.5em; margin: 0.8em; width:".concat(r.A.mediaModuleCanvasWidth,"; height:").concat(r.A.mediaModuleCanvasHeight,";"),dragEvent:"background-color: #ccc; border: 0.25em dashed black; border-radius: 0.3em;",dropEvent:"background-color: white; border: 0em solid black;",restoreStyle:"background-color: white;",errorCancelButton:"width: 2em; height: 2em; align: right;",errorMessageBlockStyle:"margin: 0.1em; padding: 0.5em; border: 0.05em solid gray; color:black;",notepadStyle:"padding: 1em; overflow: auto; resize: horizontal; min-width: 40em;",upstreamStatus:"width: 50%;",downstreamStatus:"width: 50%;",baseStyle:"font-size: 100%; font-family: monospace; width: 100%; border: none; white-space: pre-wrap;",headingCore:"font-family: sans-serif; font-weight: bold;  border: none;",headingStyle:["font-size: 110%; padding-top: 0.5em; padding-bottom: 0.5em; width: 100%;","font-size: 120%; padding-top: 1em; padding-bottom: 1em; width: 100%;","font-size: 150%; padding-top: 1em; padding-bottom: 1em; width: 100%;"],participantsStyle:"margin: 0.8em;",participantsBlock:"height: 1.5em; width: 1.5em; margin: 0.3em; border 0.01em solid #888;",personTableTD:"vertical-align: middle;",tabsNavElement:"margin: 0;",tabsRootElement:"display: flex; height: 100%; width: 100%;",tabsMainElement:"margin: 0; width:100%; height: 100%;",tabContainer:"list-style-type: none; display: flex; height: 100%; width: 100%; margin: 0; padding: 0;",makeNewSlot:"background: none; border: none; font: inherit; cursor: pointer;",ellipsis:"position: absolute; right: 0; bottom: 0; width: 20%; background: none; color: inherit; border: none; padding: 0; font: inherit; cursor: pointer; outline: inherit;",setStyle:function(e,t){e.style=i[t]}}},887(e,t,n){var r=n(6993),i=n(1791);e.exports=function(e,t,n,a,o){return new i(r().w(e,t,n,a),o||Promise)},e.exports.__esModule=!0,e.exports.default=e.exports},967(e,t,n){n.r(t),n.d(t,{ensureLoadedPreferences:()=>R,ensureLoadedProfile:()=>I,ensureLoggedIn:()=>T,filterAvailablePanes:()=>q,findAppInstances:()=>N,getUserRoles:()=>$,loginStatusBox:()=>W,newAppInstance:()=>z,registrationControl:()=>B,registrationList:()=>F,renderScopeHeadingRow:()=>U,renderSignInPopup:()=>H,scopeLabel:()=>M,selectWorkspace:()=>V});var r=n(467),i=n(4756),a=n.n(i),o=n(4961),s=n(5175),c=n(7423),l=n(675),u=n(4158),d=n(1795),p=n(6247),f=n(9612),h=n(3291),m=n(3468),g=n(1763);function v(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return y(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}s.hV.store;var w=s.hV.profile,b=w.loadPreferences,A=w.loadProfile,x=s.hV.typeIndex,E=x.getScopedAppInstances,C=x.getRegistrations,k=x.loadAllTypeIndexes,_=x.getScopedAppsFromIndex,S=x.deleteTypeIndexRegistration;function T(e){var t=s.jO.currentUser();return t?(s.jO.saveUser(t,e),Promise.resolve(e)):new Promise(function(t){s.jO.checkUser().then(function(n){if(n)return c.Rm("logIn: Already logged in as ".concat(n)),t(e);if(!e.div||!e.dom)return t(e);var r=W(e.dom,function(n){s.jO.saveUser(n,e),t(e)});e.div.appendChild(r)})})}function R(e){return L.apply(this,arguments)}function L(){return(L=(0,r.A)(a().mark(function e(t){var n,r,i;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.preferencesFile){e.next=1;break}return e.abrupt("return",Promise.resolve(t));case 1:return e.prev=1,e.next=2,I(t);case 2:return t=e.sent,e.next=3,b(t.me);case 3:n=e.sent,t.preferencesFile=n,e.next=11;break;case 4:if(e.prev=4,!((i=e.catch(1))instanceof s.D_)){e.next=5;break}r="Oops â€” you are not authenticated (properly logged in), so SolidOS cannot read your preferences file. Try logging out and then logging back in.",(0,u.alert)(r),e.next=11;break;case 5:if(!(i instanceof s.Un)){e.next=6;break}return r="Unauthorized: Assuming preference file blocked for origin ".concat(window.location.origin),t.preferencesFileError=r,e.abrupt("return",t);case 6:if(!(i instanceof s.sN)){e.next=7;break}return r="You are not authorized to read your preference file. This may be because you are using an untrusted web app.",c.R8(r),e.abrupt("return",t);case 7:if(!(i instanceof s.ML)){e.next=8;break}return r="You are not authorized to edit your preference file. This may be because you are using an untrusted web app.",c.R8(r),e.abrupt("return",t);case 8:if(!(i instanceof s.ac)){e.next=9;break}r="You are not authorized to edit your preference file. This may be because you are using an untrusted web app.",c.R8(r),e.next=11;break;case 9:if(!(i instanceof s.fk)){e.next=10;break}r="Strange: Error ".concat(i.status," trying to read your preference file.").concat(i.message),(0,u.alert)(r),e.next=11;break;case 10:throw new Error("(via loadPrefs) ".concat(i));case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}},e,null,[[1,4]])}))).apply(this,arguments)}function I(e){return P.apply(this,arguments)}function P(){return(P=(0,r.A)(a().mark(function e(t){var n,r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.publicProfile){e.next=1;break}return e.abrupt("return",t);case 1:return e.prev=1,e.next=2,T(t);case 2:if((n=e.sent).me){e.next=3;break}throw new Error("Could not log in");case 3:return e.next=4,A(n.me);case 4:t.publicProfile=e.sent,e.next=6;break;case 5:throw e.prev=5,r=e.catch(1),t.div&&t.dom&&t.div.appendChild(m.F(t.dom,r.message)),new Error("Can't log in: ".concat(r));case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}},e,null,[[1,5]])}))).apply(this,arguments)}function N(e,t,n){return O.apply(this,arguments)}function O(){return(O=(0,r.A)(a().mark(function e(t,n,r){var i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.me){e.next=2;break}return e.next=1,E(n,t.me);case 1:o=e.sent,e.next=3;break;case 2:o=[];case 3:return i=o,!0===r?i=i.filter(function(e){return"public"===e.scope.label}):!1===r&&(i=i.filter(function(e){return"private"===e.scope.label})),t.instances=i.map(function(e){return e.instance}),e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function M(e,t){var n=e.me&&e.me.sameTerm(t.agent)?"":f.P(t.agent)+" ";return"".concat(n).concat(t.label)}function B(e,t,n){return D.apply(this,arguments)}function D(){return D=(0,r.A)(a().mark(function e(t,n,r){var i,l,u,p,f,h,y,w,b,A,x,E,_;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l=function(e){var n=i(e.index),r=M(t,e),a="".concat(r," link to this ").concat(t.noun);return g.WY(t.dom,s.hV.store,a,null,n,b,e.index)},i=function(e){var t=C(n,r),i=t.length?t[0]:g.xV(e);return[(0,o.st)(i,d.A.solid("instance"),n,e),(0,o.st)(i,d.A.solid("forClass"),r,e)]},(u=t.dom)&&t.div){e.next=1;break}throw new Error("registrationControl: need dom and div");case 1:if(p=u.createElement("div"),t.div.appendChild(p),t.me=s.jO.currentUser(),f=t.me){e.next=2;break}return p.innerHTML='<p style="margin:2em;">(Log in to save a link to this)</p>',e.abrupt("return",t);case 2:return e.prev=2,e.next=3,k(f);case 3:h=e.sent,e.next=5;break;case 4:return e.prev=4,_=e.catch(2),t.div&&t.preferencesFileError?(y="(Lists of stuff not available)",t.div.appendChild(u.createElement("p")).textContent=y):t.div&&(y="registrationControl: Type indexes not available: ".concat(_),t.div.appendChild(m.F(t.dom,_))),c.Rm(y),e.abrupt("return",t);case 5:p.innerHTML="<table><tbody></tbody></table>",p.setAttribute("style","font-size: 120%; text-align: right; padding: 1em; border: solid gray 0.05em;"),w=p.children[0].children[0],b=new o.BlankNode,A=v(h);try{for(A.s();!(x=A.n()).done;)E=x.value,w.appendChild(u.createElement("tr")).appendChild(l(E))}catch(e){A.e(e)}finally{A.f()}return e.abrupt("return",t);case 6:case"end":return e.stop()}},e,null,[[2,4]])})),D.apply(this,arguments)}function U(e,t,n){var r=e.dom,i=M(e,n),a=r.createElement("tr"),o=a.appendChild(r.createElement("td"));o.setAttribute("colspan","3"),o.style.backgoundColor={private:"#fee",public:"#efe"}[n.label]||"white";var s=o.appendChild(r.createElement("h3"));return s.textContent=i+" links",s.style.textAlign="left",a}function F(e,t){return j.apply(this,arguments)}function j(){return j=(0,r.A)(a().mark(function e(t,n){var i,o,c,l,u,p,f,m,g,y,w,b,A,x,E,C;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.dom,o=t.div,c=i.createElement("div"),o.appendChild(c),t.me=s.jO.currentUser(),t.me){e.next=1;break}return c.innerHTML='<p style="margin:2em;">(Log in list your stuff)</p>',e.abrupt("return",t);case 1:return e.next=2,k(t.me);case 2:l=e.sent,c.innerHTML="<table><tbody></tbody></table>",c.setAttribute("style","font-size: 120%; text-align: right; padding: 1em; border: solid #eee 0.5em;"),u=c.firstChild,p=u.firstChild,f=v(l),e.prev=3,f.s();case 4:if((m=f.n()).done){e.next=13;break}return g=m.value,y=U(t,0,g),p.appendChild(y),e.next=5,_(g,n.type||null);case 5:0===(w=e.sent).length&&(y.style.display="none"),b=v(w),e.prev=6,x=a().mark(function e(){var t,n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=A.value,n=h.Cl(i,d.A.solid("instance"),t.instance,{deleteFunction:function(){var e=(0,r.A)(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,S(t);case 1:p.removeChild(n);case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()}),n.children[0].style.paddingLeft="3em",p.appendChild(n);case 1:case"end":return e.stop()}},e)}),b.s();case 7:if((A=b.n()).done){e.next=9;break}return e.delegateYield(x(),"t0",8);case 8:e.next=7;break;case 9:e.next=11;break;case 10:e.prev=10,E=e.catch(6),b.e(E);case 11:return e.prev=11,b.f(),e.finish(11);case 12:e.next=4;break;case 13:e.next=15;break;case 14:e.prev=14,C=e.catch(3),f.e(C);case 15:return e.prev=15,f.f(),e.finish(15);case 16:return e.abrupt("return",t);case 17:case"end":return e.stop()}},e,null,[[3,14,15,16],[6,10,11,12]])})),j.apply(this,arguments)}function H(e){var t=e.createElement("div");t.setAttribute("style","position: fixed; top: 0; left: 0; right: 0; bottom: 0; display: flex; justify-content: center; align-items: center;"),e.body.appendChild(t);var n=e.createElement("div");n.setAttribute("style","\n      background-color: white;\n      box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\n      -webkit-box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\n      -moz-box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\n      -o-box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.2);\n      border-radius: 4px;\n      min-width: 400px;\n      padding: 10px;\n      z-index : 10;\n    "),t.appendChild(n);var i=e.createElement("div");i.setAttribute("style","\n      border-bottom: 1px solid #DDD;\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      justify-content: space-between;\n    "),n.appendChild(i);var o=e.createElement("label");o.setAttribute("style","margin-right: 5px; font-weight: 800"),o.innerText="Select an identity provider";var c=e.createElement("button");c.innerHTML='<img src="https://solidos.github.io/solid-ui/src/icons/noun_1180156.svg" style="width: 2em; height: 2em;" title="Cancel">',c.setAttribute("style","background-color: transparent; border: none;"),c.addEventListener("click",function(){t.remove()}),i.appendChild(o),i.appendChild(c);var l=function(){var e=(0,r.A)(a().mark(function e(t){var n,r,i;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s.hV.store.updater.flagAuthorizationMetadata(),(n=new URL(window.location.href).hash)&&window.localStorage.setItem("preLoginRedirectHash",n),window.localStorage.setItem("loginIssuer",t),(r=new URL(window.location.href)).hash="",e.next=1,s.lG.login({redirectUrl:r.href,oidcIssuer:t});case 1:e.next=3;break;case 2:e.prev=2,i=e.catch(0),(0,u.alert)(i.message);case 3:case"end":return e.stop()}},e,null,[[0,2]])}));return function(t){return e.apply(this,arguments)}}(),d=e.createElement("div");d.setAttribute("style","\n      border-bottom: 1px solid #DDD;\n      display: flex;\n      flex-direction: column;\n      padding-top: 10px;\n    ");var p=e.createElement("div");p.setAttribute("style","\n      display: flex;\n      flex-direction: row;\n    ");var f=e.createElement("label");f.innerText="Enter the URL of your identity provider:",f.setAttribute("style","color: #888");var h=e.createElement("input");h.setAttribute("type","text"),h.setAttribute("style","margin-left: 0 !important; flex: 1; margin-right: 5px !important"),h.setAttribute("placeholder","https://example.com"),h.value=localStorage.getItem("loginIssuer")||"";var m=e.createElement("button");m.innerText="Go",m.setAttribute("style","margin-top: 12px; margin-bottom: 12px;"),m.addEventListener("click",function(){l(h.value)}),d.appendChild(f),p.appendChild(h),p.appendChild(m),d.appendChild(p),n.appendChild(d);var g=e.createElement("div");g.setAttribute("style","\n      display: flex;\n      flex-direction: column;\n      padding-top: 10px;\n    ");var v=e.createElement("label");v.innerText="Or pick an identity provider from the list below:",v.setAttribute("style","color: #888"),g.appendChild(v),(0,s.I0)().forEach(function(t){var n=e.createElement("button");n.innerText=t.name,n.setAttribute("style","height: 38px; margin-top: 10px"),n.addEventListener("click",function(){l(t.uri)}),g.appendChild(n)}),n.appendChild(g)}function W(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(0,s.TX)(),i=e.createElement("div");function a(e){e&&(r=s.jO.saveUser(e),i.refresh(),t&&t(r.uri))}function o(e){var n=r;s.lG.logout().then(function(){var e="Your WebID was ".concat(n,". It has been forgotten.");r=null;try{(0,u.alert)(e)}catch(t){window.alert(e)}i.refresh(),t&&t(null)},function(e){(0,u.alert)("Fail to log out:"+e)})}function f(){r=s.jO.currentUser(),i.refresh()}return i.refresh=function(){var t=s.lG.info;((r=t&&t.webId&&t.isLoggedIn?s.hV.store.sym(t.webId):null)&&i.me!==r.uri||!r&&i.me)&&(h.EW(i),r?i.appendChild(function(t,n){var r=n.buttonStyle||l.i.signInAndUpButtonStyle,i="WebID logout";if(t){var a=s.hV.store.any(t,d.A.foaf("nick"))||s.hV.store.any(t,d.A.foaf("name"));a&&(i="Logout "+a.value)}var c=e.createElement("input");return c.setAttribute("type","button"),c.setAttribute("value",i),c.setAttribute("style","".concat(r)),c.addEventListener("click",o,!1),c}(r,n)):i.appendChild(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(n=n||{}).buttonStyle||l.i.signInAndUpButtonStyle,i=e.createElement("div"),a="SolidSignInOrSignUpBox";c.Rm("widgets.signInOrSignUpBox"),i.setUserCallback=t,i.setAttribute("class",a),i.setAttribute("style","display:flex;");var o=e.createElement("input");i.appendChild(o),o.setAttribute("type","button"),o.setAttribute("value","Log in"),o.setAttribute("style","".concat(r).concat(l.i.headerBannerLoginInput)+l.i.signUpBackground),s.lG.events.on("login",function(){var t=s.jO.currentUser();if(t){var n=t.uri,r=e.getElementsByClassName(a);c.Rm("Logged in, ".concat(r.length," panels to be serviced"));for(var i=0;i<r.length;i++){var o=r[i];if(o.setUserCallback)try{o.setUserCallback(n);var l=o.parentNode;l&&l.removeChild(o)}catch(t){c.Rm("## Error satisfying login box: ".concat(t)),o.appendChild(m.F(e,t))}}}}),o.addEventListener("click",function(){var n=(0,s.TX)();if(n)return t(n.uri);H(e)},!1);var u=e.createElement("input");return i.appendChild(u),u.setAttribute("type","button"),u.setAttribute("value","Sign Up for Solid"),u.setAttribute("style","".concat(r).concat(l.i.headerBannerLoginInput)+l.i.signInBackground),u.addEventListener("click",function(e){(new p.l).signup().then(function(e){c.Rm("signInOrSignUpBox signed up "+e),t(e)})},!1),i}(e,a,n))),i.me=r?r.uri:null},i.refresh(),f(),s.lG.events.on("login",f),s.lG.events.on("logout",f),i.me="99999",i.refresh(),i}function V(e,t,n){var i=t.noun,u=t.appPathSegment,p=(0,s.TX)(),f=e.createElement("div"),v={me:p,dom:e,div:f};function y(t,n){f.appendChild(m.F(e,t,n))}function w(e){var t,n=s.hV.store.any(e,d.A.space("uriPrefix"));"/"!==(t=n?n.value:e.uri.split("#")[0]).slice(-1)&&(c.Rm("".concat(u,": No / at end of uriPrefix ").concat(t)),t="".concat(t,"/"));var r=new Date;return t+="".concat(u,"/id").concat(r.getTime(),"/")}return R(v).then(function(t){function c(){return c=(0,r.A)(a().mark(function n(r){var i,c,l,u,p,f;return a().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=A.appendChild(e.createElement("tr")),(c=i.appendChild(e.createElement("td"))).setAttribute("colspan","3"),c.style.padding="0.5em",f=encodeURI,n.next=1,h.RG(e,s.hV.store,c,d.A.solid("URL"),d.A.space("Workspace"),"Workspace");case 1:if(l=f(n.sent),u=g.xV(t.preferencesFile),p=[(0,o.st)(t.me,d.A.space("workspace"),u,t.preferencesFile),(0,o.st)(u,d.A.space("uriPrefix"),l,t.preferencesFile)],s.hV.store.updater){n.next=2;break}throw new Error("store has no updater");case 2:return n.next=3,s.hV.store.updater.update([],p);case 3:case"end":return n.stop()}},n)})),c.apply(this,arguments)}var u=t.me,p=t.preferencesFile,m=null,v=s.hV.store.each(u,d.A.space("workspace"),void 0,p),b=s.hV.store.each(u,d.A.space("storage"));0===v.length&&b&&(y("You don't seem to have any workspaces. You have ".concat(b.length," storage spaces."),"white"),b.map(function(e){return v=v.concat(s.hV.store.each(e,d.A.ldp("contains")))}).filter(function(e){return e.id?["public","private"].includes(e.id().toLowerCase()):""})),1===v.length&&(y("Workspace used: ".concat(v[0].uri),"white"),m=w(v[0]));var A=e.createElement("table");A.setAttribute("style","border-collapse:separate; border-spacing: 0.5em;"),f.appendChild(A),f.appendChild(e.createElement("hr"));var x=f.appendChild(e.createElement("p"));x.setAttribute("style",l.i.commentStyle),x.textContent="Where would you like to store the data for the ".concat(i,"?\n    Give the URL of the folder where you would like the data stored.\n    It can be anywhere in solid world - this URI is just an idea.");var E=f.appendChild(e.createElement("input"));E.setAttribute("type","text"),E.setAttribute("style",l.i.textInputStyle),E.size=80,E.label="base URL",E.autocomplete="on",m&&(E.value=m),t.baseField=E,f.appendChild(e.createElement("br"));var C,k,_,S,T,R,L,I=f.appendChild(e.createElement("button"));I.setAttribute("style",l.i.buttonStyle),I.textContent="Start new ".concat(i," at this URI"),I.addEventListener("click",function(e){var t=E.value.replace(" ","%20");"/"!==t.slice(-1)&&(t+="/"),n(null,t)}),v=v.filter(function(e){return!s.hV.store.holds(e,d.A.rdf("type"),d.A.space("MasterWorkspace"))});for(var P="height: 3em; margin: 1em; padding: 1em white; border-radius: 0.3em;",N="".concat(P,"border: 0px;"),O=0;O<v.length;O++){if(T=v[O],S=e.createElement("tr"),0===O&&((C=e.createElement("td")).setAttribute("rowspan","".concat(v.length)),C.textContent="Choose a workspace for this:",C.setAttribute("style","vertical-align:middle;"),S.appendChild(C)),k=e.createElement("td"),!(R=s.hV.store.anyValue(T,d.A.ui("style")))){var M="#".concat((16777215&function(e){return e.split("").reduce(function(e,t){return(e=(e<<5)-e+t.charCodeAt(0))&e},0)}(T.uri)|12632256).toString(16));R="color: black ; background-color: ".concat(M,";")}k.setAttribute("style",N+R),S.target=T.uri;var B=s.hV.store.any(T,d.A.rdfs("label"));B||(B=T.uri.split("/").slice(-1)[0]||T.uri.split("/").slice(-2)[0]),k.textContent=B||"???",S.appendChild(k),0===O&&((_=e.createElement("td")).setAttribute("rowspan","".concat(v.length,"1")),_.setAttribute("style","width:50%;"),S.appendChild(_)),A.appendChild(S),L=(L=s.hV.store.any(T,d.A.rdfs("comment")))?L.value:"Use this workspace",k.addEventListener("click",function(t){_.textContent=L?L.value:"",_.setAttribute("style",N+R);var r=e.createElement("button");r.textContent="Continue";var i=w(T);E.value=i,r.addEventListener("click",function(e){r.disabled=!0,n(T,i),r.textContent="----\x3e"},!0),_.appendChild(r)},!0)}var D=e.createElement("tr");(k=e.createElement("td")).setAttribute("style",P),k.textContent="+ Make a new workspace",k.addEventListener("click",function(e){return c.apply(this,arguments)}),D.appendChild(k),A.appendChild(D)}).catch(function(e){f.appendChild(m.F(v.dom,e))}),f}function z(e,t,n){var r=function(e,t){n(e,t)},i=e.createElement("div"),a=e.createElement("button");return a.setAttribute("type","button"),i.appendChild(a),a.innerHTML="Make new ".concat(t.noun),a.addEventListener("click",function(n){i.appendChild(V(e,t,r))},!1),i.appendChild(a),i}function $(){return J.apply(this,arguments)}function J(){return(J=(0,r.A)(a().mark(function e(){var t,n,r,i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,R({});case 1:if(t=e.sent,n=t.me,r=t.preferencesFile,i=t.preferencesFileError,r&&!i){e.next=2;break}throw new Error(i);case 2:return e.abrupt("return",s.hV.store.each(n,d.A.rdf("type"),null,r.doc()));case 3:return e.prev=3,o=e.catch(0),c.R8("Unable to fetch your preferences - this was the error: ",o),e.abrupt("return",[]);case 4:case"end":return e.stop()}},e,null,[[0,3]])}))).apply(this,arguments)}function q(e){return K.apply(this,arguments)}function K(){return(K=(0,r.A)(a().mark(function e(t){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,$();case 1:return n=e.sent,e.abrupt("return",t.filter(function(e){return G(e,n)}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function G(e,t){return(e.audience||[]).reduce(function(e,n){return e&&!!t.find(function(e){return e.equals(n)})},!0)}s.lG.events.on("logout",(0,r.A)(a().mark(function e(){var t,n,r,i;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=window.localStorage.getItem("loginIssuer"))){e.next=6;break}return e.prev=1,s.hV.store.updater.flagAuthorizationMetadata(),(n=new URL(t)).pathname="/.well-known/openid-configuration",e.next=2,fetch(n.toString());case 2:if(200!==(r=e.sent).status){e.next=4;break}return e.next=3,r.json();case 3:if(!(i=e.sent)||!i.end_session_endpoint){e.next=4;break}return e.next=4,fetch(i.end_session_endpoint,{credentials:"include"});case 4:e.next=6;break;case 5:e.prev=5,e.catch(1);case 6:window.location.reload();case 7:case"end":return e.stop()}},e,null,[[1,5]])})))},1060(e,t,n){n.d(t,{k:()=>i});const r=[];for(let e=0;e<256;++e)r.push((e+256).toString(16).slice(1));function i(e,t=0){return(r[e[t+0]]+r[e[t+1]]+r[e[t+2]]+r[e[t+3]]+"-"+r[e[t+4]]+r[e[t+5]]+"-"+r[e[t+6]]+r[e[t+7]]+"-"+r[e[t+8]]+r[e[t+9]]+"-"+r[e[t+10]]+r[e[t+11]]+r[e[t+12]]+r[e[t+13]]+r[e[t+14]]+r[e[t+15]]).toLowerCase()}},1214(e,t,n){n.d(t,{h:()=>A});var r=n(467),i=n(3453),a=n(3029),o=n(2901),s=n(4756),c=n.n(s),l=n(4961),u=n(5619),d=n(386),p=n(3291),f=n(1795),h=n(1928),m=n(7423),g=n(675),v=f.A.acl,y={13:"Owners",9:"Owners (write locked)",5:"Editors",3:"Posters",2:"Submitters",1:"Viewers"},w={13:!0,5:!0,3:!0,2:!0,1:!0},b={13:"can read, write, and control sharing.",9:"can read and control sharing, currently write-locked.",5:"can read and change information",3:"can add new information, and read but not change existing information",2:"can add new information but not read any",1:"can read but not change information"},A=function(){return(0,o.A)(function e(t,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};(0,a.A)(this,e),this.doc=t,this.aclDoc=n,this.controller=r,this._options=o,this.defaults=this._options.defaults||!1,this._store=i,this.aclMap=(0,u.fg)(t,n,i,this.defaults),this.byCombo=(0,u.xw)(this.aclMap),this.addAgentButton=new h.g(this),this.rootElement=this.controller.dom.createElement("div"),this.rootElement.setAttribute("style",g.i.accessGroupList)},[{key:"store",get:function(){return this._store},set:function(e){this._store=e,this.aclMap=(0,u.fg)(this.doc,this.aclDoc,e,this.defaults),this.byCombo=(0,u.xw)(this.aclMap)}},{key:"render",value:function(){var e=this;return this.rootElement.innerHTML="",this.renderGroups().forEach(function(t){return e.rootElement.appendChild(t)}),this.controller.isEditable&&this.rootElement.appendChild(this.addAgentButton.render()),this.rootElement}},{key:"renderGroups",value:function(){for(var e=[],t=15;t>0;t--){var n=x(t);(this.controller.isEditable&&w[t]||this.byCombo[n])&&e.push(this.renderGroup(t,n))}return e}},{key:"renderGroup",value:function(e,t){var n=this,r=this.controller.dom.createElement("div");return r.setAttribute("style",g.i.accessGroupListItem),d.DK(r,function(e){return n.handleDroppedUris(e,t).then(function(){return n.controller.render()}).catch(function(e){return n.controller.renderStatus(e)})}),this.renderGroupElements(e,t).forEach(function(e){return r.appendChild(e)}),r}},{key:"renderGroupElements",value:function(e,t){var n=this,r=this.controller.dom.createElement("div");if(r.setAttribute("style",g.i.group),this.controller.isEditable)switch(e){case 1:r.setAttribute("style",g.i.group1);break;case 2:r.setAttribute("style",g.i.group2);break;case 3:r.setAttribute("style",g.i.group3);break;case 5:r.setAttribute("style",g.i.group5);break;case 9:r.setAttribute("style",g.i.group9);break;case 13:r.setAttribute("style",g.i.group13);break;default:r.setAttribute("style",g.i.group)}r.innerText=y[e]||function(e){for(var t="",n=["Read","Append","Write","Control"],r=0;r<4;r++)e&1<<r&&(t+=n[r]);return t}(e);var a=this.controller.dom.createElement("div");if(a.setAttribute("style",g.i.group),this.controller.isEditable)switch(e){case 1:a.setAttribute("style",g.i.group1);break;case 2:a.setAttribute("style",g.i.group2);break;case 3:a.setAttribute("style",g.i.group3);break;case 5:a.setAttribute("style",g.i.group5);break;case 9:a.setAttribute("style",g.i.group9);break;case 13:a.setAttribute("style",g.i.group13);break;default:a.setAttribute("style",g.i.group)}var o=a.appendChild(this.controller.dom.createElement("table"));(this.byCombo[t]||[]).map(function(e){var r=(0,i.A)(e,2),a=r[0],s=r[1];return n.renderAgent(o,t,a,s)}).forEach(function(e){return o.appendChild(e)});var s=this.controller.dom.createElement("div");if(s.setAttribute("style",g.i.group),this.controller.isEditable)switch(e){case 1:s.setAttribute("style",g.i.group1);break;case 2:s.setAttribute("style",g.i.group2);break;case 3:s.setAttribute("style",g.i.group3);break;case 5:s.setAttribute("style",g.i.group5);break;case 9:s.setAttribute("style",g.i.group9);break;case 13:s.setAttribute("style",g.i.group13);break;default:s.setAttribute("style",g.i.group)}return s.innerText=b[e]||"Unusual combination",[r,a,s]}},{key:"renderAgent",value:function(e,t,n,r){var i=this,a=p.Cl(this.controller.dom,v(n),(0,l.sym)(r),this.controller.isEditable?{deleteFunction:function(){return i.deleteAgent(t,n,r).then(function(){return e.removeChild(a)}).catch(function(e){return i.controller.renderStatus(e)})}}:{});return a}},{key:"deleteAgent",value:(s=(0,r.A)(c().mark(function e(t,n,r){var a,o;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.byCombo[t]||[],(o=a.find(function(e){var t=(0,i.A)(e,2),a=t[0],o=t[1];return a===n&&o===r}))&&a.splice(a.indexOf(o),1),e.next=1,this.controller.save();case 1:case"end":return e.stop()}},e,this)})),function(e,t,n){return s.apply(this,arguments)})},{key:"addNewURI",value:(n=(0,r.A)(c().mark(function e(t){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.handleDroppedUri(t,x(1));case 1:return e.next=2,this.controller.save();case 2:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"handleDroppedUris",value:(t=(0,r.A)(c().mark(function e(t,n){var r,i=this;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,Promise.all(t.map(function(e){return i.handleDroppedUri(e,n)}));case 1:return e.next=2,this.controller.save();case 2:e.next=4;break;case 3:return e.prev=3,r=e.catch(0),e.abrupt("return",Promise.reject(r));case 4:case"end":return e.stop()}},e,this,[[0,3]])})),function(e,n){return t.apply(this,arguments)})},{key:"handleDroppedUri",value:(e=(0,r.A)(c().mark(function e(t,n){var r,i,a,o,s,u,d,p=arguments;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=p.length>2&&void 0!==p[2]&&p[2],i=E(t,this.store),a=(0,l.sym)(t),i||r){e.next=5;break}return m.Rm("   Not obvious: looking up dropped thing ".concat(a)),e.prev=1,e.next=2,null===(o=this._store)||void 0===o||null===(o=o.fetcher)||void 0===o?void 0:o.load(a.doc());case 2:e.next=4;break;case 3:return e.prev=3,d=e.catch(1),s="Ignore error looking up dropped thing: ".concat(d),m.z3(s),e.abrupt("return",Promise.reject(new Error(s)));case 4:return e.abrupt("return",this.handleDroppedUri(t,n,!0));case 5:if(i){e.next=6;break}return u="   Error: Drop fails to drop appropriate thing! ".concat(t),m.z3(u),e.abrupt("return",Promise.reject(new Error(u)));case 6:this.setACLCombo(n,t,i,this.controller.subject);case 7:case"end":return e.stop()}},e,this,[[1,3]])})),function(t,n){return e.apply(this,arguments)})},{key:"setACLCombo",value:function(e,t,n,r){e in this.byCombo||(this.byCombo[e]=[]),this.removeAgentFromCombos(t),this.byCombo[e].push([n.pred,n.obj.uri]),m.Rm("ACL: setting access to ".concat(r," by ").concat(n.pred,": ").concat(n.obj))}},{key:"removeAgentFromCombos",value:function(e){for(var t=0;t<16;t++){var n=this.byCombo[x(t)];if(n)for(var r=0;r<n.length;r++)for(;r<n.length&&n[r][1]===e;)n.splice(r,1)}}}]);var e,t,n,s}();function x(e){for(var t=["Read","Append","Write","Control"],n=[],r=0;r<4;r++)e&1<<r&&n.push("http://www.w3.org/ns/auth/acl#"+t[r]);return n.sort(),n.join("\n")}function E(e,t){var n=(0,l.sym)(e),r=t.findTypeURIs(n);for(var i in r)m.Rm("    drop object type includes: "+i);if(e.startsWith("http")&&3===e.split("/").length)return{pred:"origin",obj:n};if(e.startsWith("http")&&4===e.split("/").length&&e.endsWith("/"))return m.Rm("Assuming final slash on dragged origin URI was unintended!"),{pred:"origin",obj:(0,l.sym)(e.slice(0,-1))};if(f.A.vcard("WebID").uri in r)return{pred:"agent",obj:n};if(f.A.vcard("Group").uri in r)return{pred:"agentGroup",obj:n};if(n.sameTerm(f.A.foaf("Agent"))||n.sameTerm(f.A.acl("AuthenticatedAgent"))||n.sameTerm(f.A.rdf("Resource"))||n.sameTerm(f.A.owl("Thing")))return{pred:"agentClass",obj:n};if(f.A.vcard("Individual").uri in r||f.A.foaf("Person").uri in r||f.A.foaf("Agent").uri in r){var a=t.any(n,f.A.foaf("preferredURI"));return a?{pred:"agent",obj:(0,l.sym)(a)}:{pred:"agent",obj:n}}return f.A.solid("AppProvider").uri in r?{pred:"origin",obj:n}:f.A.solid("AppProviderClass").uri in r?{pred:"originClass",obj:n}:(m.Rm("    Triage fails for "+e),null)}},1454(e,t,n){n.d(t,{w:()=>a});var r=n(4976);class i extends r.Vw{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,(0,r.sd)(e);const n=(0,r.ZJ)(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,a=new Uint8Array(i);a.set(n.length>i?e.create().update(n).digest():n);for(let e=0;e<a.length;e++)a[e]^=54;this.iHash.update(a),this.oHash=e.create();for(let e=0;e<a.length;e++)a[e]^=106;this.oHash.update(a),(0,r.uH)(a)}update(e){return(0,r.CC)(this),this.iHash.update(e),this}digestInto(e){(0,r.CC)(this),(0,r.DO)(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:i,blockLen:a,outputLen:o}=this;return e.finished=r,e.destroyed=i,e.blockLen=a,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const a=(e,t,n)=>new i(e,t).update(n).digest();a.create=(e,t)=>new i(e,t)},1648(e,t,n){n.d(t,{Of:()=>h});var r=n(467),i=n(4756),a=n.n(i),o=n(3378),s=n(5175),c=n(967),l=n(3291),u=n(675),d=n(2825),p=n(8565),f=o.Pt.iconBase+"noun_help.svg";function h(e,t,n){return m.apply(this,arguments)}function m(){return(m=(0,r.A)(a().mark(function e(t,n,r){var i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=document.getElementById("PageHeader")){e.next=1;break}return e.abrupt("return");case 1:o=(0,p.E6)(),g(i,t,o,n,r)(),s.lG.events.on("logout",g(i,t,o,n,r)),s.lG.events.on("login",g(i,t,o,n,r));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function g(e,t,n,i,o){return(0,r.A)(a().mark(function r(){var c,l;return a().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return c=s.jO.currentUser(),e.innerHTML="",l=e,r.next=1,v(t,n,c,i,o);case 1:l.appendChild.call(l,r.sent);case 2:case"end":return r.stop()}},r)}))}function v(e,t,n,r,i){return y.apply(this,arguments)}function y(){return(y=(0,r.A)(a().mark(function e(t,n,r,i,o){var s,c,l,d,p,f,h;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((s=document.createElement("a")).href=n.uri,s.setAttribute("style",u.i.headerBannerLink),c=document.createElement("img"),o&&(c.src=o.logo?o.logo:"https://solidproject.org/assets/img/solid-emblem.svg"),c.setAttribute("style",u.i.headerBannerIcon),s.appendChild(c),!r){e.next=2;break}return e.next=1,E(t,r,i);case 1:h=e.sent,e.next=3;break;case 2:h=b();case 3:return l=h,(d=document.createElement("div")).setAttribute("style",u.i.headerBanner),d.appendChild(s),(p=document.createElement("div")).setAttribute("style",u.i.headerBannerRightMenu),p.appendChild(l),o&&o.helpMenuList&&(f=w(o,o.helpMenuList),p.appendChild(f)),d.appendChild(p),e.abrupt("return",d);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function w(e,t){if(t){var n=document.createElement("ul");n.setAttribute("style",u.i.headerUserMenuList),t.forEach(function(e){"url"===(e.url?"url":"onclick")?n.appendChild(k(x(e.label,e.url,e.target))):n.appendChild(k(A(e.label,e.onclick)))});var r=document.createElement("nav");r.setAttribute("style",u.i.headerUserMenuNavigationMenuNotDisplayed),r.setAttribute("aria-hidden","true"),r.setAttribute("id","helperNav"),r.appendChild(n);var i=document.createElement("div");i.setAttribute("style",u.i.headerBannerUserMenu),i.appendChild(r);var a=document.createElement("button");a.setAttribute("style",u.i.headerUserMenuTrigger),a.type="button";var s=document.createElement("img");s.src=e&&e.helpIcon?e.helpIcon:o.Pt.iconBase+f,s.setAttribute("style",u.i.headerUserMenuTriggerImg),i.appendChild(a),a.appendChild(s);var c=(0,p.nF)(function(e){return S(e,a,r)},50);a.addEventListener("click",c);var l=setTimeout(function(){return null},0);return i.addEventListener("mouseover",function(e){clearTimeout(l),c(e);var t=document.getElementById("helperNav");null==t||t.setAttribute("style",u.i.headerUserMenuNavigationMenu)}),i.addEventListener("mouseout",function(e){l=setTimeout(function(){return c(e)},200);var t=document.getElementById("helperNav");null==t||t.setAttribute("style",u.i.headerUserMenuNavigationMenuNotDisplayed)}),i}}function b(){var e=document.createElement("div");return e.setAttribute("style",u.i.headerBannerLogin),e.appendChild((0,c.loginStatusBox)(document,null,{})),e}function A(e,t){var n=document.createElement("button");return n.setAttribute("style",u.i.headerUserMenuButton),n.onmouseover=function(){n.setAttribute("style",u.i.headerUserMenuButtonHover)},n.onmouseout=function(){n.setAttribute("style",u.i.headerUserMenuButton)},n.addEventListener("click",t),n.innerText=e,n}function x(e,t,n){var r=document.createElement("a");return r.setAttribute("style",u.i.headerUserMenuLink),r.onmouseover=function(){r.setAttribute("style",u.i.headerUserMenuLinkHover)},r.onmouseout=function(){r.setAttribute("style",u.i.headerUserMenuLink)},r.href=t,r.innerText=e,n&&(r.target=n),r}function E(e,t,n){return C.apply(this,arguments)}function C(){return(C=(0,r.A)(a().mark(function e(t,n,r){var i,o,s,c,l,d,f,h;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=t.fetcher)){e.next=1;break}return e.next=1,i.load(n);case 1:return(o=document.createElement("ul")).setAttribute("style",u.i.headerUserMenuList),r&&r.forEach(function(e){"url"===(e.url?"url":"onclick")?o.appendChild(k(x(e.label,e.url,e.target))):o.appendChild(k(A(e.label,e.onclick)))}),(s=document.createElement("nav")).setAttribute("style",u.i.headerUserMenuNavigationMenuNotDisplayed),s.setAttribute("aria-hidden","true"),s.setAttribute("id","loggedInNav"),s.appendChild(o),(c=document.createElement("button")).setAttribute("style",u.i.headerUserMenuTrigger),c.type="button","string"==typeof(l=_(t,n))?c.innerHTML=l:c.appendChild(l),(d=document.createElement("div")).setAttribute("style",u.i.headerBannerUserMenuNotDisplayed),d.appendChild(c),d.appendChild(s),f=(0,p.nF)(function(e){return S(e,c,s)},50),c.addEventListener("click",f),h=setTimeout(function(){return null},0),d.addEventListener("mouseover",function(e){clearTimeout(h),f(e);var t=document.getElementById("loggedInNav");null==t||t.setAttribute("style",u.i.headerUserMenuNavigationMenu)}),d.addEventListener("mouseout",function(e){h=setTimeout(function(){return f(e)},200);var t=document.getElementById("loggedInNav");null==t||t.setAttribute("style",u.i.headerUserMenuNavigationMenuNotDisplayed)}),e.abrupt("return",d);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function k(e){var t=document.createElement("li");return t.setAttribute("style",u.i.headerUserMenuListItem),t.appendChild(e),t}function _(e,t){var n=null;try{if(!(n=l.F1(t)))return d.j}catch(e){return d.j}var r=document.createElement("div");return r.setAttribute("style",u.i.headerUserMenuPhoto),r.style.backgroundImage="url(".concat(n,")"),r}function S(e,t,n){var r="true"===t.getAttribute("aria-expanded"),i="mouseover"===e.type,a="mouseout"===e.type;r&&i||!r&&a||(t.setAttribute("aria-expanded",(!r).toString()),n.setAttribute("aria-hidden",r.toString()))}},1763(e,t,n){n.d(t,{Dk:()=>O,K:()=>c.K,L1:()=>V,LC:()=>j,LX:()=>J,Nr:()=>p.Nr,Nt:()=>L,PM:()=>p.PM,Ru:()=>N,WG:()=>p.WG,WY:()=>z,ZA:()=>P,ZZ:()=>c.ZZ,bk:()=>p.bk,e2:()=>U,eR:()=>F,eb:()=>B,f6:()=>I,iU:()=>H,rg:()=>c.rg,s2:()=>W,tE:()=>M,tk:()=>s.t,vx:()=>D,xV:()=>$});var r=n(467),i=n(4756),a=n.n(i),o=n(3291),s=n(588),c=n(9086),l=n(7673),u=n(7423),d=n(3468),p=n(6564),f=n(8251),h=n(675),m=n(4762),g=n(3378),v=n(4158),y=n(1795),w=n(4961),b=n(5175),A=n(52),x=n(9612),E=n(4101);function C(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return k(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var _=b.M_;function S(e,t,n,r,i,a,o){for(var s=a.children,l=0;l<o.length;l++){var d=o[l];if((0,c.K)(d)===y.A.ui("Options").uri){var p=(0,c.rg)(e,d)(e,null,t,n,d,r,i);u.Rm("Refreshing Options field by replacing it."),a.insertBefore(p,s[l]),a.removeChild(s[l+1])}}}function T(e,t,n,r,i,a,o,s){var c=y.A.ui,l=b.M_,u=l.any(i,c("property"));if(!u){var f=(0,d.F)(e,"No property to boolean field: "+i);return t&&t.appendChild(f),f}var h=l.any(i,c("label"));h||(h=x.P(u,!0)),a=(0,p.WG)(r,u,a);var m=l.any(r,u);void 0===m&&(m=!1);var g=w.st(r,u,!0,a),v=z(e,l,h,w.st(r,u,!1,a),g,i,a,s);return t&&t.appendChild(v),v}function R(e,t,n,r,i,a,o){(0,c.rg)(e,i)(e,t,n,r,i,a,o)}function L(e,t,n,r,i){var a=e.createElement("button");return a.setAttribute("type","button"),a.innerHTML="Edit "+x.P(y.A.ui("Form")),a.addEventListener("click",function(o){I(e,t,{},n,y.A.ui("FormForm"),r,i).setAttribute("style",y.A.ui("FormForm").sameTerm(n)?"background-color: #fee;":"background-color: #ffffe7;"),a.parentNode.removeChild(a)},!0),a}function I(e,t,n,r,i,a,o){return(0,c.rg)(e,i)(e,t,n,r,i,a,o)}function P(e,t){var n=e.each(void 0,y.A.rdf("range"),t);[y.A.rdfs("comment"),y.A.dc("title"),y.A.foaf("name"),y.A.foaf("homepage")].forEach(function(e){n.push(e)});var r=e.each(void 0,y.A.rdf("type"),t);r.length>60&&(r=r.slice(0,60));for(var i={},a=0;a<(r.length>60?60:r.length);a++)e.statementsMatching(r[a],void 0,void 0).forEach(function(e){i[e.predicate.uri]=!0});n.forEach(function(e){i[e.uri]=!0});var o=[];for(var s in i)o.push(e.sym(s));return o}function N(e,t,n){for(var r=[e.sym(t)];r.length>0;){var i=r.shift(),a=e.each(i,n);if(v.debug("Lists for "+i+", "+n+": "+a.length),0!==a.length)return a;for(var o=e.each(i,y.A.rdfs("subClassOf")),s=0;s<o.length;s++)r.push(o[s]),v.debug("findClosest: add super: "+o[s])}return[]}function O(e){var t=b.M_;v.debug("formsFor: subject="+e);var n,r=t.findTypeURIs(e);for(n in r)v.debug("   type: "+n);var i=t.bottomTypeURIs(r),a=[];for(var o in i)v.debug("candidatesFor: trying bottom type ="+o),a=(a=a.concat(N(t,o,y.A.ui("creationForm")))).concat(N(t,o,y.A.ui("annotationForm")));return a}function M(e){var t=e.map(function(e){return[_.any(e,y.A.ui("sequence"))||9999,e]});return t.sort(function(e,t){return e[0]-t[0]}),t.map(function(e){return e[1]})}function B(e){var t=e.map(function(e){return[x.P(e).toLowerCase(),e]});return t.sort(),t.map(function(e){return e[1]})}function D(e,t,n,r,i,a,o,s){var c=e.createElement("button");return c.setAttribute("type","button"),c.innerHTML="New "+x.P(i),c.addEventListener("click",function(l){c.parentNode.appendChild(U(e,t,n,r,i,a,o,s))},!1),c}function U(e,t,n,r,i,a,s,l){var u=e.createElement("form");if(!a){var d=N(t,i.uri,y.A.ui("creationForm"));if(0===d.length){u.appendChild(e.createElement("p")).textContent="I am sorry, you need to provide information about a "+x.P(i)+" but I don't know enough information about those to ask you.";var p=u.appendChild(e.createElement("button"));return p.setAttribute("type","button"),p.setAttribute("style","float: right;"),p.innerHTML="Goto "+x.P(i),p.addEventListener("click",function(t){e.outlineManager.GotoSubject(i,!0,void 0,!0,void 0)},!1),u}v.debug("lists[0] is "+d[0]),a=d[0]}v.debug("form is "+a),u.setAttribute("style","border: 0.05em solid ".concat(m.A.formBorderColor,"; color: ").concat(m.A.formBorderColor)),u.innerHTML="<h3>New "+x.P(i)+"</h3>";var f=(0,c.rg)(e,a),h=$(s),g=!1;function b(e,t,n){return l(t,n)}v.info("paneUtils Object is "+h);var A=f(e,u,{},h,a,s,function(a,c){if(!a)return l(a,c);var d=[];n&&!t.holds(n,r,h,s)&&d.push(w.st(n,r,h,s)),n&&!t.holds(h,y.A.rdf("type"),i,s)&&d.push(w.st(h,y.A.rdf("type"),i,s)),d.length?t.updater.update([],d,b):l(!0,c),g||(g=u.appendChild(o.$J(e,h)))});return o.DT(e,A).setAttribute("style","float: right;"),u.AJAR_subject=h,u}function F(e,t,n,r,i,a){var s,c=e.createElement("div"),l=t.anyJS(n,r,null,i)||"",u=e.createElement("textarea");function p(o){s.disabled=!0,s.setAttribute("style","visibility: hidden; float: right;"),u.disabled=!0,u.style.color=m.A.textInputColorPending;var l=t.statementsMatching(n,r,null,i),p=w.st(n,r,u.value,i);t.updater.update(l,p,function(t,n,r){n?(u.style.color=m.A.textInputColor,u.disabled=!1):c.appendChild((0,d.F)(e,"Error (while saving change to "+i.uri+"): "+r)),a&&a(n,r)})}return c.appendChild(u),u.rows=l?l.split("\n").length+2:2,u.cols=80,u.setAttribute("style",h.i.multilineTextInputStyle),null!==l?u.value=l:u.select(),c.refresh=function(){var e=t.any(n,r,null,i);e&&e.value!==u.value&&(u.value=e.value)},t.updater.editable(i.uri)?((s=o.kz(e,p)).disabled=!0,s.style.visibility="hidden",s.style.float="right",c.appendChild(s),u.addEventListener("keyup",function(e){u.style.color="green",s&&(s.disabled=!1,s.style.visibility="")},!0),u.addEventListener("change",p,!0)):(u.disabled=!0,u.style.backgroundColor=m.A.textInputBackgroundColorUneditable),c}function j(e,t,n,r,i,a,o,s){v.debug("Select list length now "+i.length);for(var l,p=0,f={},m=t.updater.editable(o.uri),g=0;g<i.length;g++){var b=i[g];b.uri||u.R8("makeSelectForClassifierOptions: option does not have an uri: ".concat(b,", with predicate: ").concat(r)),b.uri&&!(b.uri in f)&&(f[b.uri]=!0,p++)}if(0===p&&!a.mint)return(0,d.F)(e,"Can't do selector with no options, subject= "+n+" property = "+r+".");v.debug("makeSelectForClassifierOptions: dataDoc="+o);var E=function(){return l={},r.sameTerm(y.A.rdf("type"))?l=t.findTypeURIs(n):t.each(n,r,null,o).forEach(function(e){l[e.uri]=!0}),l};l=E();var C=e.createElement("select");for(var k in C.setAttribute("style",h.i.formSelectStyle),a.multiple&&C.setAttribute("multiple","true"),C.currentURI=null,C.refresh=function(){l=E();for(var e=0;e<C.children.length;e++){var t=C.children[e];t.AJAR_uri&&(t.selected=t.AJAR_uri in l)}C.disabled=!1},f){var _=t.sym(k),S=e.createElement("option");a.disambiguate?S.appendChild(e.createTextNode(A.labelWithOntology(_,!0))):S.appendChild(e.createTextNode(x.P(_,!0)));var T=t.any(_,t.sym("http://www.w3.org/ns/ui#backgroundColor"));T&&S.setAttribute("style","background-color: "+T.value+"; "),S.AJAR_uri=k,k in l&&(S.setAttribute("selected","true"),C.currentURI=k),C.appendChild(S)}if(m&&a.mint){var R=e.createElement("option");R.appendChild(e.createTextNode(a.mint)),R.AJAR_mint=!0,C.insertBefore(R,C.firstChild)}if(null==C.currentURI&&!a.multiple){var L=e.createElement("option");L.appendChild(e.createTextNode(a.nullLabel)),C.insertBefore(L,C.firstChild),L.selected=!0}return m&&C.addEventListener("change",function(i){C.disabled=!0;for(var u,p=[],f=[],h=function(e){t.holds(n,r,e,o)&&p.push(w.st(n,r,e,o))},m=0;m<C.options.length;m++){var g=C.options[m];if(g.selected&&g.AJAR_mint){if(a.mintClass){var y=U(e,t,n,r,a.mintClass,null,o,function(e,t){e||s(e,t,{change:"new"})});C.parentNode.appendChild(y),u=y.AJAR_subject}else u=$(o);f.push(w.st(n,r,u,o)),a.mintStatementsFun&&(f=f.concat(a.mintStatementsFun(u)))}g.AJAR_uri&&(g.selected&&!(g.AJAR_uri in l)&&f.push(w.st(n,r,t.sym(g.AJAR_uri),o)),!g.selected&&g.AJAR_uri in l&&h(t.sym(g.AJAR_uri)),g.selected&&(C.currentURI=g.AJAR_uri))}for(var b=C.subSelect;b&&b.currentURI;)h(t.sym(b.currentURI)),b=b.subSelect;for(b=C.superSelect;b&&b.currentURI;)h(t.sym(b.currentURI)),b=b.superSelect;function A(e,t){s(e,{widget:"select",event:"new"})}v.info("makeSelectForClassifierOptions: data doc = "+o),t.updater.update(p,f,function(t,n,r){if(l=E(),!n)return C.parentNode.appendChild((0,d.F)(e,"Error updating data in select: "+r));C.disabled=!1,u&&(0,c.rg)(e,a.subForm)(e,C.parentNode,{},u,a.subForm,o,A),s&&s(n,{widget:"select",event:"change"})})},!1),C}function H(e,t,n,r,i,a,o,s){v.debug("Select list length now "+i.length);for(var c,l=0,p={},f=t.updater.editable(o.uri),m=0;m<i.length;m++){var g=i[m];g.uri||u.R8("makeSelectForOptions: option does not have an uri: ".concat(g,", with predicate: ").concat(r)),g.uri&&!(g.uri in p)&&(p[g.uri]=!0,l++)}if(0===l)return(0,d.F)(e,"Can't do selector with no options, subject= "+n+" property = "+r+".");v.debug("makeSelectForOptions: dataDoc="+o);var b=function(){return c={},r.sameTerm(y.A.rdf("type"))?c=t.findTypeURIs(n):t.each(n,r,null,o).forEach(function(e){e.uri&&(c[e.uri]=!0)}),c};c=b();var E=e.createElement("select");for(var C in E.setAttribute("style",h.i.formSelectStyle),E.currentURI=null,E.refresh=function(){c=b();for(var e=0;e<E.children.length;e++){var t=E.children[e];t.AJAR_uri&&(t.selected=t.AJAR_uri in c)}E.disabled=!1},p){var k=t.sym(C),_=e.createElement("option");a.disambiguate?_.appendChild(e.createTextNode(A.labelWithOntology(k,!0))):_.appendChild(e.createTextNode(x.P(k,!0)));var S=t.any(k,t.sym("http://www.w3.org/ns/ui#backgroundColor"));S&&_.setAttribute("style","background-color: "+S.value+"; "),_.AJAR_uri=C,C in c&&(_.setAttribute("selected","true"),E.currentURI=C),E.appendChild(_)}if(!E.currentURI){var T=e.createElement("option");T.appendChild(e.createTextNode(a.nullLabel)),E.insertBefore(T,E.firstChild),T.selected=!0}return f&&E.addEventListener("change",function(i){E.disabled=!0;for(var a=[],l=[],u=function(e){t.holds(n,r,e,o)&&a.push(w.st(n,r,e,o))},p=0;p<E.options.length;p++){var f=E.options[p];f.AJAR_uri&&(f.selected&&!(f.AJAR_uri in c)&&l.push(w.st(n,r,t.sym(f.AJAR_uri),o)),!f.selected&&f.AJAR_uri in c&&u(t.sym(f.AJAR_uri)),f.selected&&(E.currentURI=f.AJAR_uri))}for(var h=E.subSelect;h&&h.currentURI;)u(t.sym(h.currentURI)),h=h.subSelect;for(h=E.superSelect;h&&h.currentURI;)u(t.sym(h.currentURI)),h=h.superSelect;v.info("selectForOptions: data doc = "+o),t.updater.update(a,l,function(t,n,r){if(c=b(),!n)return E.parentNode.appendChild((0,d.F)(e,"Error updating data in select: "+r));E.disabled=!1,s&&s(n,{widget:"select",event:"change"})})},!1),E}function W(e,t,n,r,i,a){var o,s=t.any(r,y.A.owl("disjointUnionOf")),c=!1;return s?o=s.elements:(o=t.each(void 0,y.A.rdfs("subClassOf"),r),c=!0),v.debug("Select list length "+o.length),0===o.length?(0,d.F)(e,"Can't do "+(c?"multiple ":"")+"selector with no subclasses of category: "+r):1===o.length?(0,d.F)(e,"Can't do "+(c?"multiple ":"")+"selector with only 1 subclass of category: "+r+":"+o[1]):j(e,t,n,y.A.rdf("type"),o,{multiple:c,nullLabel:"* Select type *"},i,a)}function V(e,t,n,r,i,a){function o(){c&&(s.removeChild(c),c=null),l.currentURI&&t.any(t.sym(l.currentURI),y.A.owl("disjointUnionOf"))&&(c=V(e,t,n,t.sym(l.currentURI),i,a),l.subSelect=c.firstChild,l.subSelect.superSelect=l,s.appendChild(c))}var s=e.createElement("span"),c=null;var l=W(e,t,n,r,i,function(e,t){e&&o(),a(e,t)});return s.appendChild(l),o(),s}function z(e,t,n,r,i,a,o,s){var c=e.createElement("div"),l=(0,p.Nr)(e,t,c,a,n),f=t.updater.editable(o.uri),m=e.createElement("button"),g=m;function v(e){if(!e)return[];if(e.object)return e.why||(e.why=o),[e];if(e instanceof Array)return e;throw new Error("buildCheckboxForm: bad param "+e)}function w(e){return 0===e.filter(function(e){return!t.holds(e.subject,e.predicate,e.object,e.why)}).length}if(m.style=h.i.checkboxInputStyle,l.appendChild(m),i=v(i),r=v(r),function(){var n=w(i),o=n;if(r.length){var l=w(r);if(n&&l)return c.appendChild(d.F(e,"Inconsistent data in dataDoc!\n"+i+" and\n"+r)),c;if(!n&&!l){n=null;var u=t.any(a,y.A.ui("default"));o=u?"1"===u.value:!!s&&null}}m.state=n,m.textContent={true:"âœ“",false:s?"âœ•":" ",null:"-"}[o]}(),!f)return c;return m.addEventListener("click",function(n){g.style.color="#bbb";var a=!0===m.state?i:!1===m.state?r:[];m.newState=null===m.state||!0!==m.state&&(!s||null);var o=!0===m.newState?i:!1===m.newState?r:[];u.Rm("  Deleting  ".concat(a)),u.Rm("  Inserting ".concat(o)),t.updater.update(a,o,function(n,r,i){if(r)g.style.color="#000",m.state=m.newState,m.textContent={true:"âœ“",false:"âœ•",null:"-"}[m.state];else{if(a.why)t.holds(a.subject,a.predicate,a.object,a.why)&&u.Rm(" @@@@@ weird if 409 - does hold statement");g.style.color="#000",g.style.backgroundColor="#fee",c.appendChild((0,d.F)(e,"Checkbox: Error updating dataDoc from ".concat(m.state," to ").concat(m.newState,":\n\n").concat(i)))}})},!1),c}function $(e){var t=new Date;return w.sym(e.uri+"#id"+t.getTime())}function J(e,t,n,r,i,a,o,s,c,l,u){for(var p={},f=n.updater.editable(l.uri),m=0;m<a.length;m++){var g=a[m];g.uri&&!(g.uri in p)&&(p[g.uri]=!0)}if(0===Object.keys(p).length&&!c.mint)return(0,d.F)(e,"Can't do selector with no options, subject= "+r+" property = "+i+".");v.debug("makeSelectForChoice: dataDoc="+l);var b,E,k=e.createElement("select");for(var _ in k.setAttribute("style",h.i.formSelectStyle),k.setAttribute("id","formSelect"),k.currentURI=null,p)k.appendChild(T(_));if(f&&c.mint){var S=e.createElement("option");S.appendChild(e.createTextNode(c.mint)),S.AJAR_mint=!0,k.insertBefore(S,k.firstChild)}function T(t){var r,i=e.createElement("option"),a=n.sym(t);r=c.disambiguate?A.labelWithOntology(a,!0):x.P(a,!0),i.appendChild(e.createTextNode(r)),i.setAttribute("value",t);var s=n.any(a,n.sym("http://www.w3.org/ns/ui#backgroundColor"));return s&&i.setAttribute("style","background-color: "+s.value+"; "),i.AJAR_uri=t,q(a.value,o)&&i.setAttribute("selected","true"),i}return 0===k.children.length&&k.insertBefore(((E=e.createElement("option")).appendChild(e.createTextNode((b="--- choice ---",i&&"BlankNode"!==i.termType&&(b="* Select for property: "+x.P(i)+" *"),r&&"BlankNode"!==r.termType&&(b="* Select for "+x.P(r,!0)+" *"),b))),E.disabled=!0,E.value=!0,E.hidden=!0,E.selected=!0,E),k.firstChild),k.update=function(t){o=t;var a,c=[],p=[],f=function(e){n.holds(r,i,e,l)&&c.push(w.st(r,i,e,l))},h=function(e){n.holds(r,i,e,l)||p.push(w.st(r,i,e,l)),s&&!n.holds(e,y.A.rdf("type"),n.sym(s),l)&&p.push(w.st(e,y.A.rdf("type"),n.sym(s),l))},m=n.each(r,i,null,l).map(function(e){return e.value}),g=C(m);try{for(g.s();!(a=g.n()).done;){var v=a.value;q(v,o)||f(w.sym(v))}}catch(e){g.e(e)}finally{g.f()}var b,A=C(o);try{for(A.s();!(b=A.n()).done;){var x=b.value;x in m||h(w.sym(x))}}catch(e){A.e(e)}finally{A.f()}n.updater.update(c,p,function(t,n,r){if(!n)return k.parentNode.appendChild((0,d.F)(e,"Error updating data in select: "+r));k.refresh(),u&&u(n,{widget:"select",event:"change"})})},k.refresh=function(){k.disabled=!0;for(var a,p=[],f=0;f<k.options.length;f++){var h=k.options[f];if(h.selected&&h.AJAR_mint){if(c.mintClass){var m=U(e,n,r,i,s,c.subForm,l,function(e,t){e||u(e,t,{change:"new"})});k.parentNode.appendChild(m),a=m.AJAR_subject}else a=$(l);p.push(w.st(r,i,n.sym(a),l)),s&&p.push(w.st(a,y.A.rdf("type"),n.sym(s),l)),c.mintStatementsFun&&(p=p.concat(c.mintStatementsFun(a))),k.currentURI=a}h.AJAR_uri&&(h.selected&&q(h.AJAR_uri,o)&&(k.currentURI=h.AJAR_uri),q(h.AJAR_uri,o)||h.removeAttribute("selected"),q(h.AJAR_uri,o)&&h.setAttribute("selected","true"))}v.info("selectForOptions: data doc = "+l),k.currentURI&&c.subForm&&!c.multiSelect&&R(e,t,{},w.sym(k.currentURI),c.subForm,l,function(r,i){r?(n.updater.update([],p,function(n,r,i){r||t.appendChild((0,d.F)(e,"Error updating select: "+i))}),u&&u(r,{widget:"select",event:"new"})):t.appendChild((0,d.F)(e,"Error updating data in field of select: "+i))}),k.disabled=!1},f&&k.addEventListener("change",function(e){t.removeChild(t.lastChild),k.refresh()},!1),k}function q(e,t){var n;for(n=0;n<t.length;n++)if(t[n]===e)return!0;return!1}c.ZZ[y.A.ui("AutocompleteField").uri]=f.l,c.ZZ[y.A.ui("Form").uri]=c.ZZ[y.A.ui("Group").uri]=function(e,t,n,r,i,a,o){var s=e.createElement("div"),l=y.A.ui;if(t&&t.appendChild(s),i){var u=r.toNT()+"|"+i.toNT();if(n[u])return s.appendChild(e.createTextNode("Group: see above "+u)),s;var p={};for(var f in n)p[f]=1;p[u]=1;var m=i.doc?i.doc():null,g=_.any(i,l("weight"),null,m),v=g?Number(g.value):1;if(v>3||v<0)return s.appendChild((0,d.F)(e,"Form Group weight ".concat(v," should be 0-3")));s.setAttribute("style",h.i.formGroupStyle[v]),s.style.display="flex",s.style.flexDirection="column",s.class="form-weight-"+v;var w,b=_.any(i,l("parts"),null,m);if(b?w=b.elements:(b=_.each(i,l("part"),null,m),w=M(b)),!b)return s.appendChild((0,d.F)(e,"No parts to form! "));for(var A=0;A<w.length;A++){var x=w[A],E=(0,c.rg)(e,x),C=function(t,i){t&&i&&i.widget&&"select"===i.widget&&S(e,n,r,a,o,s,w),o(t,{widget:"group",change:i})};s.appendChild(E(e,null,p,r,x,a,C))}return s}},c.ZZ[y.A.ui("Options").uri]=function(e,t,n,r,i,a,o){var s=b.M_,c=e.createElement("div"),l=i.doc?i.doc():null,u=y.A.ui;t&&t.appendChild(c);var p=s.any(i,u("dependingOn"));p||(p=y.A.rdf("type"));var f,h=s.each(i,u("case"),null,l);h||c.appendChild((0,d.F)(e,"No cases to Options form. ")),f=p.sameTerm(y.A.rdf("type"))?Object.keys(s.findTypeURIs(r)).map(function(e){return w.sym(e)}):s.each(r,p);for(var m=0;m<h.length;m++){for(var g=h[m],v=s.each(g,u("for"),null,l),A=!1,x=0;x<v.length;x++){var E,k=C(f);try{for(k.s();!(E=k.n()).done;){var _=E.value,S=v[x];(_.sameTerm(v)||_.termType===S.termType&&_.value===S.value)&&(A=!0)}}catch(e){k.e(e)}finally{k.f()}}if(A){var T=s.the(g,u("use"));if(!T)return c.appendChild((0,d.F)(e,'No "use" part for case in form '+i)),c;I(e,c,n,r,T,a,o);break}}return c},c.ZZ[y.A.ui("Multiple").uri]=function(e,t,n,i,s,l,p){function f(e){return e.map(function(e){return e.toString().slice(-7)}).join(", ")}function h(){return m.apply(this,arguments)}function m(){return(m=(0,r.A)(a().mark(function t(){var n,r,o,s;return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=$(l),!I){t.next=2;break}return V(),D.elements.push(n),t.next=1,z();case 1:t.next=7;break;case 2:return r=N?[w.st(n,P,i,l)]:[w.st(i,P,n,l)],t.prev=3,t.next=4,k.updater.update([],r);case 4:t.next=6;break;case 5:t.prev=5,s=t.catch(3),o="Error adding to unordered multiple: "+s,S.appendChild((0,d.F)(e,o)),u.z3(o);case 6:q();case 7:case"end":return t.stop()}},t,null,[[3,5]])}))).apply(this,arguments)}function E(t){function s(){return(s=(0,r.A)(a().mark(function n(){var r,o;return a().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!I){n.next=5;break}u.Rm("pre delete: "+f(D.elements)),r=0;case 1:if(!(r<D.elements.length)){n.next=4;break}if(!D.elements[r].sameTerm(t)){n.next=3;break}return D.elements.splice(r,1),n.next=2,z();case 2:return n.abrupt("return");case 3:r++,n.next=1;break;case 4:n.next=6;break;case 5:k.holds(i,P,t,l)&&(o=[w.st(i,P,t,l)],k.updater.update(o,[],function(t,n,r){n?F.removeChild(y):F.appendChild((0,d.F)(e,"Multiple: delete failed: "+r))}));case 6:case"end":return n.stop()}},n)}))).apply(this,arguments)}function h(e,t){return m.apply(this,arguments)}function m(){return(m=(0,r.A)(a().mark(function e(n,r){var i;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:u.Rm("pre move: "+f(D.elements)),i=0;case 1:if(!(i<D.elements.length)){e.next=3;break}if(!D.elements[i].sameTerm(t)){e.next=2;break}return e.abrupt("continue",3);case 2:i++,e.next=1;break;case 3:if(i===D.elements.length&&alert("list move: not found element for "+t),!r){e.next=5;break}if(0!==i){e.next=4;break}return alert("@@ boop - already at top   -temp message"),e.abrupt("return");case 4:D.elements.splice(i-1,2,D.elements[i],D.elements[i-1]),e.next=7;break;case 5:if(i!==D.elements.length-1){e.next=6;break}return alert("@@ boop - already at bottom   -temp message"),e.abrupt("return");case 6:D.elements.splice(i,2,D.elements[i+1],D.elements[i]);case 7:return e.next=8,z();case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}v.debug("Multiple: render object: "+t);var y=(0,c.rg)(e,B)(e,null,n,t,B,l,function(e,n){u.Rm("Item done callback for item ".concat(t.toString())),e||u.z3("  Item done callback: Error: "+n),p(e,n)});if(y.subject=t,k.updater.editable(l.uri)&&(o.Qy(e,y,O,function(){return s.apply(this,arguments)}),I)){var b=e.createElement("div");b.style.display="grid",b.style.gridTemplateColumns="auto 3em",b.style.gridTemplateRows="50% 50%";var A=o.x6(e,g.Pt.iconBase+"noun_1369237.svg","Move Up",function(){var e=(0,r.A)(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h(t,!0));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),x=o.x6(e,g.Pt.iconBase+"noun_1369241.svg","Move Down",function(){var e=(0,r.A)(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",h(t,!1));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),E=e.createElement("div");return E.appendChild(y),b.appendChild(E),b.appendChild(A),b.appendChild(x),A.style.gridColumn=2,x.style.gridColumn=2,A.style.gridRow=1,x.style.padding="0em",A.style.padding="0em",x.style.gridRow=2,E.style.gridColumn=1,E.style.gridRowStart="span 2",b}return y}var C=g.Pt.iconBase+"noun_19460_green.svg",k=b.M_,_=s.doc?s.doc():null,S=e.createElement("div"),T=S,R=y.A.ui;t&&t.appendChild(S);var L=k.any(s,R("ordered")),I=!!L&&w.Node.toJS(L),P=k.any(s,R("property")),N=k.anyJS(s,R("reverse"),null,_);if(!P)return S.appendChild((0,d.F)(e,"No property to multiple: "+s)),T;var O=k.any(s,R("label"));O||(O=x.P(P));var M=k.any(s,R("min"));M=M?0+M.value:0;var B=k.any(s,R("part"));if(!B)return S.appendChild((0,d.F)(e,"No part to multiple: "+s)),T;var D,U,F=S.appendChild(e.createElement("div"));if(F.style.display="flex",F.style.flexDirection="column",U=N?k.any(null,P,i,l):k.any(i,P,null,l),I?(D=N?k.any(null,P,i,l):k.any(i,P,null,l),U=D?D.elements:[]):(U=N?k.each(null,P,i,l):k.each(i,P,null,l),D=null),k.updater.editable(l.uri)){var j=S.appendChild(e.createElement("div"));j.style.padding="0.5em";var H=j.appendChild(e.createElement("img"));H.setAttribute("src",C),H.setAttribute("style","margin: 0.2em; width: 1.5em; height:1.5em"),H.title="Click to add another "+O;var W=e.createElement("span");W.textContent=(0===U.length?"Add another ":"Add ")+O,j.addEventListener("click",function(){var e=(0,r.A)(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,h();case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),!0),j.appendChild(W)}function V(){D||(D=new w.Collection,N?k.add(D,P,i,l):k.add(i,P,D,l))}function z(){return J.apply(this,arguments)}function J(){return(J=(0,r.A)(a().mark(function t(){var n;return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return u.Rm("save list: "+f(D.elements)),V(),t.prev=1,t.next=2,k.fetcher.putBack(l);case 2:t.next=4;break;case 3:return t.prev=3,n=t.catch(1),S.appendChild((0,d.F)(e,"Error trying to put back a list: "+n)),t.abrupt("return");case 4:q();case 5:case"end":return t.stop()}},t,null,[[1,3]])}))).apply(this,arguments)}function q(){var e;if(I){var t=N?k.the(null,P,i,l):k.the(i,P,null,l);e=t?t.elements:[]}else(e=N?k.each(null,P,i,l):k.each(i,P,null,l)).sort();A.syncTableToArrayReOrdered(F,e,E)}function K(){return(K=(0,r.A)(a().mark(function e(){var t,n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=M-U.length)>0)){e.next=4;break}n=0;case 1:if(!(n<t)){e.next=3;break}return u.Rm("Adding extra: min "+M),e.next=2,h();case 2:n++,e.next=1;break;case 3:return e.next=4,z();case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}return F.refresh=q,q(),function(){return K.apply(this,arguments)}().then(function(){u.Rm(" Multiple render: async stuff ok")},function(e){u.z3(" Multiple render: async stuff fails. #### ",e)}),T},c.ZZ[y.A.ui("PhoneField").uri]=p.PM,c.ZZ[y.A.ui("EmailField").uri]=p.PM,c.ZZ[y.A.ui("ColorField").uri]=p.PM,c.ZZ[y.A.ui("DateField").uri]=p.PM,c.ZZ[y.A.ui("DateTimeField").uri]=p.PM,c.ZZ[y.A.ui("TimeField").uri]=p.PM,c.ZZ[y.A.ui("NumericField").uri]=p.PM,c.ZZ[y.A.ui("IntegerField").uri]=p.PM,c.ZZ[y.A.ui("DecimalField").uri]=p.PM,c.ZZ[y.A.ui("FloatField").uri]=p.PM,c.ZZ[y.A.ui("TextField").uri]=p.PM,c.ZZ[y.A.ui("SingleLineTextField").uri]=p.PM,c.ZZ[y.A.ui("NamedNodeURIField").uri]=p.PM,c.ZZ[y.A.ui("MultiLineTextField").uri]=function(e,t,n,r,i,a,o){var s=y.A.ui,c=b.M_,l=i.doc?i.doc():null,u=c.any(i,s("property"));if(!u)return(0,d.F)(e,"No property to text field: "+i);var f=e.createElement("div");f.style.display="flex",f.style.flexDirection="row";var h=f.appendChild(e.createElement("div"));h.style.width=m.A.formFieldNameBoxWidth;var g=f.appendChild(e.createElement("div"));h.appendChild((0,p.bk)(e,u,i)),a=(0,p.WG)(r,u,a);var v=c.anyJS(r,u,null,a)||"",w=c.updater.editable(a.uri),A=i&&c.anyJS(i,y.A.ui("suppressEmptyUneditable"),null,l);!w&&A&&""===v&&(f.style.display="none");var x=F(e,c,r,u,a,o);return g.appendChild(x),t&&t.appendChild(f),f},c.ZZ[y.A.ui("BooleanField").uri]=function(e,t,n,r,i,a,o){return T(e,t,0,r,i,a,0,!1)},c.ZZ[y.A.ui("TristateField").uri]=function(e,t,n,r,i,a,o){return T(e,t,0,r,i,a,0,!0)},c.ZZ[y.A.ui("Classifier").uri]=function(e,t,n,r,i,a,o){var s=b.M_,c=y.A.ui,l=s.any(i,c("category"));if(!l)return(0,d.F)(e,"No category for classifier: "+i);v.debug("Classifier: dataDoc="+a);var u=V(e,s,r,l,a,function(e,t){return o(e,t)});return t&&t.appendChild(u),u},c.ZZ[y.A.ui("Choice").uri]=function(e,t,n,r,i,a,s){var c,l=y.A.ui,u=b.M_,f=i.doc?i.doc():null,h=e.createElement("div");h.setAttribute("class","choiceBox"),t&&t.appendChild(h);var m=e.createElement("div");m.setAttribute("class","formFieldName choiceBox-label"),h.appendChild(m);var g=e.createElement("div");g.setAttribute("class","formFieldValue choiceBox-selectBox"),h.appendChild(g);var v=u.any(i,l("property"));if(!v)return h.appendChild((0,d.F)(e,"No property for Choice: "+i));m.appendChild((0,p.bk)(e,v,i));var A=u.any(i,l("from"));if(!A)return(0,d.F)(e,"No 'from' for Choice: "+i);var x=u.any(i,l("use")),C={form:i,subForm:x,disambiguate:!1};u.any(i,l("canMintNew"))&&(C.mint="* Create new *");var k=u.any(i,l("multiselect"));k&&(C.multiSelect=!0);var _,S=u.each(i,l("search-full-store")).length?null:a;return g.refresh=function(){var t=u.each(r,v,null,a).map(function(e){return e.value}),n=function(e){var t,n=[];for(var r in n=u.each(void 0,y.A.rdf("type"),A,f),function(e,t,n){var r,i,a,o,s,c,l,u,d,p,f,h={};h[t.toNT()]=!0;var m={},g=e.transitiveClosure(h,e.rdfFactory.namedNode("http://www.w3.org/2000/01/rdf-schema#subClassOf"),!0);for(var v in g){for(var y=0,w=(s=e.statementsMatching(null,e.rdfFactory.namedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#type"),e.fromNT(v),n)).length;y<w;y++)m[(p=s[y]).subject.toNT()]=p;for(var b=0,A=(c=e.each(null,e.rdfFactory.namedNode("http://www.w3.org/2000/01/rdf-schema#domain"),e.fromNT(v),n)).length;b<A;b++)for(o=c[b],a=0,r=(l=e.statementsMatching(null,o,null,n)).length;a<r;a++)m[(p=l[a]).subject.toNT()]=p;for(var x=0,E=(u=e.each(null,e.rdfFactory.namedNode("http://www.w3.org/2000/01/rdf-schema#range"),e.fromNT(v),n)).length;x<E;x++)for(o=u[x],f=0,i=(d=e.statementsMatching(null,o,null,n)).length;f<i;f++)m[(p=d[f]).object.toNT()]=p}return m}(u,A,e))n.push(u.fromNT(r));if(A.sameTerm(y.A.rdfs("Class")))for(c in o.Pg())n.push(u.sym(c));else if(A.sameTerm(y.A.rdf("Property"))){for(c in(t=o.uA(u)).op)n.push(u.fromNT(c));for(c in t.dp)n.push(u.fromNT(c));C.disambiguate=!0}else if(A.sameTerm(y.A.owl("ObjectProperty"))){for(c in(t=o.uA(u)).op)n.push(u.fromNT(c));C.disambiguate=!0}else if(A.sameTerm(y.A.owl("DatatypeProperty"))){for(c in(t=o.uA(u)).dp)n.push(u.fromNT(c));C.disambiguate=!0}return n}(S);if(n.push(t),n=B(n),_=J(e,g,u,r,v,n,t,A,C,a,s),g.innerHTML="",g.appendChild(_),k){var i=new E.N({placeholder:_.selected,select:_,container:g,textField:"textField",valueField:"valueField"});i.init(),i.subscribe(function(n){if("REMOVE_OPTION"===n.action&&(t=t.filter(function(e){return e!==n.value})),"CLEAR_ALL_OPTIONS"===n.action&&(t=[]),"ADD_OPTION"===n.action)if((n.value+"").includes("Create new")){var i=$(a),o=[];o.push(w.st(r,v,u.sym(i),a)),A&&o.push(w.st(i,y.A.rdf("type"),u.sym(A),a)),x&&R(e,g,{},w.sym(i),x,a,function(n,r){n?(u.updater.update([],o,function(t,n,r){n||g.appendChild((0,d.F)(e,"Error updating select: "+r))}),t.push(i),s&&s(n,{widget:"select",event:"new"})):g.appendChild((0,d.F)(e,"Error updating data in field of select: "+r))})}else t.push(n.value);_.update(t)})}},g.refresh(),_&&_.refresh&&_.refresh(),h},c.ZZ[y.A.ui("Comment").uri]=c.ZZ[y.A.ui("Heading").uri]=function(e,t,n,r,i,a,o){var u=y.A.ui,d=b.M_,p=d.any(i,u("contents"));p||(p="Error: No contents in comment field.");var f=i.doc?i.doc():null,h=(0,c.K)(i),m=s.t[h]||{},g=e.createElement("div");t&&t.appendChild(g);var v=g.appendChild(e.createElement(m.element));v.textContent=p,(0,l.c)(v,i);var w=d.anyJS(i,y.A.ui("suppressIfUneditable"),null,f),A=d.updater.editable(a.uri);return w&&!A&&(g.style.display="none"),g}},1791(e,t,n){var r=n(5172),i=n(5546);e.exports=function e(t,n){function a(e,i,o,s){try{var c=t[e](i),l=c.value;return l instanceof r?n.resolve(l.v).then(function(e){a("next",e,o,s)},function(e){a("throw",e,o,s)}):n.resolve(l).then(function(e){c.value=e,o(c)},function(e){return a("throw",e,o,s)})}catch(e){s(e)}}var o;this.next||(i(e.prototype),i(e.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),i(this,"_invoke",function(e,t,r){function i(){return new n(function(t,n){a(e,r,t,n)})}return o=o?o.then(i,i):i()},!0)},e.exports.__esModule=!0,e.exports.default=e.exports},1795(e,t,n){n.d(t,{A:()=>o});var r=n(5386),i=n.n(r),a=n(4961);const o=i()(a)},1798(e,t,n){function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{A:()=>r})},1848(e,t,n){n.d(t,{DS:()=>A,OG:()=>w,Ph:()=>u,aK:()=>v,d6:()=>o,dJ:()=>y,eV:()=>s,fg:()=>b,lX:()=>d,lq:()=>p,qj:()=>h,r4:()=>g,x:()=>x,z:()=>f,zW:()=>c});var r=n(4976);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const i=BigInt(0),a=BigInt(1);function o(e,t=""){if("boolean"!=typeof e){throw new Error((t&&`"${t}"`)+"expected boolean, got type="+typeof e)}return e}function s(e,t,n=""){const i=(0,r.aY)(e),a=e?.length,o=void 0!==t;if(!i||o&&a!==t){throw new Error((n&&`"${n}" `)+"expected Uint8Array"+(o?` of length ${t}`:"")+", got "+(i?`length=${a}`:"type="+typeof e))}return e}function c(e){const t=e.toString(16);return 1&t.length?"0"+t:t}function l(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return""===e?i:BigInt("0x"+e)}function u(e){return l((0,r.My)(e))}function d(e){return(0,r.DO)(e),l((0,r.My)(Uint8Array.from(e).reverse()))}function p(e,t){return(0,r.aT)(e.toString(16).padStart(2*t,"0"))}function f(e,t){return p(e,t).reverse()}function h(e,t,n){let i;if("string"==typeof t)try{i=(0,r.aT)(t)}catch(t){throw new Error(e+" must be hex string or Uint8Array, cause: "+t)}else{if(!(0,r.aY)(t))throw new Error(e+" must be hex string or Uint8Array");i=Uint8Array.from(t)}const a=i.length;if("number"==typeof n&&a!==n)throw new Error(e+" of length "+n+" expected, got "+a);return i}const m=e=>"bigint"==typeof e&&i<=e;function g(e,t,n){return m(e)&&m(t)&&m(n)&&t<=e&&e<n}function v(e,t,n,r){if(!g(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function y(e){let t;for(t=0;e>i;e>>=a,t+=1);return t}const w=e=>(a<<BigInt(e))-a;function b(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");const i=e=>new Uint8Array(e),a=e=>Uint8Array.of(e);let o=i(e),s=i(e),c=0;const l=()=>{o.fill(1),s.fill(0),c=0},u=(...e)=>n(s,o,...e),d=(e=i(0))=>{s=u(a(0),e),o=u(),0!==e.length&&(s=u(a(1),e),o=u())},p=()=>{if(c++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){o=u();const t=o.slice();n.push(t),e+=o.length}return(0,r.Id)(...n)};return(e,t)=>{let n;for(l(),d(e);!(n=t(p()));)d();return l(),n}}function A(e,t,n={}){if(!e||"object"!=typeof e)throw new Error("expected valid options object");function r(t,n,r){const i=e[t];if(r&&void 0===i)return;const a=typeof i;if(a!==n||null===i)throw new Error(`param "${t}" is invalid: expected ${n}, got ${a}`)}Object.entries(t).forEach(([e,t])=>r(e,t,!1)),Object.entries(n).forEach(([e,t])=>r(e,t,!0))}function x(e){const t=new WeakMap;return(n,...r)=>{const i=t.get(n);if(void 0!==i)return i;const a=e(n,...r);return t.set(n,a),a}}},1928(e,t,n){n.d(t,{g:()=>g});var r=n(467),i=n(3029),a=n(2901),o=n(4467),s=n(4756),c=n.n(s),l=n(7423),u=n(3378),d=n(967),p=n(1795),f=n(9612),h=n(3291),m=n(675),g=function(){return(0,a.A)(function e(t){(0,i.A)(this,e),(0,o.A)(this,"isExpanded",!1),this.groupList=t,this.rootElement=t.controller.dom.createElement("div"),this.barElement=t.controller.dom.createElement("div")},[{key:"render",value:function(){return this.rootElement.innerHTML="",this.rootElement.appendChild(this.renderAddButton()),this.rootElement.appendChild(this.barElement),this.rootElement}},{key:"renderAddButton",value:function(){var e=this;return h.x6(this.groupList.controller.dom,"".concat(u.Pt.iconBase,"noun_34653_green.svg"),"Add ...",function(){e.toggleBar(),e.renderBar()})}},{key:"renderBar",value:function(){this.barElement.innerHTML="",this.isExpanded&&(this.barElement.appendChild(this.renderPersonButton()),this.barElement.appendChild(this.renderGroupButton()),this.barElement.appendChild(this.renderPublicButton()),this.barElement.appendChild(this.renderAuthenticatedAgentButton()),this.barElement.appendChild(this.renderBotButton()),this.barElement.appendChild(this.renderAppsButton()))}},{key:"renderSimplifiedBar",value:function(e){var t=this;Array.from(this.barElement.children).filter(function(t){return t!==e}).forEach(function(e){return t.barElement.removeChild(e)})}},{key:"renderPersonButton",value:function(){var e=this;return h.x6(this.groupList.controller.dom,u.Pt.iconBase+h.p_["vcard:Individual"],"Add Person",function(t){e.renderSimplifiedBar(t.target),e.renderNameForm(p.A.vcard("Individual"),"person").then(function(t){return e.addPerson(t)}).then(function(){return e.renderCleanup()}).catch(function(t){return e.groupList.controller.renderStatus(t)})})}},{key:"renderGroupButton",value:function(){var e=this;return h.x6(this.groupList.controller.dom,u.Pt.iconBase+h.p_["vcard:Group"],"Add Group",function(t){e.renderSimplifiedBar(t.target),e.renderNameForm(p.A.vcard("Group"),"group").then(function(t){return e.addGroup(t)}).then(function(){return e.renderCleanup()}).catch(function(t){return e.groupList.controller.renderStatus(t)})})}},{key:"renderNameForm",value:function(e,t){return h.RG(this.groupList.controller.dom,this.groupList.store,this.barElement,p.A.vcard("URI"),e,t)}},{key:"renderPublicButton",value:function(){var e=this;return h.x6(this.groupList.controller.dom,u.Pt.iconBase+h.p_["foaf:Agent"],"Add Everyone",function(){return e.addAgent(p.A.foaf("Agent").uri).then(function(){return e.groupList.controller.renderTemporaryStatus("Adding the general public to those who can read. Drag the globe to a different level to give them more access.")}).then(function(){return e.renderCleanup()})})}},{key:"renderAuthenticatedAgentButton",value:function(){var e=this;return h.x6(this.groupList.controller.dom,"".concat(u.Pt.iconBase,"noun_99101.svg"),"Anyone logged In",function(){return e.addAgent(p.A.acl("AuthenticatedAgent").uri).then(function(){return e.groupList.controller.renderTemporaryStatus("Adding anyone logged in to those who can read. Drag the ID icon to a different level to give them more access.")}).then(function(){return e.renderCleanup()})})}},{key:"renderBotButton",value:function(){var e=this;return h.x6(this.groupList.controller.dom,u.Pt.iconBase+"noun_Robot_849764.svg","A Software Agent (bot)",function(t){e.renderSimplifiedBar(t.target),e.renderNameForm(p.A.schema("Application"),"bot").then(function(t){return e.addBot(t)}).then(function(){return e.renderCleanup()})})}},{key:"renderAppsButton",value:function(){var e=this;return h.x6(this.groupList.controller.dom,"".concat(u.Pt.iconBase,"noun_15177.svg"),"A Web App (origin)",function(t){e.renderSimplifiedBar(t.target);var n={div:e.barElement,dom:e.groupList.controller.dom},r=e.renderAppsTable(n).catch(function(t){return e.groupList.controller.renderStatus(t)});e.renderAppsView();var i=e.renderNameForm(p.A.schema("WebApplication"),"webapp domain").then(function(t){return e.getOriginFromName(t)});Promise.race([r,i]).then(function(t){t&&e.groupList.addNewURI(t)}).then(function(){return e.renderCleanup()})})}},{key:"renderAppsView",value:function(){var e=this,t=this.groupList.controller.context.session.paneRegistry.byName("trustedApplications");if(t){var n=t.render(null,this.groupList.controller.context);n.setAttribute("style",m.i.trustedAppController);var r=h.x7(this.groupList.controller.dom,function(){return e.renderCleanup()});r.setAttribute("style",m.i.trustedAppCancelButton),n.insertBefore(r,n.firstChild),this.barElement.appendChild(n)}}},{key:"renderAppsTable",value:(v=(0,r.A)(c().mark(function e(t){var n,r,i=this;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,(0,d.ensureLoadedProfile)(t);case 1:return n=this.groupList.store.each(t.me,p.A.acl("trustedApp")),r=n.flatMap(function(e){return i.groupList.store.each(e,p.A.acl("origin"))}),this.barElement.appendChild(this.groupList.controller.dom.createElement("p")).textContent="You have ".concat(r.length," selected web apps."),e.abrupt("return",new Promise(function(e,t){var r=i.barElement.appendChild(i.groupList.controller.dom.createElement("table"));r.setAttribute("style",m.i.trustedAppAddApplicationsTable),n.forEach(function(n){var a=i.groupList.store.any(n,p.A.acl("origin"));a||t(new Error("Unable to pick app: ".concat(n.value)));var o=h.Cl(i.groupList.controller.dom,p.A.acl("origin"),a,{}),s=i.groupList.controller.dom.createElement("table"),c=s.appendChild(i.groupList.controller.dom.createElement("tr"));c.appendChild(i.groupList.controller.dom.createElement("td")).appendChild(o),c.appendChild(i.groupList.controller.dom.createElement("td")).textContent="Give access to ".concat(i.groupList.controller.noun," ").concat(f.P(i.groupList.controller.subject),"?"),c.appendChild(i.groupList.controller.dom.createElement("td")).appendChild(h.kz(i.groupList.controller.dom,function(){return e(a.value)})),r.appendChild(s)})}));case 2:case"end":return e.stop()}},e,this)})),function(e){return v.apply(this,arguments)})},{key:"renderCleanup",value:function(){this.renderBar(),this.groupList.render()}},{key:"addPerson",value:(g=(0,r.A)(c().mark(function e(t){var n;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=1;break}return e.abrupt("return",this.toggleBar());case 1:if(n=/^https?:/i,t.match(n)){e.next=2;break}return e.abrupt("return",Promise.reject(new Error("Not a http URI")));case 2:return l.Rm("Adding to ACL person: ".concat(t)),e.next=3,this.groupList.addNewURI(t);case 3:this.toggleBar();case 4:case"end":return e.stop()}},e,this)})),function(e){return g.apply(this,arguments)})},{key:"addGroup",value:(s=(0,r.A)(c().mark(function e(t){var n;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=1;break}return e.abrupt("return",this.toggleBar());case 1:if(n=/^https?:/i,t.match(n)){e.next=2;break}return e.abrupt("return",Promise.reject(new Error("Not a http URI")));case 2:return l.Rm("Adding to ACL group: "+t),e.next=3,this.groupList.addNewURI(t);case 3:this.toggleBar();case 4:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"addAgent",value:(n=(0,r.A)(c().mark(function e(t){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,this.groupList.addNewURI(t);case 1:this.toggleBar();case 2:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"addBot",value:(t=(0,r.A)(c().mark(function e(t){var n;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=1;break}return e.abrupt("return",this.toggleBar());case 1:if(n=/^https?:/i,t.match(n)){e.next=2;break}return e.abrupt("return",Promise.reject(new Error("Not a http URI")));case 2:return l.Rm("Adding to ACL bot: "+t),e.next=3,this.groupList.addNewURI(t);case 3:this.toggleBar();case 4:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"getOriginFromName",value:(e=(0,r.A)(c().mark(function e(t){var n,r;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=1;break}return e.abrupt("return",Promise.resolve());case 1:if(n=/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i,t.match(n)){e.next=2;break}return e.abrupt("return",Promise.reject(new Error("Not a domain name")));case 2:return r="https://"+t,l.Rm("Adding to ACL origin: "+r),this.toggleBar(),e.abrupt("return",r);case 3:case"end":return e.stop()}},e,this)})),function(t){return e.apply(this,arguments)})},{key:"toggleBar",value:function(){this.isExpanded=!this.isExpanded}}]);var e,t,n,s,g,v}()},2174(e,t,n){n.d(t,{I:()=>f});var r=n(7423),i=n(3378),a=n(5175),o=n(4158),s=n(1795),c=n(4961),l=n(52),u=n(9612),d=n(4608),p={icons:i.Pt,log:o,ns:s.A,utils:l,widgets:d};function f(e,t){var n,i,o,s,d=t.sourceDocument,f=t.tableClass,h=t.query,m=p.ns,g=a.M_,v={},y={"http://www.w3.org/2002/07/owl#sameAs":!0,"http://www.w3.org/1999/02/22-rdf-syntax-ns#type":!0},w={"http://www.w3.org/2001/XMLSchema#decimal":!0,"http://www.w3.org/2001/XMLSchema#float":!0,"http://www.w3.org/2001/XMLSchema#double":!0,"http://www.w3.org/2001/XMLSchema#integer":!0,"http://www.w3.org/2001/XMLSchema#nonNegativeInteger":!0,"http://www.w3.org/2001/XMLSchema#positiveInteger":!0,"http://www.w3.org/2001/XMLSchema#nonPositiveInteger":!0,"http://www.w3.org/2001/XMLSchema#negativeInteger":!0,"http://www.w3.org/2001/XMLSchema#long":!0,"http://www.w3.org/2001/XMLSchema#int":!0,"http://www.w3.org/2001/XMLSchema#short":!0,"http://www.w3.org/2001/XMLSchema#byte":!0,"http://www.w3.org/2001/XMLSchema#unsignedLong":!0,"http://www.w3.org/2001/XMLSchema#unsignedInt":!0,"http://www.w3.org/2001/XMLSchema#unsignedShort":!0,"http://www.w3.org/2001/XMLSchema#unsignedByte":!0},b={"http://www.w3.org/2001/XMLSchema#dateTime":!0,"http://www.w3.org/2001/XMLSchema#date":!0},A={"http://xmlns.com/foaf/0.1/Image":!0,"http://purl.org/dc/terms/Image":!0},x=t.keyVariable||"?_row",E=0,C=null,k=null,_=e.createElement("div");_.className="tableViewPane",_.appendChild(function(){var t=e.createElement("table");t.setAttribute("class","toolbar");var n=e.createElement("tr");return o=e.createElement("td"),n.appendChild(o),s=e.createElement("td"),n.appendChild(s),t.appendChild(n),t}());var S,T=e.createElement("div");if(_.appendChild(T),_.refresh=function(){te(S.query,S.logicalRows,S.columns,S)},h)S=ie(h),T.appendChild(S);else{var R=function(){var e,t,n=function(){for(var e={},t=g.statementsMatching(void 0,p.ns.rdf("type"),f,d),n={},r=0;r<t.length;++r){var i=t[r].object;if("NamedNode"===i.termType){var a=U(e,i);i.uri in n||(n[i.uri]=[]),n[i.uri].push(t[r].subject),a.addUse()}}return[n,e]}();for(var r in e=n[0],t=n[1],e){var i=e[r];j(t[r],i)}var a=new N(null);return[a,M(t)]}();n=R[0],i=R[1],f||o.appendChild(function(t,n){var r=e.createElement("div");r.appendChild(e.createTextNode("Select type: "));var i=e.createElement("select");for(var a in i.appendChild(B("All types","null")),n)i.appendChild(B(n[a].getLabel(),a));return i.addEventListener("click",function(){var e;e="null"===i.value?t:n[i.value],I(e)},!1),r.appendChild(i),r}(n,i)),k=function(e){var t,n=-1,r=null;for(t in e){var i=e[t];i.useCount>n&&(r=i,n=i.useCount)}return r}(i),I(k||n)}return _;function L(e){var t=new c.Query,n=g.variable(x.slice(1));return function(e,t){for(var n=t.getColumns(),r=0;r<n.length;++r){var i=g.variable("_col"+r);e.vars.push(i),n[r].setVariable(i)}}(t,e),function(e,t,n){var r=n.type;r||(r=g.variable("_any")),e.pat.add(t,p.ns.rdf("type"),r)}(t,n,e),function(e,t,n){for(var r=n.getColumns(),i=0;i<r.length;++i){var a=r[i],o=g.formula();o.add(t,a.predicate,a.getVariable()),e.pat.optional.push(o)}}(t,n,e),t}function I(t){P(s),s.appendChild(function(t){var n=e.createElement("div"),r=t.getUnusedColumns();if(r.sort(function(e,t){var n=e.sortKey(),r=t.sortKey();return(n>r)-(n<r)}),r.length>0){n.appendChild(e.createTextNode("Add column: "));var i=e.createElement("select");i.appendChild(B("","-1"));for(var a=0;a<r.length;++a){var o=r[a];i.appendChild(B(o.getLabel(),""+a))}n.appendChild(i),i.addEventListener("click",function(){var e=Number(i.value);e>=0&&(t.addColumn(r[e]),I(t))},!1)}return n}(t)),function(e,t){C&&(C.running=!1);var n=ie(e,t);P(T),T.appendChild(n),C=e}(L(t),t)}function P(e){for(;e.childNodes.length>0;)e.removeChild(e.childNodes[0])}function N(e){this.type=e,this.columns=null,this.allColumns=[],this.useCount=0,this.getAllColumns=function(){return this.allColumns},this.getColumns=function(){if(!this.columns){var e=this.getAllColumns();this.columns=e.slice(0,7)}return this.columns},this.getUnusedColumns=function(){for(var e=this.getAllColumns(),t=this.getColumns(),n=[],r=0;r<e.length;++r)-1===t.indexOf(e[r])&&n.push(e[r]);return n},this.addColumn=function(e){this.columns.push(e)},this.removeColumn=function(e){this.columns=this.columns.filter(function(t){return t!==e})},this.getLabel=function(){return u.P(this.type)},this.addUse=function(){this.useCount+=1}}function O(){this.useCount=0,this.checkedAnyValues=!1,this.possiblyLiteral=!0,this.possiblyNumber=!0,this.constraints=[],this.checkValue=function(e){var t=e.termType;if(this.possiblyLiteral&&"Literal"!==t&&"NamedNode"!==t)this.possiblyNumber=!1,this.possiblyLiteral=!1;else if(this.possiblyNumber){if("Literal"!==t)this.possiblyNumber=!1;else e.value.match(/^-?\d+(\.\d*)?$/)||(this.possiblyNumber=!1)}this.checkedAnyValues=!0},this.getVariable=function(){return this.variable},this.setVariable=function(e){this.variable=e},this.getKey=function(){return this.variable.toString()},this.addUse=function(){this.useCount+=1},this.getHints=function(){return t&&t.hints&&this.variable&&t.hints[this.variable.toNT()]?t.hints[this.variable.toNT()]:{}},this.getLabel=function(){return this.getHints().label?this.getHints().label:this.predicate?this.predicate.sameTerm(m.rdf("type"))&&this.superClass?u.P(this.superClass,!0):u.P(this.predicate):this.variable?this.variable.toString():"unlabeled column?"},this.setPredicate=function(e,t,n){t?(this.inverse=e,this.constraints=this.constraints.concat(g.each(e,p.ns.rdfs("domain"))),e.sameTerm(m.rdfs("subClassOf"))&&"NamedNode"===n.termType&&(this.superClass=n,this.alternatives=g.each(void 0,m.rdfs("subClassOf"),n))):(this.predicate=e,this.constraints=this.constraints.concat(g.each(e,p.ns.rdfs("range"))))},this.getConstraints=function(){return this.constraints},this.filterFunction=function(){return!0},this.sortKey=function(){return this.getLabel().toLowerCase()},this.isImageColumn=function(){for(var e=0;e<this.constraints.length;e++)if(this.constraints[e].uri in A)return!0;return!1}}function M(e,t){var n=[];for(var r in e){var i=e[r];t&&!t(r,i)||n.push(i)}return n}function B(t,n){var r=e.createElement("option");return r.setAttribute("value",n),r.appendChild(e.createTextNode(t)),r}function D(e,t){var n;return t.uri in e?n=e[t.uri]:((n=new O).setPredicate(t),e[t.uri]=n),n}function U(e,t){var n;return t.uri in e?n=e[t.uri]:(n=new N(t),e[t.uri]=n),n}function F(e,t){for(var n=g.statementsMatching(e,void 0,void 0,d),r={},i=0;i<n.length;++i){var a=n[i].predicate;if(!(a.uri in y)){var o=D(t,a);o.checkValue(n[i].object),r[a.uri]=o}}return r}function j(e,t){for(var n={},r=0;r<t.length;++r){var i=F(t[r],n);for(var a in i){i[a].addUse()}}var o=M(n);!function(e){function t(e,t){return(e.useCount<t.useCount)-(e.useCount>t.useCount)}e.sort(t)}(o),e.allColumns=o}function H(t,n){var r=e.createElement("a");return r.appendChild(e.createTextNode("[x]")),r.addEventListener("click",function(){t.removeColumn(n),I(t)},!1),r}function W(e,t){for(var n=!0,r=0;r<t.length;++r){var i=t[r],a=i.getKey(),o=null;if(a in e.values&&(o=e.values[a][0]),!i.filterFunction(o)){n=!1;break}}var s=e._htmlRow;s.style.display=n?"":"none"}function V(e,t){for(var n=0;n<e.length;++n){W(e[n],t)}}function z(e,t,n){function r(e){return e?"Literal"===e.termType?e.value.toLowerCase():"NamedNode"===e.termType?u.P(e).toLowerCase():e.value.toLowerCase():""}!function(e,t,n,r){var i=t.getKey();if(e.sort(function(e,t){var a=null,o=null;i in e.values&&(a=e.values[i][0]),i in t.values&&(o=t.values[i][0]);var s=n(a,o);return r?-s:s}),e.length){for(var a=e[0]._htmlRow.parentNode,o=0;o<e.length;++o)a.removeChild(e[o]._htmlRow);for(var s=0;s<e.length;++s)a.appendChild(e[s]._htmlRow)}}(e,t,function(e,t){var n=r(e),i=r(t);return n<i?-1:n>i?1:0},n)}function $(t,n,r){var i=e.createElement("div"),a=e.createElement("input");a.setAttribute("type","text"),a.style.width="70%",i.appendChild(a);var o=e.createElement("span");o.appendChild(e.createTextNode("â–¼")),o.addEventListener("click",function(){z(t,r,!1)},!1),i.appendChild(o);var s=e.createElement("span");s.appendChild(e.createTextNode("â–²")),s.addEventListener("click",function(){z(t,r,!0)},!1),i.appendChild(s);var c=null;return r.filterFunction=function(e){return!c||!!e&&("Literal"===e.termType?e.value:"NamedNode"===e.termType?u.P(e):"").toLowerCase().indexOf(c)>=0},a.addEventListener("keyup",function(){c=""!==a.value?a.value.toLowerCase():null,V(t,n)},!1),i}function J(t,n,r,i){for(var a=e.createElement("div"),o=e.createElement("select"),s={},c=0;c<i.length;++c){var l=i[c];s[l.uri]=!0}var d=Z(r).initialSelection;d&&(s=d),o.setAttribute("multiple","true");for(var p=0;p<i.length;++p){var f=i[p],h=B(u.P(f),p);s[f.uri]&&(h.selected=!0),o.appendChild(h)}return a.appendChild(o),r.filterFunction=function(e){return!s||e&&s[e.uri]},o.addEventListener("click",function(){s={};for(var e=o.options,r=0;r<e.length;r++){var a=e[r],c=Number(a.value);e[r].selected&&(s[i[c].uri]=!0)}V(t,n)},!0),a}function q(t,n,r){var i=e.createElement("div"),a=e.createElement("input");a.setAttribute("type","text"),a.style.width="40px",i.appendChild(a);var o=e.createElement("input");o.setAttribute("type","text"),o.style.width="40px",i.appendChild(o);var s=null,c=null;function l(){s=""===a.value?null:Number(a.value),c=""===o.value?null:Number(o.value),V(t,n)}return r.filterFunction=function(e){return e&&(e=Number(e)),!(s&&(!e||e<s))&&!(c&&(!e||e>c))},a.addEventListener("keyup",l,!1),o.addEventListener("keyup",l,!1),i}function K(e,t,n){if(n.superClass&&n.alternatives.length>0)return J(e,t,n,n.alternatives);for(var r,i=n.getConstraints(),a=0;a<i.length;a++){if(r=i[a],n.checkedAnyValues&&n.possiblyNumber||r.uri in w)return q(e,t,n);if("http://www.w3.org/2000/01/rdf-schema#Literal"===r.uri)return $(e,t,n);var o=g.each(r,p.ns.owl("oneOf"));if(o.length>0)return J(e,t,n,o.elements)}return function(e,t,n){return n.checkedAnyValues&&n.possiblyNumber?q(e,t,n):n.possiblyLiteral?$(e,t,n):null}(e,t,n)}function G(t,n,i){i=i||{};var a=e.createElement("a"),o=i.linkFunction;return a.setAttribute("href",t),a.appendChild(e.createTextNode(n)),o?a.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation();var t=l.getTarget(e).getAttribute("href");t||r.Rm("No href found \n"),o(t)},!0):a.addEventListener("click",p.widgets.openHrefInOutlineMode,!0),a}function Z(e){return t&&t.hints&&e.variable&&t.hints[e.variable.toNT()]?t.hints[e.variable.toNT()]:{}}function Q(t,n){var r=Z(n),i=r.cellFormat;if(!i){if("Literal"===t.termType){if(t.datatype){if(b[t.datatype.uri])return e.createTextNode(p.widgets.shortDate(t.value));if(w[t.datatype.uri]){var a=e.createElement("span");return a.textContent=t.value,a.setAttribute("style","text-align: right"),a}}return e.createTextNode(t.value)}if("NamedNode"===t.termType&&n.isImageColumn())return function(t){var n=e.createElement("img");return n.setAttribute("src",t.uri),n.style.height="40px",n}(t);if("NamedNode"===t.termType||"BlankNode"===t.termType)return function(e,t){var n=!1;return e.uri&&(n=e.uri.match(/^mailto:(.*)/)),G(e.uri,n?n[1]:u.P(e),t)}(t,r);if("Collection"===t.termType){var o=e.createElement("span");return o.appendChild(e.createTextNode("[")),t.elements.forEach(function(t){o.appendChild(Q(t,n)),o.appendChild(e.createTextNode(", "))}),o.removeChild(o.lastChild),o.appendChild(e.createTextNode("]")),o}return e.createTextNode("unknown termtype '"+t.termType+"'!")}if("shortDate"===i)return e.createTextNode(p.widgets.shortDate(t.value))}function X(e,t){var n,r=null;if("Literal"===e.termType)r="value";else{if("NamedNode"!==e.termType)return t.indexOf(e)>=0;r="uri"}for(n=0;n<t.length;++n)if(t[n].termType===e.termType&&t[n][r]===e[r])return!0;return!1}function Y(t,n,r){var i,a=!1;for(i in r){var o=r[i];i in t.values||(t.values[i]=[]),X(o,t.values[i])||(t.values[i].push(o),a=!0)}a&&(P(t._htmlRow),function(t,n,r){var i=e.createElement("td");n._subject&&"uri"in n._subject&&i.appendChild(G(n._subject.uri,"â†’")),t.appendChild(i);for(var a=0;a<r.length;++a){var o=r[a],s=e.createElement("td"),c=void 0,l=o.getKey();if(l in n.values){var u=n.values[l],d=!1;n.originalValues&&n.originalValues[l]&&u.length!==n.originalValues[l].length&&(d=!0);for(var p=0;p<u.length;++p){var f=u[p];n.originalValues&&n.originalValues[l]&&n.originalValues[l].length>p&&(c=n.originalValues[l][p],f.toString()!==c.toString()&&(d=!0)),s.appendChild(Q(f,o)),p!==u.length-1&&s.appendChild(e.createTextNode(",\n")),d&&(s.style.background="#efe")}}t.appendChild(s)}n._htmlRow=t}(t._htmlRow,t,n)),W(t,n)}function ee(e){if("uri"in e)return e.uri;if("_subject_id"in e)return e._subject_id;var t=""+E;return e._subject_id=t,++E,t}function te(n,i,a,o){n.running=!0;var s=Date.now(),c=e.createElement("tr");o.appendChild(c),c.textContent="Loading ...";for(var l=0;l<i.length;l++)i[l].original=!0,i[l].originalValues||(i[l].originalValues=i[l].values),i[l].values={};g.query(n,function(t){if(n.running){c.textContent+=".";var r,s=null,l=null;if(x in t&&(r=ee(l=t[x]))in v&&(s=v[r]),!s){var u=e.createElement("tr");o.appendChild(u),s={_htmlRow:u,_subject:l,values:{}},i.push(s),l&&(v[r]=s)}delete s.original,Y(s,a,t)}},void 0,function(){c&&c.parentNode&&c.parentNode.removeChild&&(c.parentNode.removeChild(c),c=null);var e=Date.now()-s;r.Rm("Query done: "+i.length+" rows, "+e+"ms");for(var n=i.length-1;n>=0;n--)if(i[n].original){r.Rm("   deleting row "+i[n]._subject);var o=i[n]._htmlRow;o.parentNode.removeChild(o),delete v[ee(i[n]._subject)],i.splice(n,1)}if(t.sortBy){var l=function(e,t){for(var n in e){var r=e[n];if(r.variable.toNT()===t)return r}throw new Error("getColumnForVariable: no column for variable ".concat(t))}(a,t.sortBy);z(i,l,t.sortReverse)}t.onDone&&t.onDone(_)})}function ne(e,t){p.log.debug(">> processing formula");for(var n=0;n<t.statements.length;++n){var r=t.statements[n];if("NamedNode"===r.predicate.termType&&"Variable"===r.object.termType){var i=r.object.toString();if(i in e)e[i].setPredicate(r.predicate,!1,r.subject)}if("NamedNode"===r.predicate.termType&&"Variable"===r.subject.termType){var a=r.subject.toString();if(a in e)e[a].setPredicate(r.predicate,!0,r.object)}}for(var o=0;o<t.optional.length;++o)p.log.debug("recurse to optional subformula "+o),ne(e,t.optional[o]);p.log.debug("<< finished processing formula")}function re(e){for(var t=[],n={},r=0;r<e.vars.length;++r){var i=new O,a=e.vars[r];p.log.debug("column "+r+" : "+a),i.setVariable(a),n[a]=i,t.push(i)}return ne(n,e.pat),t}function ie(t,n){var r;r=h?re(t):n.getColumns();var i=[],a=e.createElement("table");return a.appendChild(function(t,n){var r=e.createElement("tr"),i=e.createElement("th");r.appendChild(i);for(var a=0;a<t.length;++a){var o=e.createElement("th"),s=t[a];o.appendChild(e.createTextNode(s.getLabel())),n&&o.appendChild(H(n,s)),r.appendChild(o)}return r}(r,n)),a.appendChild(function(t,n){var r=e.createElement("tr");r.className="selectors",r.appendChild(e.createElement("td"));for(var i=0;i<n.length;++i){var a=e.createElement("td"),o=K(t,n,n[i]);o&&a.appendChild(o),r.appendChild(a)}return r}(i,r)),a.logicalRows=i,a.columns=r,a.query=t,te(t,i,r,a),a}}},2176(e,t,n){function r(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(r=function(){return!!e})()}n.d(t,{A:()=>r})},2284(e,t,n){function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{A:()=>r})},2327(e,t,n){n.d(t,{A:()=>i});var r=n(2284);function i(e,t){if("object"!=(0,r.A)(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=(0,r.A)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}},2465(e,t,n){n.d(t,{YM:()=>m,n6:()=>b,oQ:()=>y,oy:()=>x,x6:()=>g});var r=n(467),i=n(3029),a=n(2901),o=n(4756),s=n.n(o),c=n(7423),l=n(2893),u=n(5175),d=n(1795),p=n(4961),f=n(8249),h=n(6855),m=function(){return(0,a.A)(function e(t,n){(0,i.A)(this,e),this.channel=t,this.channelRoot=t.doc(),this.options=n,this.dateFolder=new l.J(this.channelRoot,"chat.ttl"),this.div=null},[{key:"createMessage",value:(o=(0,r.A)(s().mark(function e(t){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.updateMessage(t));case 1:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"updateMessage",value:(n=(0,r.A)(s().mark(function e(t){var n,r,i,a,o,l,m,g,v,y,w,A,x,E,C,k,_,S,T,R=arguments;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=R.length>1&&void 0!==R[1]?R[1]:null,r=R.length>2?R[2]:void 0,i=R.length>3&&void 0!==R[3]?R[3]:null,a=[],o=new Date,l=""+o.getTime(),m=p.term(o),g=n?n.doc():this.dateFolder.leafDocumentFromDate(o),v=u.M_.sym(g.uri+"#Msg"+l),y=u.jO.currentUser(),(w=(0,f.YJ)()).id=v.uri,!n){e.next=4;break}if((A=u.M_.any(n,d.A.foaf("maker"))).uri!==y.uri){e.next=2;break}return e.next=1,b(n);case 1:x=e.sent,a.push(p.st(x,d.A.dct("isReplacedBy"),v,g)),(E=u.M_.any(x,d.A.sioc("has_reply")))&&a.push(p.st(v,d.A.sioc("has_reply"),E,g)),r&&a.push(p.st(v,d.A.schema("dateDeleted"),m,g)),e.next=3;break;case 2:throw C="Error you cannot delete/edit a message from someone else : \n"+A.uri,c.R8(C),alert(C),new Error(C);case 3:e.next=5;break;case 4:a.push(p.st(this.channel,d.A.wf("message"),v,g));case 5:if(a.push(p.st(v,d.A.sioc("content"),u.M_.literal(t),g)),w.content=t,a.push(p.st(v,d.A.dct("created"),m,g)),w.created=m.value,!y){e.next=7;break}return a.push(p.st(v,d.A.foaf("maker"),y,g)),w.maker=y.uri,e.next=6,(0,h.Tn)(y);case 6:k=e.sent,_=(0,f.vt)(w,k),a.push(p.st(v,p.sym("".concat(f.yv,"proofValue")),p.lit(_),g));case 7:return i&&(a.push(p.st(i,d.A.sioc("has_member"),v,g)),i.doc().sameTerm(v.doc())||a.push(p.st(i,d.A.sioc("has_member"),v,i.doc()))),e.prev=8,e.next=9,u.M_.updater.updateMany([],a);case 9:e.next=11;break;case 10:throw e.prev=10,T=e.catch(8),S="Error saving chat message: "+T,c.R8(S),alert(S),new Error(S);case 11:return e.abrupt("return",v);case 12:case"end":return e.stop()}},e,this,[[8,10]])})),function(e){return n.apply(this,arguments)})},{key:"deleteMessage",value:(t=(0,r.A)(s().mark(function e(t){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.updateMessage("(message deleted)",t,!0));case 1:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"createThread",value:(e=(0,r.A)(s().mark(function e(t){var n,r,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.M_.each(t,d.A.sioc("has_reply"),null,t.doc()).filter(function(e){return u.M_.holds(e,d.A.rdf("type"),d.A.sioc("Thread"),e.doc())}),!(n.length>0)){e.next=1;break}return e.abrupt("return",n[0]);case 1:return r=p.sym(t.uri+"-thread"),i=[p.st(r,d.A.rdf("type"),d.A.sioc("Thread"),r.doc()),p.st(t,d.A.sioc("has_reply"),r,r.doc())],e.next=2,u.M_.updater.update([],i);case 2:return e.abrupt("return",r);case 3:case"end":return e.stop()}},e)})),function(t){return e.apply(this,arguments)})}]);var e,t,n,o}();function g(e){return v.apply(this,arguments)}function v(){return(v=(0,r.A)(s().mark(function e(t){var n,r,i,a,o;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[t],(r={})[t.uri]=!0,i=t;case 1:if((a=u.M_.any(null,d.A.dct("isReplacedBy"),i,i.doc()))&&!r[a.uri]){e.next=2;break}return e.abrupt("continue",4);case 2:return e.next=3,u.M_.fetcher.load(a);case 3:n.unshift(a),r[a.uri]=!0,i=a,e.next=1;break;case 4:i=t;case 5:if((o=u.M_.any(i,d.A.dct("isReplacedBy"),null,i.doc()))&&!r[o.uri]){e.next=6;break}return e.abrupt("continue",7);case 6:n.push(o),r[o.uri]=!0,i=o,e.next=5;break;case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function y(e){return w.apply(this,arguments)}function w(){return(w=(0,r.A)(s().mark(function e(t){var n,r;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t,r={};case 1:if(!n){e.next=4;break}if(!r[n.uri]){e.next=2;break}return c.z3("originalVersion: verion loop"+t),e.abrupt("return",t);case 2:return r[n.uri]=!0,t=n,e.next=3,u.M_.fetcher.load(t);case 3:n=u.M_.any(null,d.A.dct("isReplacedBy"),t,t.doc()),e.next=1;break;case 4:return e.abrupt("return",t);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function b(e){return A.apply(this,arguments)}function A(){return(A=(0,r.A)(s().mark(function e(t){var n,r;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t,r={};case 1:if(!n){e.next=4;break}if(!r[n.uri]){e.next=2;break}return c.z3("mostRecentVersion: verion loop"+t),e.abrupt("return",t);case 2:return r[n.uri]=!0,t=n,e.next=3,u.M_.fetcher.load(t);case 3:n=u.M_.any(t,d.A.dct("isReplacedBy"),null,t.doc()),e.next=1;break;case 4:return e.abrupt("return",t);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function x(e){return u.M_.holds(e,d.A.schema("dateDeleted"),null,e.doc())}},2825(e,t,n){n.d(t,{j:()=>r});var r='\n<svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 26 26" fill="none">\n    <path fill-rule="evenodd" clip-rule="evenodd" d="M13 25C19.6274 25 25 19.6274 25 13C25 6.37258 19.6274 1 13 1C6.37258 1 1 6.37258 1 13C1 19.6274 6.37258 25 13 25Z" fill="#D8D8D8" stroke="#8B8B8B"/>\n    <mask id="mask0" mask-type="alpha" maskUnits="userSpaceOnUse" x="0" y="0" width="26" height="26">\n        <path fill-rule="evenodd" clip-rule="evenodd" d="M13 25C19.6274 25 25 19.6274 25 13C25 6.37258 19.6274 1 13 1C6.37258 1 1 6.37258 1 13C1 19.6274 6.37258 25 13 25Z" fill="white" stroke="white"/>\n    </mask>\n    <g mask="url(#mask0)">\n        <path fill-rule="evenodd" clip-rule="evenodd" d="M17.0468 10.4586C17.0468 14.4979 15.4281 16.9214 12.9999 16.9214C10.5718 16.9214 8.95298 14.4979 8.95298 10.4586C8.95298 6.41931 12.9999 6.41931 12.9999 6.41931C12.9999 6.41931 17.0468 6.41931 17.0468 10.4586ZM4.09668 23.3842C6.52483 17.7293 12.9999 17.7293 12.9999 17.7293C12.9999 17.7293 19.475 17.7293 21.9031 23.3842C21.9031 23.3842 17.8481 25 12.9999 25C8.15169 25 4.09668 23.3842 4.09668 23.3842Z" fill="#8B8B8B"/>\n    </g>\n</svg>'},2893(e,t,n){n.d(t,{J:()=>h});var r=n(3029),i=n(2901),a=n(467),o=n(4756),s=n.n(o),c=n(7423),l=n(5175),u=n(1795),d=n(4961);function p(e){return f.apply(this,arguments)}function f(){return(f=(0,a.A)(s().mark(function e(t){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,l.M_.fetcher.load(t);case 1:return e.abrupt("return",!(l.M_.statementsMatching(null,u.A.dct("created"),null,t).length>0));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var h=function(){return(0,i.A)(function e(t,n,i){(0,r.A)(this,e),this.root=t,this.rootFolder=t.dir(),this.leafFileName=n||"index.ttl",this.membershipProperty=i||u.A.wf("leafObject")},[{key:"leafDocumentFromDate",value:function(e){var t=e.toISOString().split("T")[0].replace(/-/g,"/");return t=this.root.dir().uri+t+"/"+this.leafFileName,l.M_.sym(t)}},{key:"dateFromLeafDocument",value:function(e){var t=this.rootFolder.uri.length,n=e.uri.slice(t,t+10).replace(/\//g,"-");return new Date(n)}},{key:"loadPrevious",value:(t=(0,a.A)(s().mark(function e(t,n){var r,i,o,d,f,h;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=function(){return(i=(0,a.A)(s().mark(function e(t,i){var a,o,d,p,f,h,m,g,v,y;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d=function(e){return(e=e.filter(o)).sort(),n||e.reverse(),e.pop()},o=function(e){var t=e.uri.slice(0,-1).split("/").slice(-1)[0];return!!"0123456789".includes(t[0])},a=function(e){return!(n?e.uri>=t.uri:e.uri<=t.uri)},p=t.dir(),e.prev=1,e.next=2,l.M_.fetcher.load(p);case 2:if(f=(f=l.M_.each(p,u.A.ldp("contains"))).filter(a),!(h=d(f))){e.next=3;break}return e.abrupt("return",h);case 3:e.next=6;break;case 4:if(e.prev=4,!(y=e.catch(1)).response||!y.response.status||404!==y.response.status){e.next=5;break}c.Rm("Error 404 for chat parent file "+p),e.next=6;break;case 5:throw c.Rm("*** Error NON 404 for chat parent file "+p),new Error("*** ".concat(y.message," for chat folder ").concat(p));case 6:if(0!==i){e.next=7;break}return e.abrupt("return",null);case 7:return e.next=8,r(p,i-1);case 8:if(m=e.sent){e.next=9;break}return e.abrupt("return",null);case 9:return e.next=10,l.M_.fetcher.load(m);case 10:return g=l.M_.each(m,u.A.ldp("contains")),v=d(g),e.abrupt("return",v);case 11:case"end":return e.stop()}},e,null,[[1,4]])}))).apply(this,arguments)},r=function(e,t){return i.apply(this,arguments)},o=this.leafDocumentFromDate(t).dir();case 1:return e.next=2,r(o,3);case 2:if(!(d=e.sent)){e.next=6;break}return f=l.M_.sym(d.uri+this.leafFileName),h=this.dateFromLeafDocument(f),e.next=3,p(f);case 3:if(e.sent){e.next=4;break}return e.abrupt("return",h);case 4:t=h,o=this.leafDocumentFromDate(t).dir();case 5:e.next=7;break;case 6:return e.abrupt("return",null);case 7:e.next=1;break;case 8:case"end":return e.stop()}},e,this)})),function(e,n){return t.apply(this,arguments)})},{key:"firstLeaf",value:(e=(0,a.A)(s().mark(function e(t){var n,r,i,o,l,p,f,h,m,g,v;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=function(){return(o=(0,a.A)(s().mark(function e(i){var a,o;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(e){var t=e.uri.slice(0,-1).split("/").slice(-1)[0];return!!"0123456789".includes(t[0])},delete r.requested[i.uri],e.next=1,r.load(i,{force:!0});case 1:if(0!==(o=(o=n.each(i,u.A.ldp("contains"))).filter(a)).length){e.next=2;break}throw new Error(" @@@  No children to         parent2 "+i);case 2:return o.sort(),t&&o.reverse(),e.abrupt("return",o[0]);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)},i=function(e){return o.apply(this,arguments)},n=d.graph(),r=new d.Fetcher(n),e.next=1,i(this.root.dir());case 1:return l=e.sent,e.next=2,i(l);case 2:return p=e.sent,e.next=3,i(p);case 3:return f=e.sent,h=d.sym(f.uri+"chat.ttl"),e.next=4,r.load(h);case 4:if(0!==(m=n.each(this.root,this.membershipProperty,null,h)).length){e.next=5;break}throw g="  INCONSISTENCY -- no chat leafObject in file "+h,c.uP(g),new Error(g);case 5:return(v=m.map(function(e){return[n.any(e,u.A.dct("created")),e]})).sort(),t&&v.reverse(),e.abrupt("return",v[0][1]);case 6:case"end":return e.stop()}},e,this)})),function(t){return e.apply(this,arguments)})}]);var e,t}()},2901(e,t,n){n.d(t,{A:()=>a});var r=n(9922);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(0,r.A)(i.key),i)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}},3029(e,t,n){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{A:()=>r})},3145(e,t,n){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{A:()=>r})},3262(e,t,n){n.d(t,{LV:()=>W,Uh:()=>U,zt:()=>j});var r=n(4467),i=n(467),a=n(4756),o=n.n(a),s=n(9509),c=n(5187),l=n(7236),u=n(2465),d=n(7423),p=n(3378),f=n(5175),h=n(967),m=n(6127),g=n(1795),v=n(8153),y=n(3605),w=n(675),b=n(9612),A=n(386),x=n(3291),E=n(3468),C=n(8249),k=n(6855);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach(function(t){(0,r.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function T(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return R(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var L=window.document,I=w.i.messageBodyStyle,P=b.P;function N(e,t){var n=L.createElement("img"),r="10";t.inlineImageHeightEms&&(r=(""+t.inlineImageHeightEms).trim()),n.setAttribute("style","max-height: "+r+"em; border-radius: 1em; margin: 0.7em;"),e&&n.setAttribute("src",e);var i=L.createElement("a");return i.setAttribute("href",e),i.setAttribute("target","images"),i.appendChild(n),A.eB(n,$rdf.sym(e)),i}var O=function(e,t){var n=L.createElement("a");return t&&t.uri&&(n.setAttribute("href",t.uri),n.addEventListener("click",x.ol,!0),n.setAttribute("style","color: #3B5998; text-decoration: none; ")),n.textContent=e,n};function M(e){var t=f.M_.any(e,g.A.foaf("nick"));return t?""+t.value:""+P(e)}function B(e,t,n,r){var i=e.appendChild(O(M(t),t));t.uri&&f.M_.fetcher.nowOrWhenFetched(t.doc(),void 0,function(e,n){i.textContent=M(t)}),e.appendChild(L.createElement("br")),e.appendChild(O(n,r))}function D(e,t,n,r){var i=e.appendChild(O(P(t),t));t.uri&&f.M_.fetcher.nowOrWhenFetched(t.doc(),void 0,function(e,n){i.textContent=M(t)});var a=e.appendChild(O(n,r));a.style.fontSize="80%",a.style.marginLeft="1em",e.appendChild(L.createElement("br"))}function U(e,t,n,r,i){return F.apply(this,arguments)}function F(){return F=(0,i.A)(o().mark(function e(t,n,r,a,s){var l,h,m,y,w,b,A,E,_,R,P,O,M,U,F,j,H,W,V,z,$,J,q,K,G,Z,Q,X,Y,ee,te,ne,re,ie,ae;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return ne=function(e){return e?"#e8ffe8":"white"},l=!1,h="1"===a.colorizeByAuthor||!0===a.colorizeByAuthor,m=f.M_.any(n,g.A.foaf("maker")),y=f.M_.any(n,g.A.dct("created")),e.next=1,(0,u.n6)(n);case 1:return w=e.sent,b=f.M_.any(w,g.A.foaf("maker")),A=m.uri===(null==b?void 0:b.uri)?w:n,E=f.M_.any(A,g.A.sioc("content")),e.next=2,(0,u.x6)(A);case 2:(_=e.sent).length>1&&d.Rm("renderMessageRow versions: ",_.join(",  ")),R=_.map(function(e){return f.M_.each(e,g.A.sioc("has_reply"))}).flat(),P=null,O=[],M=T(R);try{for(M.s();!(U=M.n()).done;)F=U.value,f.M_.holds(F,g.A.rdf("type"),g.A.sioc("Thread"))?(P=F,d.Rm("renderMessageRow: found thread: "+P)):O.push(F)}catch(e){M.e(e)}finally{M.f()}return O.length>1&&d.Rm("renderMessageRow: found normal replies: ",O),P||(P=f.M_.any(null,g.A.sioc("has_member"),n)),j=f.M_.any(A,$rdf.sym("".concat(C.yv,"proofValue"))),(H=(0,C.YJ)()).id=A.uri,H.created=f.M_.any(A,g.A.dct("created")).value,H.content=E.value,H.maker=m.uri,null!=j&&j.value?(0,k.lG)(m).then(function(e){e||d.R8("message is signed but "+m.uri+" is missing publicKey");null!=e&&e.match(/[0-9A-Fa-f]{6}/g)?null!=j&&j.value&&!(0,C.Od)(null==j?void 0:j.value,H,e)&&d.R8("invalid signature\n"+H.id):d.R8("invalid publicKey hex string\n"+m.uri+"\n"+e)}):(l=!0,d.R8(A.uri+" is unsigned")),e.next=3,(0,u.oQ)(n);case 3:return W=e.sent,V=!n.sameTerm(W),z=f.M_.the(W,g.A.dct("created"),null,W.doc())||f.M_.the(n,g.A.dct("created"),null,n.doc()),$=L.createElement("tr"),l&&$.setAttribute("style","background-color: red"),$.AJAR_date=z.value,$.AJAR_subject=n,J=L.createElement("td"),$.appendChild(J),a.authorDateOnLeft?B(J,m,x.XV(z.value),n):((q=L.createElement("img")).setAttribute("style","max-height: 2.5em; max-width: 2.5em; border-radius: 0.5em; margin: auto;"),x.g7(q,m),J.appendChild(q)),K=x.XV(z.value),V&&(K+=" ... "+x.XV(y.value)),G=$.appendChild(L.createElement("td")),a.authorDateOnLeft||D(G,m,K,n),Z=E?E.value.trim():"??? no content?",Q=/^https?:\/[^ <>]*$/i.test(Z),X=null,Q?/\.(gif|jpg|jpeg|tiff|png|svg)$/i.test(Z)&&a.expandImagesInline?(Y=N(Z,a),G.appendChild(Y)):(ee=G.appendChild(L.createElement("a")),X=ee.appendChild(L.createElement("p")),ee.href=Z,X.textContent=Z,G.appendChild(ee)):(X=L.createElement("p"),G.appendChild(X),X.textContent=Z),X&&(te=h?v.lightColorHash(m):ne(r),X.setAttribute("style",I+"background-color: "+te+";")),e.next=4,(0,c.lk)(n,n.doc());case 4:return(re=e.sent).children.length&&(G.appendChild(L.createElement("br")),G.appendChild(re)),ie=L.createElement("td"),$.appendChild(ie),ae=x.x6(L,p.Pt.iconBase+"noun_243787.svg","..."),ie.appendChild(ae),ae.addEventListener("click",function(){var e=(0,i.A)(o().mark(function e(r){var i,l,u;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!$.toolTR){e.next=1;break}return $.parentNode.removeChild($.toolTR),delete $.toolTR,e.abrupt("return");case 1:return i=L.createElement("tr"),e.next=2,(0,c.tJ)(n,$,S(S({},s),{},{chatOptions:a}),t);case 2:(l=e.sent).style="border: 0.05em solid #888; border-radius: 0 0 0.7em 0.7em;  border-top: 0; height:3.5em; background-color: #fff;",$.nextSibling?$.parentElement.insertBefore(i,$.nextSibling):$.parentElement.appendChild(i),$.toolTR=i,i.appendChild(L.createElement("td")),u=i.appendChild(L.createElement("td")),i.appendChild(L.createElement("td")),u.appendChild(l);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),P&&a.showThread&&ie.appendChild(x.x6(L,p.Pt.iconBase+"noun_1180164.svg","see thread",function(e){a.showThread(P,a)})),e.abrupt("return",$);case 5:case"end":return e.stop()}},e)})),F.apply(this,arguments)}function j(e,t,n,r){return H.apply(this,arguments)}function H(){return(H=(0,i.A)(o().mark(function e(t,n,r,i){var a,s,c,l,d,p,f;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.parentNode,c=W,l=r,d=a,p=i,f=r.options,e.next=1,(0,u.n6)(n);case 1:s=c(l,d,p,f,e.sent),a.insertBefore(s,t),s.originalRow=t,t.style.visibility="hidden";case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function W(e,t,n,r,a){function c(e){return u.apply(this,arguments)}function u(){return(u=(0,i.A)(o().mark(function e(t){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,v(R.value,!0);case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function v(e,t){return b.apply(this,arguments)}function b(){return b=(0,i.A)(o().mark(function c(l,u){var p,f,h,m;return o().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return f=function(){return f=(0,i.A)(o().mark(function i(c,l){var p;return o().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=1,(0,s.rg)(e,t,c,!1,r,n);case 1:a?((p=N.originalRow).parentNode?p.parentNode.removeChild(p):(d.R8("No parentNode on old message "+p.textContent),p.style.backgroundColor="#fee",p.style.visibility="hidden"),N.parentNode.removeChild(N)):u&&(R.value="",R.setAttribute("style",I),R.disabled=!1,R.scrollIntoView(r.newestFirst),R.focus(),R.select());case 2:case"end":return i.stop()}},i)})),f.apply(this,arguments)},p=function(e,t){return f.apply(this,arguments)},u&&(R.setAttribute("style",I+"color: #bbb;"),R.disabled=!0),c.prev=1,c.next=2,e.updateMessage(l,a,null,r.thread);case 2:h=c.sent,c.next=4;break;case 3:return c.prev=3,m=c.catch(1),(n.statusArea||N).appendChild(E.F(L,"Error writing message: "+m)),c.abrupt("return");case 4:return c.next=5,p(h,l);case 5:case"end":return c.stop()}},c,null,[[1,3]])})),b.apply(this,arguments)}function C(e){var n=t.chatDocument.dir().uri;A.Zn(f.M_.fetcher,e,n+"Files",n+"Pictures",function(){var e=(0,i.A)(o().mark(function e(t,n){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,v(n);case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}())}var k,_,S=function(){var e=(0,i.A)(o().mark(function e(t){var n,r,i,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=T(t),e.prev=1,n.s();case 2:if((r=n.n()).done){e.next=4;break}return i=r.value,e.next=3,v(i);case 3:e.next=2;break;case 4:e.next=6;break;case 5:e.prev=5,a=e.catch(1),n.e(a);case 6:return e.prev=6,n.f(),e.finish(6);case 7:case"end":return e.stop()}},e,null,[[1,5,6,7]])}));return function(t){return e.apply(this,arguments)}}();a?(k=f.M_.anyValue(a,g.A.dct("created"),null,a.doc()),_=p.Pt.iconBase+"noun_1180158.svg"):(_=p.Pt.iconBase+"noun_383448.svg",k="9999-01-01T00:00:00Z");var R,P,N=L.createElement("tr"),O=L.createElement("td"),M=L.createElement("td"),D=L.createElement("td");N.appendChild(O),N.appendChild(M),N.appendChild(D),N.AJAR_date=k;var U={div:M,dom:L};return(0,h.ensureLoggedIn)(U).then(function(t){!function(){function t(){return(t=(0,i.A)(o().mark(function e(t){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=1;break}return e.next=1,v(t.uri);case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}if(r.menuHandler){var n=x.x6(L,p.Pt.iconBase+"noun_243787.svg","More");n.setAttribute("style",w.i.buttonStyle+"float: right;"),D.appendChild(n)}r.menuHandler;var s=f.jO.currentUser();if(B(O,s,"",null),R=L.createElement("textarea"),M.innerHTML="",M.appendChild(R),R.rows=3,a&&(R.value=f.M_.anyValue(a,g.A.sioc("content"),null,a.doc())),R.setAttribute("style",I+"background-color: #eef;"),R.addEventListener("keydown",function(){var e=(0,i.A)(o().mark(function e(t){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==t.code){e.next=1;break}if(!(!t.shiftKey&&!r.shiftEnterSendsMessage||t.shiftKey&&r.shiftEnterSendsMessage)){e.next=1;break}return e.next=1,c(t);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),!1),A.DK(R,S,C),D.innerHTML="",(P=x.x6(L,_,"Send")).style.float="right",P.addEventListener("click",function(e){return c()},!1),D.appendChild(P),a){var l=D.appendChild(x.x7(L));l.style.float="left",l.addEventListener("click",function(e){return function(e){e.originalRow.style.visibility="visible",e.parentNode.removeChild(e)}(N)},!1),D.appendChild(l)}var u=e.dateFolder.leafDocumentFromDate(new Date);M.appendChild(m.$.cameraButton(L,f.M_,function(){return $rdf.sym(u.dir().uri+"Image_"+Date.now()+".png")},function(e){return t.apply(this,arguments)})),y.recordParticipation(e.channel,e.channel.doc())}(),Object.assign(t,n),(0,l.z6)(t).then(function(e){})}),N}},3291(e,t,n){n.d(t,{$J:()=>Q,Ag:()=>Y,CS:()=>ne,Cl:()=>j,DT:()=>X,EW:()=>b,F1:()=>I,IC:()=>S,JK:()=>re,Mj:()=>k,PO:()=>O,Pe:()=>te,Pg:()=>G,Qf:()=>K,Qy:()=>M,RG:()=>F,RS:()=>ee,Ss:()=>z,UH:()=>V,XV:()=>x,ZT:()=>L,cZ:()=>ie,cc:()=>w,er:()=>A,fT:()=>oe,g7:()=>N,i:()=>_,kz:()=>U,ly:()=>W,ol:()=>q,p_:()=>T,r6:()=>E,ri:()=>H,sf:()=>J,uA:()=>Z,uS:()=>$,vE:()=>C,wu:()=>ae,x6:()=>B,x7:()=>D});var r=n(4961),i=n(3378),a=n(1795),o=n(675),s=n(7423),c=n(4158),l=n(386),u=n(5175),d=n(52),p=n(9612),f=n(3468),h=n(9287),m=n(9326),g=i.Pt.iconBase,v=g+"noun_1180156.svg",y=g+"noun_1180158.svg";function w(e,t){if(t){var n=function(e){var t=e&&e.statusArea||e&&e.div||null;if(t)return t;var n=e&&e.dom;if(n||"undefined"==typeof document||(n=document),n){var r=n.getElementsByTagName("body")[0];return t=n.createElement("div"),r.insertBefore(t,r.firstElementChild),e&&(e.statusArea=t),t}return null}(e);s.Rm("Complaint: "+t),n?n.appendChild((0,f.F)(e&&e.dom||document,t)):alert(t)}}function b(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function A(e){var t=e.search(/logFile=/),n=e.search(/&rulesFile=/);return e.substring(t+8,n)}function x(e,t){if(!e)return"???";try{var n=(new Date).toISOString();return e.slice(0,10)!==n.slice(0,10)||t?e.slice(0,4)===n.slice(0,4)?["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][parseInt(e.slice(5,7),10)-1]+" "+parseInt(e.slice(8,10),10):e.slice(0,10):e.slice(11,16)}catch(e){return"shortdate:"+e}}function E(e,t){return t.split("{").map(function(t){var n=t.split("}")[0];return t?("000"+(e["get"+n]()+({Month:1}[n]||0))).slice(-({Milliseconds:3,FullYear:4}[n]||2))+t.split("}")[1]:""}).join("")}function C(){return E(new Date,"{FullYear}-{Month}-{Date}T{Hours}:{Minutes}:{Seconds}.{Milliseconds}")}function k(){return E(new Date,"{Hours}:{Minutes}:{Seconds}.{Milliseconds}")}function _(e,t){var n=u.M_,r=function(e){var t=n.any(e,a.A.vcard("fn"))||n.any(e,a.A.foaf("name"))||n.any(e,a.A.vcard("organization-name"));return t?t.value:null},i=t.sameTerm(a.A.foaf("Agent"))?"Everyone":r(t);if(e.textContent=i||p.P(t),!i&&t.uri){if(!n.fetcher)throw new Error("kb has no fetcher");n.fetcher.nowOrWhenFetched(t.doc(),void 0,function(n){e.textContent=r(t)||p.P(t)})}}function S(e,t){return t.each(e,a.A.sioc("avatar")).concat(t.each(e,a.A.foaf("img"))).concat(t.each(e,a.A.vcard("logo"))).concat(t.each(e,a.A.vcard("hasPhoto"))).concat(t.each(e,a.A.vcard("photo"))).concat(t.each(e,a.A.foaf("depiction")))}var T={"solid:AppProviderClass":"noun_144.svg","solid:AppProvider":"noun_15177.svg","solid:Pod":"noun_Cabinet_1434380.svg","vcard:Group":"noun_339237.svg","vcard:Organization":"noun_143899.svg","vcard:Individual":"noun_15059.svg","schema:Person":"noun_15059.svg","foaf:Person":"noun_15059.svg","foaf:Agent":"noun_98053.svg","acl:AuthenticatedAgent":"noun_99101.svg","prov:SoftwareAgent":"noun_Robot_849764.svg","vcard:AddressBook":"noun_15695.svg","trip:Trip":"noun_581629.svg","meeting:LongChat":"noun_1689339.svg","meeting:Meeting":"noun_66617.svg","meeting:Project":"noun_1036577.svg","ui:Form":"noun_122196.svg","rdfs:Class":"class-rectangle.svg","rdf:Property":"property-diamond.svg","owl:Ontology":"noun_classification_1479198.svg","wf:Tracker":"noun_122196.svg","wf:Task":"noun_17020_gray-tick.svg","wf:Open":"noun_17020_sans-tick.svg","wf:Closed":"noun_17020.svg"};function R(e){var t=e.uri.split("#")[0],n=t.indexOf("//");if(n<0)throw new Error("This URI does not have a web site part (origin)");var r=t.indexOf("/",n+2);return r<0?t.slice(0)+"/":t.slice(0,r+1)}function L(e){var t=g;return"string"!=typeof e&&e.uri?4!==e.uri.split("/").length||e.uri.split("/")[1]||e.uri.split("/")[3]?e.uri.startsWith("message:")||e.uri.startsWith("mid:")?t+"noun_480183.svg":e.uri.startsWith("mailto:")?t+"noun_567486.svg":e.uri.startsWith("https:")&&e.uri.indexOf("#")<0?R(e)+"favicon.ico":null:t+"noun_15177.svg":t+"noun_10636_grey.svg"}function I(e){var t=u.M_,n=g;if(e.sameTerm(a.A.foaf("Agent"))||e.sameTerm(a.A.rdf("Resource")))return n+"noun_98053.svg";var r=t.any(e,a.A.sioc("avatar"))||t.any(e,a.A.foaf("img"))||t.any(e,a.A.vcard("logo"))||t.any(e,a.A.vcard("hasPhoto"))||t.any(e,a.A.vcard("photo"))||t.any(e,a.A.foaf("depiction"));return r?r.uri:null}function P(e,t,n){var r=u.M_,i=I(t);if(i)return e.setAttribute("src",i),!0;var a=n[t.uri];if(a)return e.setAttribute("src",a),e.style=o.i.classIconStyle,!0;var s=L(t);if(s)return e.setAttribute("src",s),!0;var c=r.findTypeURIs(t);for(var l in c)if(n[l])return e.setAttribute("src",n[l]),!1;return e.setAttribute("src",g+"noun_10636_grey.svg"),!1}function N(e,t){var n=u.M_,i={};for(var o in T){var s=o.split(":")[0],c=o.split(":")[1],l=a.A[s](c);i[l.uri]=r.uri.join(T[o],g)}if(!P(e,t,i)&&t.uri){if(!n.fetcher)throw new Error("kb has no fetcher");n.fetcher.nowOrWhenFetched(t.doc(),void 0,function(n){n&&P(e,t,i)})}}function O(e,t){var n=e.createElement("img");n.style=o.i.iconStyle;if(n.setAttribute("src",g+(function(e){if(!e.uri)return!1;var t=e.uri.split("/");return 3===t.length||4===t.length&&""===t[3]}(t)?"noun_15177.svg":"noun_681601.svg")),t.uri&&t.uri.startsWith("https:")&&t.uri.indexOf("#")<0){var r=e.createElement("object");return r.setAttribute("data",R(t)+"favicon.ico"),r.setAttribute("type","image/x-icon"),r.appendChild(n),r}return N(n,t),n}function M(e,t,n,r){var a=g+"noun_2188_red.svg",s=e.createElement("img");s.setAttribute("src",a),s.setAttribute("style",o.i.smallButtonStyle),s.style.float="right";var c="Remove this "+n;return s.title=c,s.classList.add("hoverControlHide"),s.addEventListener("click",function(){var n=e.createElement("div");t.insertBefore(n,s),n.style.position="relative",n.appendChild(function(e,t,n,r){function a(){t.parentElement.removeChild(t)}function s(){a(),r()}var c=e.createElement("div");c.style=o.i.confirmPopupStyle,c.style.position="absolute",c.style.top="-1em",c.style.display="grid",c.style.gridTemplateColumns="auto auto";var l=e.createElement("div");l.style.gridColumn="1/2",l.style.gridRow="1";var u=e.createElement("div");u.style.gridColumn="1/2",u.style.gridRow="2";var d=D(e,a);c.appendChild(d),d.style.gridColumn="1",d.style.gridRow="2";var p=c.appendChild(e.createElement("button"));p.style=o.i.buttonStyle,p.style.gridRow="2",p.style.gridColumn="2",p.textContent="Cancel";var f=B(e,i.Pt.iconBase+"noun_925021.svg","Delete it");c.appendChild(f),f.style.gridRow="1",f.style.gridColumn="1";var h=c.appendChild(e.createElement("button"));return h.style=o.i.buttonStyle,h.style.gridRow="1",h.style.gridColumn="2",h.textContent=n,c.appendChild(h),f.addEventListener("click",s),h.addEventListener("click",s),p.addEventListener("click",a),c}(e,n,c,r))}),t.classList.add("hoverControl"),t.appendChild(s),s.setAttribute("data-testid","deleteButtonWithCheck"),s}function B(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{buttonColor:"Primary",needsBorder:!1},a=e.createElement("button");if(a.setAttribute("type","button"),t){var s=a.appendChild(e.createElement("img"));s.setAttribute("src",t),s.setAttribute("style","width: 2em; height: 2em;"),s.title=n,a.setAttribute("style",o.i.buttonStyle)}else a.textContent=n.toLocaleUpperCase(),a.onmouseover=function(){"Secondary"===i.buttonColor?i.needsBorder?a.setAttribute("style",o.i.secondaryButtonNoBorderHover):a.setAttribute("style",o.i.secondaryButtonHover):i.needsBorder?a.setAttribute("style",o.i.primaryButtonNoBorderHover):a.setAttribute("style",o.i.primaryButtonHover)},a.onmouseout=function(){"Secondary"===i.buttonColor?i.needsBorder?a.setAttribute("style",o.i.secondaryButtonNoBorder):a.setAttribute("style",o.i.secondaryButton):i.needsBorder?a.setAttribute("style",o.i.primaryButtonNoBorder):a.setAttribute("style",o.i.primaryButton)},"Secondary"===i.buttonColor?i.needsBorder?a.setAttribute("style",o.i.secondaryButtonNoBorder):a.setAttribute("style",o.i.secondaryButton):i.needsBorder?a.setAttribute("style",o.i.primaryButtonNoBorder):a.setAttribute("style",o.i.primaryButton);return r&&a.addEventListener("click",r,!1),a}function D(e,t){var n=B(e,v,"Cancel",t);return n.firstChild&&(n.firstChild.style.opacity="0.3"),n}function U(e,t){return B(e,y,"Continue",t)}function F(e,t,n,r,i,s){return new Promise(function(t,c){var l=e.createElement("div");r=r||a.A.foaf("name");var u=(s=s||(i?p.P(i):"  "))+" "+p.P(r)+": ";l.appendChild(e.createElement("p")).textContent=u;var d=e.createElement("input");function f(){l.parentNode.removeChild(l),t(d.value.trim())}d.setAttribute("type","text"),d.setAttribute("size","100"),d.setAttribute("maxLength","2048"),d.setAttribute("style",o.i.textInputStyle),d.select(),l.appendChild(d),n.appendChild(l),d.addEventListener("keyup",function(e){13===e.keyCode&&f()},!1),l.appendChild(e.createElement("br")),l.appendChild(D(e,function(e){l.parentNode.removeChild(l),t(null)})),l.appendChild(U(e,function(e){f()})),d.focus()})}var j=H;function H(e,t,n,r){var i=e.createElement("tr");r=r||{};var a=i.appendChild(e.createElement("td")),o=i.appendChild(e.createElement("td")),s=i.appendChild(e.createElement("td")),c=r.image||O(e,n);if(a.setAttribute("style","vertical-align: middle; width:2.5em; padding:0.5em; height: 2.5em;"),o.setAttribute("style","vertical-align: middle; text-align:left;"),s.setAttribute("style","vertical-align: middle; width:2em; padding:0.5em; height: 4em;"),a.appendChild(c),r.title?o.textContent=r.title:_(o,n),r.deleteFunction&&M(e,s,r.noun||"one",r.deleteFunction),n.uri){if(!1!==r.link)s.appendChild((0,m.w)(e,n)).classList.add("HoverControlHide"),s.appendChild(e.createElement("br"));!1!==r.draggable&&(c.setAttribute("draggable","false"),(0,l.eB)(i,n))}return i.subject=n,i}function W(e,t,n,r){var i=t.appendChild(e.createElement("div"));n?i.textContent=n:_(i,r)}function V(e,t,n,r){var i=t.appendChild(e.createElement("div"));i.setAttribute("style",o.i.linkDivStyle),r.deleteFunction&&M(e,i,r.noun||"one",r.deleteFunction),n.uri&&(!1!==r.link&&(0,m.O)(e,i,n),(0,l.eB)(t,n))}function z(e,t,n){var r=e.createElement("div");r.setAttribute("style",o.i.renderAsDivStyle);var i=(n=n||{}).image||O(e,t);return(0,h.ts)(e,r,i),W(e,r,n.title,t),V(e,r,t,n),n.clickable&&n.onClickFunction&&(0,h.lx)(r,n.onClickFunction),n.wrapInATR?(0,h.I1)(e,r,t):r}function $(e){if(e.refresh)e.refresh();else for(var t=0;t<e.children.length;t++)$(e.children[t])}function J(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};function o(n){var i=n,a={noun:b};return m&&(a.deleteFunction=function(){!function(e){if(!A.updater)throw new Error("kb has no updater");A.updater.update((0,r.st)(t,y,e,h),[],function(e,t,n,r){t?c():w(void 0,"Error deleting one: "+n)})}(i)}),j(e,y,n,a)}var c=function(){var e=A.each(t,y);e.sort(),d.syncTableToArray(k,e,o)};function p(e){var n=[];if(e.forEach(function(e){var i=(0,r.sym)(e);s.Rm("Dropped on attachemnt "+e),n.push((0,r.st)(t,y,i,h))}),!A.updater)throw new Error("kb has no updater");A.updater.update([],n,function(e,t,n,r){t?c():w(void 0,"Error adding one: "+n)})}function f(e){var n,a;(0,l.Zn)(A.fetcher,e,null===(n=i.uploadFolder)||void 0===n?void 0:n.uri,null===(a=i.uploadFolder)||void 0===a?void 0:a.uri,function(e,n){var i=[(0,r.st)(t,y,A.sym(n),h)];if(!A.updater)throw new Error("kb has no updater");A.updater.update([],i,function(e,t,n,r){t?c():w(void 0,"Error adding link to uploaded file: "+n)})})}var h=i.doc||t.doc();void 0===i.modify&&(i.modify=!0);var m=i.modify,v=i.promptIcon||g+"noun_748003.svg",y=i.predicate||a.A.wf("attachment"),b=i.noun||"attachment",A=u.M_,x=n.appendChild(e.createElement("table"));x.setAttribute("style","margin-top: 1em; margin-bottom: 1em;");var E=x.appendChild(e.createElement("tr")),C=E.appendChild(e.createElement("td")),k=E.appendChild(e.createElement("td")).appendChild(e.createElement("table"));if(k.appendChild(e.createElement("tr")),x.refresh=c,c(),m){var _=B(e,v,"Drop attachments here");C.appendChild(_);var S=i.uploadFolder?f:null;if((0,l.DK)(_,p,S),(0,l.DK)(C,p,S),i.uploadFolder){var T=oe(e,f);C.appendChild(T)}}return x}function q(e){e.preventDefault(),e.stopPropagation();var t=d.getTarget(e).getAttribute("href");if(!t)return s.Rm("openHrefInOutlineMode: No href found!\n");var n=window.document;n.outlineManager?n.outlineManager.GotoSubject(u.M_.sym(t),!0,void 0,!0,void 0):window&&window.panes&&window.panes.getOutliner?window.panes.getOutliner().GotoSubject(u.M_.sym(t),!0,void 0,!0,void 0):s.Rm("ERROR: Can't access outline manager in this config")}function K(e){if(void 0!==e.uri){var t=e.uri;if("http://"===t.slice(0,7)){var n=(t=t.slice(7)).indexOf("#");if(n>=0)t=t.slice(0,n);else{var r=t.lastIndexOf("/");if(r<0)return;t=t.slice(0,r)}return u.M_.sym("http://tabulator.org/wiki/annnotation/"+t)}}}function G(){var e={};return u.M_.statementsMatching(void 0,a.A.rdf("type"),void 0).forEach(function(t){t.object.value&&(e[t.object.value]=!0)}),u.M_.statementsMatching(void 0,a.A.rdfs("subClassOf"),void 0).forEach(function(t){t.object.value&&(e[t.object.value]=!0),t.subject.value&&(e[t.subject.value]=!0)}),u.M_.each(void 0,a.A.rdf("type"),a.A.rdfs("Class")).forEach(function(t){t.value&&(e[t.value]=!0)}),e}function Z(e){var t={},n={},r={},i=0,o=0,s=0,l=e.predicateIndex;for(var u in l){"Literal"===l[u][0].object.termType?(n[u]=!0,o++):(r[u]=!0,i++)}for(var d=e.each(void 0,a.A.rdf("type"),a.A.rdf("Property")),p=0;p<d.length;p++){var f=d[p].toNT();r[f]||n[f]||(n[f]=!0,r[f]=!0,s++)}return t.op=r,t.dp=n,(0,c.info)("propertyTriage: ".concat(i," non-lit, ").concat(o," literal. ").concat(s," unknown.")),t}function Q(e,t){var n=e.createElement("button");return n.setAttribute("type","button"),n.textContent="Goto "+p.P(t),n.addEventListener("click",function(n){e.outlineManager.GotoSubject(t,!0,void 0,!0,void 0)},!0),n}function X(e,t){var n=e.createElement("button");return n.setAttribute("type","button"),n.textContent="âœ•",n.addEventListener("click",function(e){t.parentNode.removeChild(t)},!0),n}function Y(e,t,n,r,i,a,o,s,c){return ee(e.createElement("div"),e,t,n,r,i,a,o,s,c)}function ee(e,t,n,r,i,a,o,s,c,l){var u="border: 0.1em solid #ddd; border-bottom: none; width: 95%; height: 2em; padding: 0.5em;",d=null;e.innerHTML="";for(var p=function(e,o){var p,f,h=function(){var e=a?n.each(void 0,i,o):n.each(o,i);w.setAttribute("class",0===e.length?"hideTillHover":""),f.setAttribute("src",s.connectIcon||g+"noun_25830.svg"),f.setAttribute("title",e.length?e.length:"attach")},m=te.twoLine.widgetForClass(r);(p=m(t,o)).setAttribute("style",u);var v=t.createElement("div");v.setAttribute("class","hideTillHover"),v.setAttribute("style","float:right; width:10%");var y=t.createElement("a");y.setAttribute("href",o.uri),y.setAttribute("style","float:right"),v.appendChild(y).textContent=">",e.appendChild(v);var w=t.createElement("div");return w.setAttribute("style",(a?"float:left;":"float:right;")+" width:30px;"),f=t.createElement("img"),h(),w.appendChild(f),e.appendChild(w),p.addEventListener("click",function(e){d===p?(p.setAttribute("style",u),d=null):(d&&d.setAttribute("style",u),p.setAttribute("style",u+"background-color: #ccc; color:black;"),d=p),c(o,e,d===p),h()},!1),f.addEventListener("click",function(e){l(o,e,a,h)},!1),e.appendChild(p),e},f=0;f<o.length;f++){var h=t.createElement("div");e.appendChild(h),p(h,o[f])}return e}var te={};function ne(e,t){for(var n=e.querySelectorAll("link"),r=0;r<n.length;r++)if("stylesheet"===(n[r].getAttribute("rel")||"")&&(n[r].getAttribute("href")||"")===t)return;var i=e.createElement("link");i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href",t),e.getElementsByTagName("head")[0].appendChild(i)}function re(e){return ae(e,"audio")}function ie(e){return ae(e,"video")}function ae(e,t){var n=t||"image",i=u.M_.findTypeURIs(e),a=r.Util.mediaTypeClass(n+"/*").uri.split("*")[0];for(var o in i)if(o.startsWith(a))return!0;return{audio:"http://purl.org/dc/dcmitype/Sound",image:"http://purl.org/dc/dcmitype/Image",video:"http://purl.org/dc/dcmitype/MovingImage"}[n]in i}function oe(e,t){var n=e.createElement("div"),r=n.appendChild(e.createElement("input"));r.setAttribute("type","file"),r.setAttribute("multiple","true"),r.addEventListener("change",function(e){s.Rm("File drop event: ",e),e.files?t(e.files):e.target&&e.target.files?t(e.target.files):alert("Sorry no files .. internal error?")},!1),r.style="display:none";var i=n.appendChild(B(e,g+"noun_Upload_76574_000000.svg","Upload files",function(e){r.click()}));return(0,l.DK)(i,null,t),n}te={line:{},twoLine:{"":function(e,t){var n=e.createElement("div");return n.textContent=p.P(t),n},"http://www.w3.org/2000/10/swap/pim/qif#Transaction":function(e,t){var n="",r=function(e){var r=u.M_.any(t,a.A.qu(e));return r||(n+="@@ No value for "+e+"! "),r?d.escapeForXML(r.value):"?"},i=e.createElement("table");return i.innerHTML='\n      <tr>\n      <td colspan="2"> '.concat(r("payee"),"</td>\n      < /tr>\n      < tr >\n      <td>").concat(r("date").slice(0,10),'</td>\n      <td style = "text-align: right;">').concat(r("amount"),"</td>\n      </tr>"),n&&(i.innerHTML='\n      <tr>\n        <td><a href="'.concat(d.escapeForXML(t.uri),'">').concat(d.escapeForXML(n),"</a></td>\n      </tr>")),i},"http://www.w3.org/ns/pim/trip#Trip":function(e,t){var n=function(e){var n=u.M_.any(t,e);return n?d.escapeForXML(n.value):"?"},r=e.createElement("table");return r.innerHTML='\n    <tr>\n      <td colspan="2">'.concat(n(a.A.dc("title")),'</td>\n    </tr>\n    <tr style="color: #777">\n      <td>').concat(n(a.A.cal("dtstart")),"</td>\n      <td>").concat(n(a.A.cal("dtend")),"</td>\n    </tr>"),r},widgetForClass:function(e){var t=te.twoLine[e.uri],n=u.M_;if(t)return t;var r=n.findSuperClassesNT(e);for(var i in r)if(t=te.twoLine[n.fromNT(i).uri])return t;return te.twoLine[""]}}}},3378(e,t,n){n.d(t,{LN:()=>o,Pt:()=>a,i1:()=>s});var r=n(7423),i="https://solidos.github.io/solid-ui/src",a=(e=n.hmd(e)).scriptURI?{iconBase:e.scriptURI.slice(0,e.scriptURI.lastIndexOf("/"))+"/icons/",originalIconBase:e.scriptURI.slice(0,e.scriptURI.lastIndexOf("/"))+"/originalIcons/"}:"undefined"!=typeof $SolidTestEnvironment&&$SolidTestEnvironment.iconBase?{iconBase:$SolidTestEnvironment.iconBase,originalIconBase:$SolidTestEnvironment.originalIconBase}:{iconBase:i+"/icons/",originalIconBase:i+"/originalIcons/"};(0,r.Rm)("   icons.iconBase is set to : "+a.iconBase);var o=a.iconBase,s=a.originalIconBase},3453(e,t,n){n.d(t,{A:()=>s});var r=n(6369),i=n(6986),a=n(7800),o=n(6562);function s(e,t){return(0,r.A)(e)||(0,i.A)(e,t)||(0,a.A)(e,t)||(0,o.A)()}},3468(e,t,n){n.d(t,{F:()=>o});var r=n(3291),i=n(675),a=n(4762);function o(e,t,n,o){var s=e.createElement("div"),c=o||t instanceof Error?t:null;return c?(console.error("errorMessageBlock: ".concat(c," at: ").concat(c.stack||"??"),c),s.textContent=c.message):s.textContent=t,s.appendChild((0,r.x7)(e,function(){s.parentNode&&s.parentNode.removeChild(s)})).style=i.i.errorCancelButton,s.setAttribute("style",i.i.errorMessageBlockStyle),s.style.backgroundColor=n||a.A.defaultErrorBackgroundColor,s}},3605(e,t,n){n.r(t),n.d(t,{manageParticipation:()=>b,participationObject:()=>y,recordParticipation:()=>w,renderParticipants:()=>v});var r=n(7423),i=n(4961),a=n(1795),o=n(3291),s=n(3468),c=n(1763),l=n(52),u=n(8153),d=n(675),p=n(4762),f=n(5175);function h(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return m(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var g=f.hV.store;function v(e,t,n,i,s,c){t.setAttribute("style",d.i.participantsStyle);var u=function(n){var r,i=g.any(n,a.A.wf("participant"));if(!i)return(r=e.createElement("tr")).textContent="???",r;var s=g.anyValue(n,a.A.ui("backgroundColor"))||p.A.participationDefaultBackground,l=e.createElement("div");l.setAttribute("style",d.i.participantsBlock),l.style.backgroundColor=s,r=(0,o.Cl)(e,null,i,c),t.appendChild(r);var u=e.createElement("td");return u.setAttribute("style",d.i.personTableTD),u.appendChild(l),r.insertBefore(u,r.firstChild),r},f=function(){var e=g.each(i,a.A.wf("participation")).map(function(e){return(0,r.Rm)("in participants"),[g.anyValue(e,a.A.cal("dtstart"))||"9999-12-31",e]});e.sort();var n=e.map(function(e){return e[1]});(0,l.syncTableToArray)(t,n,u)};return t.refresh=f,f(),t}function y(e,t,n){return new Promise(function(o,s){if(!n)throw new Error("No user id");var l=g.each(e,a.A.wf("participation")).filter(function(e){return g.holds(e,a.A.wf("participant"),n)});if(l.length>1){var d,p=[],f=h(l);try{for(f.s();!(d=f.n()).done;){var m=d.value,v=g.anyValue(m,a.A.cal("dtstart"));v&&p.push([v,m])}}catch(e){f.e(e)}finally{f.f()}p.sort(),r.R8("Multiple participation objects, picking earliest, in "+t),o(p[0][1])}if(l.length)o(l[0]);else{var y=(0,c.xV)(t),w=[(0,i.st)(e,a.A.wf("participation"),y,t),(0,i.st)(y,a.A.wf("participant"),n,t),(0,i.st)(y,a.A.cal("dtstart"),new Date,t),(0,i.st)(y,a.A.ui("backgroundColor"),(0,u.lightColorHash)(n),t)];g.updater.update([],w,function(e,t,n){t?o(y):s(new Error("Error recording your participation: "+n))}),o(y)}})}function w(e,t,n){var o=f.jO.currentUser();if(o){var s=g.each(e,a.A.wf("participation")).filter(function(e){return g.holds(e,a.A.wf("participant"),o)});if(s.length>1)throw new Error("Multiple records of your participation");if(s.length)return s[0];if(!g.updater.editable(t))return r.Rm("Not recording participation, as no write access as "+o+" to "+t),null;var l=(0,c.xV)(t),d=[(0,i.st)(e,a.A.wf("participation"),l,t),(0,i.st)(l,a.A.wf("participant"),o,t),(0,i.st)(l,a.A.cal("dtstart"),new Date,t),(0,i.st)(l,a.A.ui("backgroundColor"),(0,u.lightColorHash)(o),t)];return g.updater.update([],d,function(e,t,r){if(!t)throw new Error("Error recording your participation: "+r);n&&n.refresh&&n.refresh()}),l}}function b(e,t,n,r,i,a){var o=e.createElement("table");t.appendChild(o),v(e,o,0,r,0,a);try{w(r,n,o)}catch(n){t.appendChild((0,s.F)(e,"Error recording your participation: "+n))}return o}},3662(e,t,n){function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}n.d(t,{A:()=>r})},3693(e,t,n){n.d(t,{L:()=>m,r:()=>g});var r=n(467),i=n(4756),a=n.n(i),o=n(7423),s=n(675),c=n(4762),l=n(3468),u=n(5175),d=n(8702),p=n(8677);function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return h(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t){e.style.display=t?"":"none"}function g(e,t,n,r){return v.apply(this,arguments)}function v(){return v=(0,r.A)(a().mark(function e(t,n,i,h){var g,v,y,w,b,A,x,E,C,k,_,S,T,R,L,I,P,N,O,M,B,D,U,F,j,H,W,V,z,$,J,q,K,G;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(N=function(){n.currentObject?(q.value=n.currentName?n.currentName.value:"??? wot no name for "+n.currentObject,W=n.currentName,F=n.currentName?n.currentName.value:void 0,V=n.currentObject):(q.value="",F=void 0,V=void 0),i.deleteButton&&m(i.deleteButton,!!n.currentObject),i.acceptButton&&m(i.acceptButton,!1),i.editButton&&m(i.editButton,!0),i.cancelButton&&m(i.cancelButton,!1),D=!1,k()},P=function(){return P=(0,r.A)(a().mark(function e(){var n,i,c,l,u,h,m,g,v;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=function(e,t){return t.name.value>e.name.value?1:t.name.name<e.name.value?-1:0},n=function(e){var n=t.createElement("tr");s.i.setStyle(n,"autocompleteRowStyle"),n.setAttribute("style","padding: 0.3em;"),n.style.color=U?"#080":"#088",n.textContent=e.name.value;var i=(0,d.bindingToTerm)(e.subject),c=(0,d.bindingToTerm)(e.name);return n.addEventListener("click",function(){var e=(0,r.A)(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o.Rm("       click row textContent: "+n.textContent),o.Rm("       click name: "+c.value),i&&c&&y(i,c);case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),n},!D){e.next=1;break}return o.Rm('Ignoring "'.concat(q.value,'" because of lock ')),e.abrupt("return");case 1:return o.Rm('Setting lock at "'.concat(q.value,'"')),D=!0,e.next=2,(0,p.getPreferredLanguages)();case 2:if(c=e.sent,!((l=q.value.trim().toLowerCase()).length<4)){e.next=3;break}k(),j=20,e.next=6;break;case 3:if(U&&F&&l.startsWith(F)){e.next=5;break}return o.Rm('   Querying database at "'.concat(l,'" cf last "').concat(F,'".')),e.next=4,T(l,c);case 4:M=e.sent;case 5:u=L(l,M),B&&u.length<=40&&(j=u.length),U=B&&u.length<=j,o.Rm(' Filter:"'.concat(l,'" lastBindings: ').concat(M.length,", slimmed to ").concat(u.length,"; rows: ").concat(j,", Enough? ").concat(B,", All displayed? ").concat(U)),(h=u.slice(0,j)).sort(i),k(),m=f(h);try{for(m.s();!(g=m.n()).done;)v=g.value,z.appendChild(n(v))}catch(e){m.e(e)}finally{m.f()}1===u.length&&y((0,d.bindingToTerm)(u[0].subject),(0,d.bindingToTerm)(u[0].name));case 6:D=!1;case 7:case"end":return e.stop()}},e)})),P.apply(this,arguments)},I=function(){return P.apply(this,arguments)},L=function(e,t){return t.filter(function(t){return C(e,t.name.value)})},R=function(){return(R=(0,r.A)(a().mark(function e(t,r){var i,o,s;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,(0,d.queryPublicDataByName)(t,O,r||p.defaultPreferredLanguages,n.queryParams);case 1:i=e.sent,e.next=3;break;case 2:return e.prev=2,s=e.catch(0),g("Error querying db of organizations: "+s),D=!1,e.abrupt("return");case 3:return B=i.length<d.AUTOCOMPLETE_LIMIT,F=B?t:void 0,k(),o=(0,p.filterByLanguage)(i,r),e.abrupt("return",o);case 4:case"end":return e.stop()}},e,null,[[0,2]])}))).apply(this,arguments)},T=function(e,t){return R.apply(this,arguments)},S=function(){return(S=(0,r.A)(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:m(i.cancelButton,!0),I();case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)},_=function(e){return S.apply(this,arguments)},k=function(){for(;z.children.length>1;)z.removeChild(z.lastChild)},C=function(e,t){for(var n=e.split(" "),r=0;r<n.length;r++){var i=n[r];if(t.toLowerCase().indexOf(i)<0)return!1}return!0},E=function(){return(E=(0,r.A)(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o.Rm("Auto complete: Canceled by user! "),n.permanent?N():H.parentNode&&H.parentNode.removeChild(H);case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)},x=function(e){return E.apply(this,arguments)},A=function(){return(A=(0,r.A)(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:W&&q.value===W.value&&v(V,W);case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)},b=function(e){return A.apply(this,arguments)},w=function(){return(w=(0,r.A)(a().mark(function e(t,n){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!i.acceptButton){e.next=1;break}return i.acceptButton.disbaled=!1,m(i.acceptButton,!0),q.value=n.value,W=n,V=t,o.Rm("Auto complete: name: "+n),o.Rm("Auto complete: waiting for accept "+t),k(),e.abrupt("return");case 1:m(i.cancelButton,!0),v(t,n);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)},y=function(e,t){return w.apply(this,arguments)},v=function(e,t){o.Rm("Auto complete: finish! "+e),"Literal"===e.termType&&n.queryParams.objectURIBase&&(e=u.M_.sym(n.queryParams.objectURIBase.value+e.value)),k(),h(e,t)},g=function(e){var n=z.appendChild(t.createElement("tr"));o.Rm(e);var r=new Error(e);n.appendChild(l.F(t,r,"pink")),s.i.setStyle(n,"autocompleteRowStyle"),n.style.padding="1em"},O=n.targetClass){e.next=1;break}throw new Error("renderAutoComplete: missing targetClass");case 1:return i.acceptButton&&i.acceptButton.addEventListener("click",b,!1),i.cancelButton&&i.cancelButton.addEventListener("click",x,!1),B=!1,D=!1,U=!1,F=void 0,j=20,H=t.createElement("div"),W=void 0,V=void 0,(z=H.appendChild(t.createElement("table"))).setAttribute("data-testid","autocomplete-table"),z.setAttribute("style","max-width: 30em; margin: 0.5em;"),$=z.appendChild(t.createElement("tr")),s.i.setStyle($,"autocompleteRowStyle"),J=$.appendChild(t.createElement("td")),(q=J.appendChild(t.createElement("input"))).setAttribute("type","text"),N(),K=n.size||c.A.textInputSize||20,q.setAttribute("size",K),q.setAttribute("data-testid","autocomplete-input"),G=s.i.textInputStyle||"border: 0.1em solid #444; border-radius: 0.5em; width: 100%; font-size: 100%; padding: 0.1em 0.6em",q.setAttribute("style",G),q.addEventListener("keyup",function(e){13===e.keyCode&&b(e)},!1),q.addEventListener("input",_),e.abrupt("return",H);case 2:case"end":return e.stop()}},e)})),v.apply(this,arguments)}},3738(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},3893(e,t,n){function r(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n.d(t,{A:()=>r})},3907(e,t,n){n.d(t,{G2:()=>d,lO:()=>c,vb:()=>u});var r=n(467),i=n(4756),a=n.n(i),o=n(7423),s=n(5175);function c(e,t){return l.apply(this,arguments)}function l(){return(l=(0,r.A)(a().mark(function e(t,n){var r,i,c;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,s.M_.fetcher.load(t);case 1:if(r=s.M_.any(s.M_.sym(t),s.M_.sym("http://www.iana.org/assignments/link-relations/acl"))){e.next=2;break}throw new Error("Key ACL doc not found!");case 2:return e.prev=2,e.next=3,s.M_.fetcher.webOperation("PUT",r.value,{data:n,contentType:"text/turtle"});case 3:e.next=6;break;case 4:if(e.prev=4,404===(null==(c=e.catch(2))||null===(i=c.response)||void 0===i?void 0:i.status)){e.next=5;break}throw new Error(c);case 5:o.Rm("delete "+r.value+" "+c.response.status);case 6:case"end":return e.stop()}},e,null,[[2,4]])}))).apply(this,arguments)}var u=function(e){return"\n@prefix : <#>.\n@prefix acl: <http://www.w3.org/ns/auth/acl#>.\n@prefix foaf: <http://xmlns.com/foaf/0.1/>.\n@prefix key: <./>.\n\n:ReadWrite\n    a acl:Authorization;\n    acl:accessTo key:;\n    acl:default key:;\n    acl:agent <".concat(e,">;\n    acl:mode acl:Read, acl:Write.\n")},d=function(e,t){var n="acl:agentClass foaf:Agent";return null!=t&&t.length&&(n="acl:agent <".concat(t,">")),"\n@prefix foaf: <http://xmlns.com/foaf/0.1/>.\n@prefix acl: <http://www.w3.org/ns/auth/acl#>.\n<#Read>\n    a acl:Authorization;\n    ".concat(n,";\n    acl:accessTo <").concat(e.split("/").pop(),">;\n    acl:mode acl:Read.\n")}},3954(e,t,n){function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,{A:()=>r})},4101(e,t,n){n.d(t,{N:()=>c});var r=n(9394),i=n(3029),a=n(2901),o=n(4467),s=n(5561),c=function(){return(0,a.A)(function e(t){var n=t.data,r=t.itemTemplate,a=t.noData,s=t.noResults,c=t.placeholder,l=t.select,u=t.container,d=t.tagTemplate,p=t.textField,f=t.valueField;(0,i.A)(this,e),(0,o.A)(this,"_data",void 0),(0,o.A)(this,"_domElements",void 0),(0,o.A)(this,"_event",function(){}),(0,o.A)(this,"_itemTemplate",void 0),(0,o.A)(this,"_multiselect",void 0),(0,o.A)(this,"_noData",void 0),(0,o.A)(this,"_noResults",void 0),(0,o.A)(this,"_options",[]),(0,o.A)(this,"_placeholder",void 0),(0,o.A)(this,"_select",void 0),(0,o.A)(this,"_selectContainer",void 0),(0,o.A)(this,"_selectedOptions",[]),(0,o.A)(this,"_tagTemplate",void 0),(0,o.A)(this,"_textField",void 0),(0,o.A)(this,"_valueField",void 0),(0,o.A)(this,"_cross",'\n    <svg\n      width="24"\n      height="24"\n      viewBox="0 0 24 24"\n      fill="none"\n      xmlns="http://www.w3.org/2000/svg"\n    >\n      <path\n        d="M6.2253 4.81108C5.83477 4.42056 5.20161 4.42056 4.81108 4.81108C4.42056 5.20161 4.42056 5.83477 4.81108 6.2253L10.5858 12L4.81114 17.7747C4.42062 18.1652 4.42062 18.7984 4.81114 19.1889C5.20167 19.5794 5.83483 19.5794 6.22535 19.1889L12 13.4142L17.7747 19.1889C18.1652 19.5794 18.7984 19.5794 19.1889 19.1889C19.5794 18.7984 19.5794 18.1652 19.1889 17.7747L13.4142 12L19.189 6.2253C19.5795 5.83477 19.5795 5.20161 19.189 4.81108C18.7985 4.42056 18.1653 4.42056 17.7748 4.81108L12 10.5858L6.2253 4.81108Z"\n        fill="currentColor"\n      />\n    </svg>\n    '),this._data=null!=n?n:[],this._itemTemplate=null!=r?r:null,this._noData=null!=a?a:"No data found.",this._noResults=null!=s?s:"No results found.",this._placeholder=null!=c?c:"Select...",this._select=l,this._selectContainer=u,this._tagTemplate=null!=d?d:null,this._textField=null!=p?p:null,this._valueField=null!=f?f:null},[{key:"init",value:function(){if(!this._select||"SELECT"!==this._select.nodeName)throw new Error("The selector '".concat(this._select,"' did not select any valid select tag."));if(this._itemTemplate&&0===this._data.length)throw new Error("itemTemplate must be initialized with data from the component settings");if(this._tagTemplate&&0===this._data.length)throw new Error("tagTemplate must be initialized with data from the component settings");this._options=this._data.length>0?this._getDataFromSettings():this._getDataFromSelectTag(),this._renderMultiselect(),this._renderOptionsList(),this._domElements={clear:this._multiselect.querySelector(".multiselect__clear-btn"),input:this._multiselect.querySelector(".multiselect__input"),optionsContainer:this._multiselect.querySelector(".multiselect__options"),optionsContainerList:this._multiselect.querySelector(".multiselect__options > ul"),options:{list:this._multiselect.querySelectorAll(".multiselect__options > ul > li"),find:function(e){for(var t=0;t<this.list.length;t++){var n=this.list[t];if(e(n))return n}},some:function(e){for(var t=0;t<this.list.length;t++){if(e(this.list[t],t))return!0}return!1}}},this._enableEventListenners(),this._initSelectedList()}},{key:"subscribe",value:function(e){if("function"!=typeof e)throw new Error("parameter in the subscribe method is not a function");this._event=e}},{key:"_addOptionToList",value:function(e,t){var n=this,r='<span class="multiselect__selected" style="'.concat(s.i.multiselect__selected,'" data-value="').concat(e.value,'">').concat(this._tagTemplate?this._processTemplate(this._tagTemplate,t):e.text,'<span class="multiselect__remove-btn" style="').concat(s.i.multiselect__remove_btn,'">').concat(this._cross,"</span></span>");this._domElements.input.insertAdjacentHTML("beforebegin",r),this._multiselect.querySelector('span[data-value="'.concat(e.value,'"]')).lastElementChild.addEventListener("click",function(){var t=n._domElements.options.find(function(t){return t.dataset.value===e.value});n._handleOption(t)})}},{key:"_clearSelection",value:function(){for(var e=this,t=function(){var t=e._selectedOptions[n],r=e._domElements.options.find(function(e){return e.dataset.value===t.value});r.classList.remove("multiselect__options--selected"),r.setAttribute("style",s.i.multiselect__options),e._removeOptionFromList(r.dataset.value)},n=0;n<this._selectedOptions.length;n++)t();this._selectedOptions=[],this._handleClearSelectionBtn(),this._handlePlaceholder(),this._dispatchEvent({action:"CLEAR_ALL_OPTIONS",selection:this._selectedOptions})}},{key:"_closeList",value:function(){this._domElements.input.value="",this._domElements.optionsContainer.classList.remove("visible"),this._domElements.optionsContainer.setAttribute("style",s.i.multiselect__options),this._filterOptions(""),this._removeAllArrowSelected()}},{key:"_dispatchEvent",value:function(e){this._event(e)}},{key:"_enableEventListenners",value:function(){var e=this;document.addEventListener("mouseup",function(t){var n=t.target;e._multiselect.contains(n)||(e._filterOptions(""),e._closeList(),e._handlePlaceholder())}),this._domElements.clear.addEventListener("click",function(){e._clearSelection()});for(var t=0;t<this._domElements.options.list.length;t++){this._domElements.options.list[t].addEventListener("click",function(t){var n=t.target;e._handleOption(n),e._closeList()})}this._domElements.input.addEventListener("focus",function(){e._domElements.optionsContainer.classList.add("visible"),e._domElements.optionsContainer.setAttribute("style",s.i.multiselect__options_visible)}),this._domElements.input.addEventListener("input",function(t){var n=t.target.value;e._domElements.options.list.length>0&&e._filterOptions(n)}),this._domElements.input.addEventListener("keydown",function(t){e._handleArrows(t),e._handleBackspace(t),e._handleEnter(t)})}},{key:"_filterOptions",value:function(e){var t=this,n=this._domElements.optionsContainer.classList.contains("visible"),r=e.toLowerCase();if(!n&&e.length>0&&(this._domElements.optionsContainer.classList.add("visible"),this._domElements.optionsContainer.setAttribute("style",s.i.multiselect__options_visible)),this._domElements.options.list.length>0){for(var i=0;i<this._domElements.options.list.length;i++){var a=this._domElements.options.list[i];(this._itemTemplate?this._data[i][this._textField]:a.textContent).toLowerCase().substring(0,r.length)===r?this._domElements.optionsContainerList.appendChild(a):a.parentNode&&a.parentNode.removeChild(a)}var o=this._domElements.options.some(function(e,n){return(t._itemTemplate?t._data[n][t._textField]:e.textContent).toLowerCase().substring(0,r.length)===r});this._showNoResults(!o)}}},{key:"_generateId",value:function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<e;r++)t+=n.charAt(Math.floor(62*Math.random()));return t}},{key:"_getDataFromSelectTag",value:function(){for(var e=[],t=this._select.options,n=0;n<t.length;n++){var r=t[n];e.push({text:r.text,value:r.value,selected:r.hasAttribute("selected")})}return e}},{key:"_getDataFromSettings",value:function(){if(this._data.length>0&&this._valueField&&this._textField){var e="string"==typeof this._valueField,t="string"==typeof this._textField,n=[];if(!e||!t)throw new Error("textField and valueField must be of type string");for(var r=0;r<this._data.length;r++){var i=this._data[r];n.push({value:i[this._valueField],text:i[this._textField],selected:"boolean"==typeof i.selected&&i.selected})}return n}return null}},{key:"_handleArrows",value:function(e){if(40===e.keyCode||38===e.keyCode){e.preventDefault();var t=this._domElements.optionsContainer.classList.contains("visible"),n=this._multiselect.querySelector(".multiselect__options > ul");if(t){var r=this._multiselect.querySelector(".multiselect__options ul li.arrow-selected"),i={ArrowUp:"previous",Up:"previous",ArrowDown:"next",Down:"next"};if(!r)return n.firstElementChild.classList.add("arrow-selected"),n.firstElementChild.setAttribute("style",s.i.multiselect__options_ul_li_arrow_selected),void n.firstElementChild.scrollIntoView(!1);if(r.classList.remove("arrow-selected"),r.setAttribute("style",s.i.multiselect__options_ul_li),!(r=r[i[e.key]+"ElementSibling"]))return(r=n.children["next"===i[e.key]?0:n.children.length-1]).classList.add("arrow-selected"),r.setAttribute("style",s.i.multiselect__options_ul_li_arrow_selected),void this._scrollIntoView(n,r);r.classList.add("arrow-selected"),r.setAttribute("style",s.i.multiselect__options_ul_li_arrow_selected),this._scrollIntoView(n,r)}else this._domElements.optionsContainer.classList.add("visible"),this._domElements.optionsContainer.setAttribute("style",s.i.multiselect__options_visible),n.firstElementChild.classList.add("arrow-selected"),n.firstElementChild.setAttribute("style",s.i.multiselect__options_ul_li_arrow_selected),n.firstElementChild.scrollIntoView(!1)}}},{key:"_handleBackspace",value:function(e){if(8===e.keyCode&&""===e.target.value){var t=this._selectedOptions.length>0?this._selectedOptions[this._selectedOptions.length-1]:null;if(t){var n=this._multiselect.querySelector('li[data-value="'.concat(t.value,'"]'));this._handleOption(n),0===this._selectedOptions.length&&(this._domElements.optionsContainer.classList.remove("visible"),this._domElements.optionsContainer.setAttribute("style",s.i.multiselect__options))}}}},{key:"_handleClearSelectionBtn",value:function(){this._selectedOptions.length>0?this._domElements.clear.style.display="flex":this._domElements.clear.style.display="none"}},{key:"_handleEnter",value:function(e){if(13===e.keyCode){var t=this._multiselect.querySelector(".multiselect__options ul li.arrow-selected");t&&(this._handleOption(t),this._closeList())}}},{key:"_handleOption",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0;n<this._selectedOptions.length;n++){if(this._selectedOptions[n].value===e.dataset.value)return e.classList.remove("multiselect__options--selected"),e.setAttribute("style",s.i.multiselect__options),this._selectedOptions.splice(n,1),this._removeOptionFromList(e.dataset.value),this._handleClearSelectionBtn(),this._handlePlaceholder(),t&&this._dispatchEvent({action:"REMOVE_OPTION",value:e.dataset.value,selection:this._selectedOptions})}for(var i=0;i<this._options.length;i++){var a=this._options[i];if(a.value===e.dataset.value)return e.classList.add("multiselect__options--selected"),e.setAttribute("style",s.i.multiselect__options_selected),this._selectedOptions=[].concat((0,r.A)(this._selectedOptions),[a]),this._addOptionToList(a,i),this._handleClearSelectionBtn(),this._handlePlaceholder(),t&&this._dispatchEvent({action:"ADD_OPTION",value:e.dataset.value,selection:this._selectedOptions})}}},{key:"_handlePlaceholder",value:function(){this._domElements.input.placeholder=this._placeholder}},{key:"_initSelectedList",value:function(){for(var e=this,t=!1,n=function(){var n=e._options[i];if(n.selected){t=!0;var a=e._domElements.options.find(function(e){return e.dataset.value===n.value});a.classList.add("multiselect__options--selected"),a.setAttribute("style",s.i.multiselect__options_selected),e._selectedOptions=[].concat((0,r.A)(e._selectedOptions),[n]),e._addOptionToList(n,i)}},i=0;i<this._options.length;i++)n();t&&this._handleClearSelectionBtn(),this._handlePlaceholder()}},{key:"_processTemplate",value:function(e,t){for(var n=e,r=e.match(/\$\{(\w+)\}/g).map(function(e){return e.replace(/\$\{|\}/g,"")}),i=0;i<r.length;i++){var a,o=r[i];n=n.replace("${".concat(o,"}"),null!==(a=this._data[t][o])&&void 0!==a?a:"")}return n}},{key:"_removeAllArrowSelected",value:function(){var e="arrow-selected",t=this._domElements.options.find(function(t){return t.classList.contains(e)});t&&t.classList.remove(e)&&t.setAttribute("style",s.i.multiselect__options_ul_li)}},{key:"_removeOptionFromList",value:function(e){var t=this._multiselect.querySelector('span[data-value="'.concat(e,'"]'));t&&t.parentNode&&t.parentNode.removeChild(t)}},{key:"_renderOptionsList",value:function(){var e=this,t='\n        <div class="multiselect__options" style="'.concat(s.i.multiselect__options,'">\n          <ul style="').concat(s.i.multiselect__options_ul,'">\n          ').concat(this._options.length>0&&!this._itemTemplate?this._options.map(function(e){return'\n              <li data-value="'.concat(e.value,'" style="').concat(s.i.multiselect__options_ul_li,'">').concat(e.text,"</li>\n            ")}).join(""):"","\n\n          ").concat(this._options.length>0&&this._itemTemplate?this._options.map(function(t,n){return'\n              <li data-value="'.concat(t.value,'" style="').concat(s.i.multiselect__options_ul_li,'">').concat(e._processTemplate(e._itemTemplate,n),"</li>\n            ")}).join(""):"","\n          ").concat(this._showNoData(0===this._options.length),"\n          </ul>\n        </div>\n      ");this._multiselect.insertAdjacentHTML("beforeend",t)}},{key:"_renderMultiselect",value:function(){this._select.style.display="none";var e="iconic-"+this._generateId(20);this._multiselect=document.createElement("div"),this._multiselect.setAttribute("id",e),this._multiselect.setAttribute("class","multiselect__container"),this._multiselect.setAttribute("style",s.i.multiselect__container);var t='\n        <div class="multiselect__wrapper" style="'.concat(s.i.multiselect__wrapper,'">\n          <input class="multiselect__input" style="').concat(s.i.multiselect__input,'" placeholder="').concat(this._placeholder,'" />\n        </div>\n        <span style="display: none;" class="multiselect__clear-btn" style="').concat(s.i.multiselect__clear_btn,'">').concat(this._cross,"</span>\n    ");this._multiselect.innerHTML=t,this._selectContainer.appendChild(this._multiselect)}},{key:"_scrollIntoView",value:function(e,t){var n=e.getBoundingClientRect(),r=t.getBoundingClientRect();n.top<r.bottom-t.offsetHeight||(e.scrollTop=t.clientHeight+(t.offsetTop-t.offsetHeight)),n.bottom>r.top+t.offsetHeight||(e.scrollTop=t.clientHeight+(t.offsetTop-t.offsetHeight)-(e.offsetHeight-(t.offsetHeight+(t.offsetHeight-t.clientHeight))))}},{key:"_showNoData",value:function(e){return e?'<p class="multiselect__options--no-data" style="'.concat(s.i.multiselect__options_ul_p_multiselect__options_no_data,'">').concat(this._noData,"</p>"):""}},{key:"_showNoResults",value:function(e){var t=this._multiselect.querySelector(".multiselect__options--no-results");if(e){var n='<p class="multiselect__options--no-results" style="'.concat(s.i.multiselect__options_ul_p_multiselect__options_no_results,'">').concat(this._noResults,"</p>");!t&&this._domElements.optionsContainerList.insertAdjacentHTML("beforeend",n)}else t&&t.parentNode&&t.parentNode.removeChild(t)}}])}()},4158(e,t,n){n.r(t),n.d(t,{LogLevel:()=>r,alert:()=>m,clear:()=>g,debug:()=>d,dumpHTML:()=>y,error:()=>f,escapeForXML:()=>A,info:()=>p,logAscending:()=>w,logDescending:()=>b,msg:()=>l,setInternals:()=>x,setLevel:()=>v,success:()=>h,warn:()=>u});var r=function(e){return e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Message=4]="Message",e[e.Success=8]="Success",e[e.Info=16]="Info",e[e.Debug=32]="Debug",e[e.All=63]="All",e}({}),i=7,a=!1,o=document,s=window;function c(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"mesg";if(i&(arguments.length>1&&void 0!==arguments[1]?arguments[1]:4))if(void 0!==o){var n=o.getElementById("status");if(!n)return;var r=o.createElement("span");r.setAttribute("class",t);var s=new Date;r.innerHTML="".concat(s.getHours(),":").concat(s.getMinutes(),":").concat(s.getSeconds()," [").concat(t,"] ").concat(A(e),"<br/>"),a?n.insertBefore(r,n.firstChild):n.appendChild(r)}else"undefined"!=typeof console&&console.log(e)}function l(e){c(e)}function u(e){c(e,2,"warn")}function d(e){c(e,32,"dbug")}function p(e){c(e,16,"info")}function f(e){c(e,1,"eror")}function h(e){c(e,8,"good")}function m(e){s&&void 0!==s.alert?s.alert(e):u(e)}function g(){var e,t=null===(e=o)||void 0===e?void 0:e.getElementById("status");t&&(t.innerHTML="")}function v(e){i=63,d("Log level is now "+e),i=e}function y(){var e;if(o){var t=i;i=63,d((null===(e=o)||void 0===e||null===(e=e.body)||void 0===e?void 0:e.innerHTML)||""),i=t}}function w(){a=!0}function b(){a=!1}function A(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function x(e,t){s=e,o=t}},4210(e,t,n){n.d(t,{A:()=>r});const r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)}},4243(e,t,n){n.d(t,{A:()=>i});var r=n(3145);function i(e){if(Array.isArray(e))return(0,r.A)(e)}},4329(e,t,n){n.d(t,{ko:()=>T});var r=n(5429),i=n(4976),a=n(7333),o=n(8030),s=n(6316),c=n(1848);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const l={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},u={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},d=BigInt(0),p=BigInt(1),f=BigInt(2);const h=(0,o.D0)(l.p,{sqrt:function(e){const t=l.p,n=BigInt(3),r=BigInt(6),i=BigInt(11),a=BigInt(22),s=BigInt(23),c=BigInt(44),u=BigInt(88),d=e*e*e%t,p=d*d*e%t,m=(0,o.zH)(p,n,t)*p%t,g=(0,o.zH)(m,n,t)*p%t,v=(0,o.zH)(g,f,t)*d%t,y=(0,o.zH)(v,i,t)*v%t,w=(0,o.zH)(y,a,t)*y%t,b=(0,o.zH)(w,c,t)*w%t,A=(0,o.zH)(b,u,t)*b%t,x=(0,o.zH)(A,c,t)*w%t,E=(0,o.zH)(x,n,t)*p%t,C=(0,o.zH)(E,s,t)*y%t,k=(0,o.zH)(C,r,t)*d%t,_=(0,o.zH)(k,f,t);if(!h.eql(h.sqr(_),e))throw new Error("Cannot find square root");return _}}),m=(0,a.s)({...l,Fp:h,lowS:!0,endo:u},r.sc),g={};function v(e,...t){let n=g[e];if(void 0===n){const t=(0,r.sc)((0,i.AI)(e));n=(0,i.Id)(t,t),g[e]=n}return(0,r.sc)((0,i.Id)(n,...t))}const y=e=>e.toBytes(!0).slice(1),w=(()=>m.Point)(),b=e=>e%f===d;function A(e){const{Fn:t,BASE:n}=w,r=(0,s.y6)(t,e),i=n.multiply(r);return{scalar:b(i.y)?r:t.neg(r),bytes:y(i)}}function x(e){const t=h;if(!t.isValidNot0(e))throw new Error("invalid x: Fail if x â‰¥ p");const n=t.create(e*e),r=t.create(n*e+BigInt(7));let i=t.sqrt(r);b(i)||(i=t.neg(i));const a=w.fromAffine({x:e,y:i});return a.assertValidity(),a}const E=c.Ph;function C(...e){return w.Fn.create(E(v("BIP0340/challenge",...e)))}function k(e){return A(e).bytes}function _(e,t,n=(0,i.po)(32)){const{Fn:r}=w,a=(0,c.qj)("message",e),{bytes:o,scalar:s}=A(t),l=(0,c.qj)("auxRand",n,32),u=r.toBytes(s^E(v("BIP0340/aux",l))),d=v("BIP0340/nonce",u,o,a),{bytes:p,scalar:f}=A(d),h=C(p,o,a),m=new Uint8Array(64);if(m.set(p,0),m.set(r.toBytes(r.create(f+h*s)),32),!S(m,a,o))throw new Error("sign: Invalid signature produced");return m}function S(e,t,n){const{Fn:r,BASE:i}=w,a=(0,c.qj)("signature",e,64),o=(0,c.qj)("message",t),s=(0,c.qj)("publicKey",n,32);try{const e=x(E(s)),t=E(a.subarray(0,32));if(!(0,c.r4)(t,p,l.p))return!1;const n=E(a.subarray(32,64));if(!(0,c.r4)(n,p,l.n))return!1;const u=C(r.toBytes(t),y(e),o),d=i.multiplyUnsafe(n).add(e.multiplyUnsafe(r.neg(u))),{x:f,y:h}=d.toAffine();return!(d.is0()||!b(h)||f!==t)}catch(e){return!1}}const T=(()=>{const e=(e=(0,i.po)(48))=>(0,o.qy)(e,l.n);return m.utils.randomSecretKey,{keygen:function(t){const n=e(t);return{secretKey:n,publicKey:k(n)}},getPublicKey:k,sign:_,verify:S,Point:w,utils:{randomSecretKey:e,randomPrivateKey:e,taggedHash:v,lift_x:x,pointToBytes:y,numberToBytesBE:c.lq,bytesToNumberBE:c.Ph,mod:o.zi},lengths:{secretKey:32,publicKey:32,publicKeyHasPrefix:!1,signature:64,seed:48}}})()},4373(e){e.exports=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},e.exports.__esModule=!0,e.exports.default=e.exports},4467(e,t,n){n.d(t,{A:()=>i});var r=n(9922);function i(e,t,n){return(t=(0,r.A)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},4608(e,t,n){n.r(t),n.d(t,{Group:()=>r.YJ,GroupBuilder:()=>r.ZT,GroupPicker:()=>r.Kf,PeoplePicker:()=>r.OU,Person:()=>r._A,addStyleSheet:()=>a.CS,allClassURIs:()=>a.Pg,appendForm:()=>c.f6,askName:()=>a.RG,attachmentList:()=>a.sf,basicField:()=>c.PM,buildCheckboxForm:()=>c.WY,button:()=>a.x6,cancelButton:()=>a.x7,clearElement:()=>a.EW,complain:()=>a.cc,continueButton:()=>a.kz,createLinkDiv:()=>a.UH,createLinkForURI:()=>o.O,createNameDiv:()=>a.ly,defaultAnnotationStore:()=>a.Qf,deleteButtonWithCheck:()=>a.Qy,editFormButton:()=>c.Nt,errorMessageBlock:()=>s.F,extractLogURI:()=>a.er,faviconOrDefault:()=>a.PO,field:()=>c.ZZ,fieldFunction:()=>c.rg,fieldLabel:()=>c.bk,fieldParams:()=>c.tk,fieldStore:()=>c.WG,fileUploadButtonDiv:()=>a.fT,findClosest:()=>c.Ru,findImage:()=>a.F1,findImageFromURI:()=>a.ZT,formatDateTime:()=>a.r6,formsFor:()=>c.Dk,iconForClass:()=>a.p_,imagesOf:()=>a.IC,index:()=>a.Pe,isAudio:()=>a.JK,isImage:()=>a.wu,isVideo:()=>a.cZ,linkButton:()=>a.$J,linkIcon:()=>o.w,makeDescription:()=>c.eR,makeDraggable:()=>i.eB,makeDropTarget:()=>i.DK,makeSelectForCategory:()=>c.s2,makeSelectForChoice:()=>c.LX,makeSelectForClassifierOptions:()=>c.LC,makeSelectForNestedCategory:()=>c.L1,makeSelectForOptions:()=>c.iU,mostSpecificClassURI:()=>c.K,newButton:()=>c.vx,newThing:()=>c.xV,openHrefInOutlineMode:()=>a.ol,personTR:()=>a.Cl,promptForNew:()=>c.e2,propertiesForClass:()=>c.ZA,propertyTriage:()=>a.uA,publicData:()=>d,refreshTree:()=>a.uS,removeButton:()=>a.DT,renderAsDiv:()=>a.Ss,renderAsRow:()=>a.ri,renderAutoComplete:()=>u.r,renderAutocompleteControl:()=>l.A,renderNameValuePair:()=>c.Nr,selectorPanel:()=>a.Ag,selectorPanelRefresh:()=>a.RS,setImage:()=>a.g7,setName:()=>a.i,setVisible:()=>u.L,shortDate:()=>a.XV,shortTime:()=>a.Mj,sortByLabel:()=>c.eb,sortBySequence:()=>c.tE,timestamp:()=>a.vE,uploadFiles:()=>i.Zn});var r=n(5747),i=n(386),a=n(3291),o=n(9326),s=n(3468),c=n(1763),l=n(9238),u=n(3693),d=n(8702)},4633(e,t,n){var r=n(5172),i=n(6993),a=n(5869),o=n(887),s=n(1791),c=n(4373),l=n(579);function u(){var t=i(),n=t.m(u),d=(Object.getPrototypeOf?Object.getPrototypeOf(n):n.__proto__).constructor;function p(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))}var f={throw:1,return:2,break:3,continue:3};function h(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,f[e],t)},delegateYield:function(e,i,a){return t.resultName=i,n(r.d,l(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,i){r.p=t.prev,r.n=t.next;try{return e(n,i)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(e.exports=u=function(){return{wrap:function(e,n,r,i){return t.w(h(e),n,r,i&&i.reverse())},isGeneratorFunction:p,mark:t.m,awrap:function(e,t){return new r(e,t)},AsyncIterator:s,async:function(e,t,n,r,i){return(p(t)?o:a)(h(e),t,n,r,i)},keys:c,values:l}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports},4756(e,t,n){var r=n(4633)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},4762(e,t,n){n.d(t,{A:()=>r});const r={highlightColor:"#7C4DFF",formBorderColor:"#888888",formHeadingColor:"#888888",lowProfileLinkColor:"#3B5998",formFieldNameBoxWidth:"8em",mediaModuleCanvasWidth:"640",mediaModuleCanvasHeight:"480",textInputSize:20,tabBorderRadius:"0.2em",textInputBackgroundColor:"#eef",textInputBackgroundColorUneditable:"#fff",textInputColor:"#000",textInputColorPending:"#888",defaultErrorBackgroundColor:"#fee",participationDefaultBackground:"white",basicMaxLength:"4096"}},4961(t){t.exports=e},4976(e,t,n){n.d(t,{AI:()=>C,CC:()=>c,DO:()=>o,Fe:()=>a,Ht:()=>l,Id:()=>_,My:()=>m,O8:()=>d,Ow:()=>p,Vw:()=>S,ZJ:()=>k,aT:()=>E,aY:()=>i,po:()=>R,qj:()=>T,sd:()=>s,uH:()=>u});var r=n(8160);
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function i(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function a(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function o(e,...t){if(!i(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function s(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.createHasher");a(e.outputLen),a(e.blockLen)}function c(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function l(e,t){o(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function u(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function d(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function p(e,t){return e<<32-t|e>>>t}const f=(()=>"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex)(),h=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function m(e){if(o(e),f)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=h[e[n]];return t}const g=48,v=57,y=65,w=70,b=97,A=102;function x(e){return e>=g&&e<=v?e-g:e>=y&&e<=w?e-(y-10):e>=b&&e<=A?e-(b-10):void 0}function E(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);if(f)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let t=0,i=0;t<n;t++,i+=2){const n=x(e.charCodeAt(i)),a=x(e.charCodeAt(i+1));if(void 0===n||void 0===a){const t=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+i)}r[t]=16*n+a}return r}function C(e){if("string"!=typeof e)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}function k(e){return"string"==typeof e&&(e=C(e)),o(e),e}function _(...e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];o(r),t+=r.length}const n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const i=e[t];n.set(i,r),r+=i.length}return n}class S{}function T(e){const t=t=>e().update(k(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function R(e=32){if(r.E&&"function"==typeof r.E.getRandomValues)return r.E.getRandomValues(new Uint8Array(e));if(r.E&&"function"==typeof r.E.randomBytes)return Uint8Array.from(r.E.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}},5148(e,t,n){n.r(t),n.d(t,{get:()=>h,getPreferencesForClass:()=>b,recordPersonalDefaults:()=>v,recordSharedPreferences:()=>g,renderPreferencesForm:()=>y,set:()=>m,value:()=>f});var r=n(4961),i=n(5175),a=n(7423),o=n(967),s=n(1795),c=n(3605),l=n(3291),u=n(3468),d=n(1763),p=i.M_,f=[];function h(e){return f[e]}function m(e,t){if("string"!=typeof t)throw a.Rm("Non-string value of preference "+e+": "+t),new Error("Non-string value of preference "+e+": "+t);this.value[e]=t}function g(e,t){return new Promise(function(n,i){var o=p.any(e,s.A.ui("sharedPreferences"));if(o)t.sharedPreferences=o,n(t);else{p.updater.editable(e.doc())||(a.Rm(" Cant make shared preferences, may not change ".concat(e.doc)),n(t));var c=r.sym(e.doc().uri+"#SharedPreferences"),l=[r.st(e,s.A.ui("sharedPreferences"),c,e.doc())];a.Rm("Creating shared preferences "+c),p.updater.update([],l,function(e,r,a){r?(t.sharedPreferences=c,n(t)):i(new Error("Error creating shared prefs: "+a))})}})}function v(e,t){return new Promise(function(n,i){(0,o.ensureLoadedPreferences)(t).then(function(t){if(t.preferencesFile){var o,c,l=p.each(null,s.A.solid("forClass"),e,t.preferencesFile),u=[];if(l.length){if(l.forEach(function(e){o=o||p.any(e,s.A.solid("personalDefaults"))}),o)return t.personalDefaults=o,void n(t);o=d.xV(t.preferencesFile),c=l[0]}else c=d.xV(t.preferencesFile),u=[r.st(c,s.A.rdf("type"),s.A.solid("TypeRegistration"),t.preferencesFile),r.st(c,s.A.solid("forClass"),e,t.preferencesFile)];o=d.xV(t.preferencesFile),u.push(r.st(c,s.A.solid("personalDefaults"),o,t.preferencesFile)),p.updater.update([],u,function(r,a,s){a?(t.personalDefaults=o,n(t)):i(new Error("Setting preferences for "+e+": "+s))})}else a.Rm("Not doing private class preferences as no access to preferences file. "+t.preferencesFileError)},function(e){i(e)})})}function y(e,t,n,r){var i=r.dom.createElement("div");return c.participationObject(e,e.doc(),r.me).then(function(a){var o=r.dom;function s(e){i.appendChild(o.createElement("h5")).textContent=e}s("My view of this "+r.noun),d.f6(o,i,{},a,n,e.doc(),function(e,t){e||l.cc(r,t)}),s("Everyone's  view of this "+r.noun),g(e,r).then(function(r){var a=r.sharedPreferences;d.f6(o,i,{},a,n,e.doc(),function(e,t){e||l.cc(r,t)}),s("My default view of any "+r.noun),v(t,r).then(function(e){d.f6(o,i,{},e.personalDefaults,n,e.preferencesFile,function(t,n){t||l.cc(e,n)})},function(e){l.cc(r,e)})})},function(e){i.appendChild(u.F(r.dom,e))}),i}function w(e){return e.datatype?e.datatype.equals(s.A.xsd("boolean"))?"1"===e.value:e.datatype.equals(s.A.xsd("dateTime"))||e.datatype.equals(s.A.xsd("date"))?new Date(e.value):e.datatype.equals(s.A.xsd("integer"))||e.datatype.equals(s.A.xsd("float"))||e.datatype.equals(s.A.xsd("decimal"))?Number(e.value):e.value:e}function b(e,t,n,r){return new Promise(function(i,a){g(e,r).then(function(r){var o=r.sharedPreferences;if(r.me)c.participationObject(e,e.doc(),r.me).then(function(e){v(t,r).then(function(t){var r=[],a=t.personalDefaults;n.forEach(function(t){var n=p.any(e,t)||p.any(o,t)||p.any(a,t);n&&(r[t.uri]=w(n))}),i(r)},a)},a);else{var s=[];n.forEach(function(e){var t=p.any(o,e);t&&(s[e.uri]=w(t))}),i(s)}})})}},5172(e){e.exports=function(e,t){this.v=e,this.k=t},e.exports.__esModule=!0,e.exports.default=e.exports},5175(e,t,n){n.d(t,{D_:()=>pt,I0:()=>_t,ML:()=>mt,M_:()=>Rt,Oo:()=>nt,T4:()=>wt,TX:()=>it,Un:()=>ft,ac:()=>gt,fk:()=>vt,hV:()=>Ct,jO:()=>St,lG:()=>Tt,sN:()=>ht});var r=n(4961),i={386(e){const t={acl:"http://www.w3.org/ns/auth/acl#",arg:"http://www.w3.org/ns/pim/arg#",as:"https://www.w3.org/ns/activitystreams#",bookmark:"http://www.w3.org/2002/01/bookmark#",cal:"http://www.w3.org/2002/12/cal/ical#",cco:"http://www.ontologyrepository.com/CommonCoreOntologies/",cert:"http://www.w3.org/ns/auth/cert#",contact:"http://www.w3.org/2000/10/swap/pim/contact#",dc:"http://purl.org/dc/elements/1.1/",dct:"http://purl.org/dc/terms/",doap:"http://usefulinc.com/ns/doap#",foaf:"http://xmlns.com/foaf/0.1/",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",gpx:"http://www.w3.org/ns/pim/gpx#",gr:"http://purl.org/goodrelations/v1#",http:"http://www.w3.org/2007/ont/http#",httph:"http://www.w3.org/2007/ont/httph#",icalTZ:"http://www.w3.org/2002/12/cal/icaltzd#",ldp:"http://www.w3.org/ns/ldp#",link:"http://www.w3.org/2007/ont/link#",log:"http://www.w3.org/2000/10/swap/log#",meeting:"http://www.w3.org/ns/pim/meeting#",mo:"http://purl.org/ontology/mo/",org:"http://www.w3.org/ns/org#",owl:"http://www.w3.org/2002/07/owl#",pad:"http://www.w3.org/ns/pim/pad#",patch:"http://www.w3.org/ns/pim/patch#",prov:"http://www.w3.org/ns/prov#",pto:"http://www.productontology.org/id/",qu:"http://www.w3.org/2000/10/swap/pim/qif#",trip:"http://www.w3.org/ns/pim/trip#",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",rss:"http://purl.org/rss/1.0/",sched:"http://www.w3.org/ns/pim/schedule#",schema:"http://schema.org/",sioc:"http://rdfs.org/sioc/ns#",skos:"http://www.w3.org/2004/02/skos/core#",solid:"http://www.w3.org/ns/solid/terms#",space:"http://www.w3.org/ns/pim/space#",stat:"http://www.w3.org/ns/posix/stat#",tab:"http://www.w3.org/2007/ont/link#",tabont:"http://www.w3.org/2007/ont/link#",ui:"http://www.w3.org/ns/ui#",vann:"http://purl.org/vocab/vann/",vcard:"http://www.w3.org/2006/vcard/ns#",wf:"http://www.w3.org/2005/01/wf/flow#",xsd:"http://www.w3.org/2001/XMLSchema#"};e.exports=function(e={namedNode:e=>e}){const n={};for(const r in t){const i=t[r];n[r]=function(t=""){return e.namedNode(i+t)}}return n}}},a={};function o(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={exports:{}};return i[e](n,n.exports,o),n.exports}function s(...e){console.log(...e)}function c(...e){console.warn(...e)}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const l=crypto,u=e=>e instanceof CryptoKey;function d(e,t,...n){if((n=n.filter(Boolean)).length>2){const t=n.pop();e+=`one of type ${n.join(", ")}, or ${t}.`}else 2===n.length?e+=`one of type ${n[0]} or ${n[1]}.`:e+=`of type ${n[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor?.name&&(e+=` Received an instance of ${t.constructor.name}`),e}const p=(e,...t)=>d("Key must be ",e,...t);function f(e,t,...n){return d(`Key for the ${e} algorithm must be `,t,...n)}const h=new TextEncoder,m=new TextDecoder;function g(...e){const t=e.reduce((e,{length:t})=>e+t,0),n=new Uint8Array(t);let r=0;for(const t of e)n.set(t,r),r+=t.length;return n}const v=e=>(e=>{let t=e;"string"==typeof t&&(t=h.encode(t));const n=[];for(let e=0;e<t.length;e+=32768)n.push(String.fromCharCode.apply(null,t.subarray(e,e+32768)));return btoa(n.join(""))})(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),y=e=>{let t=e;t instanceof Uint8Array&&(t=m.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return(e=>{const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n})(t)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}},w=e=>!!u(e)||"KeyObject"===e?.[Symbol.toStringTag],b=["CryptoKey"],A=async e=>{if(e instanceof Uint8Array)return{kty:"oct",k:v(e)};if(!u(e))throw new TypeError(p(e,...b,"Uint8Array"));if(!e.extractable)throw new TypeError("non-extractable CryptoKey cannot be exported as a JWK");const{ext:t,key_ops:n,alg:r,use:i,...a}=await l.subtle.exportKey("jwk",e);return a};async function x(e){return A(e)}class E extends Error{constructor(e,t){super(e,t),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}E.code="ERR_JOSE_GENERIC";class C extends E{constructor(e,t,n="unspecified",r="unspecified"){super(e,{cause:{claim:n,reason:r,payload:t}}),this.code="ERR_JWT_CLAIM_VALIDATION_FAILED",this.claim=n,this.reason=r,this.payload=t}}C.code="ERR_JWT_CLAIM_VALIDATION_FAILED";class k extends E{constructor(e,t,n="unspecified",r="unspecified"){super(e,{cause:{claim:n,reason:r,payload:t}}),this.code="ERR_JWT_EXPIRED",this.claim=n,this.reason=r,this.payload=t}}k.code="ERR_JWT_EXPIRED";class _ extends E{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}}_.code="ERR_JOSE_ALG_NOT_ALLOWED";class S extends E{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}}S.code="ERR_JOSE_NOT_SUPPORTED";(class extends E{constructor(e="decryption operation failed",t){super(e,t),this.code="ERR_JWE_DECRYPTION_FAILED"}}).code="ERR_JWE_DECRYPTION_FAILED";(class extends E{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}}).code="ERR_JWE_INVALID";class T extends E{constructor(){super(...arguments),this.code="ERR_JWS_INVALID"}}T.code="ERR_JWS_INVALID";class R extends E{constructor(){super(...arguments),this.code="ERR_JWT_INVALID"}}R.code="ERR_JWT_INVALID";class L extends E{constructor(){super(...arguments),this.code="ERR_JWK_INVALID"}}L.code="ERR_JWK_INVALID";class I extends E{constructor(){super(...arguments),this.code="ERR_JWKS_INVALID"}}I.code="ERR_JWKS_INVALID";class P extends E{constructor(e="no applicable key found in the JSON Web Key Set",t){super(e,t),this.code="ERR_JWKS_NO_MATCHING_KEY"}}P.code="ERR_JWKS_NO_MATCHING_KEY";class N extends E{constructor(e="multiple matching keys found in the JSON Web Key Set",t){super(e,t),this.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS"}}Symbol.asyncIterator,N.code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";class O extends E{constructor(e="request timed out",t){super(e,t),this.code="ERR_JWKS_TIMEOUT"}}O.code="ERR_JWKS_TIMEOUT";class M extends E{constructor(e="signature verification failed",t){super(e,t),this.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED"}}function B(e,t){const n=`SHA-${e.slice(-3)}`;switch(e){case"HS256":case"HS384":case"HS512":return{hash:n,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:n,name:"RSA-PSS",saltLength:e.slice(-3)>>3};case"RS256":case"RS384":case"RS512":return{hash:n,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:n,name:"ECDSA",namedCurve:t.namedCurve};case"Ed25519":return{name:"Ed25519"};case"EdDSA":return{name:t.name};default:throw new S(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}M.code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";const D=(e,t)=>{if(e.startsWith("RS")||e.startsWith("PS")){const{modulusLength:n}=t.algorithm;if("number"!=typeof n||n<2048)throw new TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}};function U(e,t="algorithm.name"){return new TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function F(e,t){return e.name===t}function j(e){return parseInt(e.name.slice(4),10)}function H(e,t){if(t.length&&!t.some(t=>e.usages.includes(t))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){const n=t.pop();e+=`one of ${t.join(", ")}, or ${n}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw new TypeError(e)}}function W(e,t,...n){switch(t){case"HS256":case"HS384":case"HS512":{if(!F(e.algorithm,"HMAC"))throw U("HMAC");const n=parseInt(t.slice(2),10);if(j(e.algorithm.hash)!==n)throw U(`SHA-${n}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!F(e.algorithm,"RSASSA-PKCS1-v1_5"))throw U("RSASSA-PKCS1-v1_5");const n=parseInt(t.slice(2),10);if(j(e.algorithm.hash)!==n)throw U(`SHA-${n}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!F(e.algorithm,"RSA-PSS"))throw U("RSA-PSS");const n=parseInt(t.slice(2),10);if(j(e.algorithm.hash)!==n)throw U(`SHA-${n}`,"algorithm.hash");break}case"EdDSA":if("Ed25519"!==e.algorithm.name&&"Ed448"!==e.algorithm.name)throw U("Ed25519 or Ed448");break;case"Ed25519":if(!F(e.algorithm,"Ed25519"))throw U("Ed25519");break;case"ES256":case"ES384":case"ES512":{if(!F(e.algorithm,"ECDSA"))throw U("ECDSA");const n=function(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}(t);if(e.algorithm.namedCurve!==n)throw U(n,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}H(e,n)}function V(e){if("object"!=typeof(t=e)||null===t||"[object Object]"!==Object.prototype.toString.call(e))return!1;var t;if(null===Object.getPrototypeOf(e))return!0;let n=e;for(;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n}function z(e){return V(e)&&"string"==typeof e.kty}const $=async e=>{if(!e.alg)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');const{algorithm:t,keyUsages:n}=function(e){let t,n;switch(e.kty){case"RSA":switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.slice(-3)}`},n=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.slice(-3)}`},n=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.slice(-3),10)||1}`},n=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new S('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},n=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},n=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},n=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},n=e.d?["deriveBits"]:[];break;default:throw new S('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"OKP":switch(e.alg){case"Ed25519":t={name:"Ed25519"},n=e.d?["sign"]:["verify"];break;case"EdDSA":t={name:e.crv},n=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:e.crv},n=e.d?["deriveBits"]:[];break;default:throw new S('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new S('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:n}}(e),r=[t,e.ext??!1,e.key_ops??n],i={...e};return delete i.alg,delete i.use,l.subtle.importKey("jwk",i,...r)},J=e=>y(e);let q,K;const G=e=>"KeyObject"===e?.[Symbol.toStringTag],Z=async(e,t,n,r,i=!1)=>{let a=e.get(t);if(a?.[r])return a[r];const o=await $({...n,alg:r});return i&&Object.freeze(t),a?a[r]=o:e.set(t,{[r]:o}),o},Q=(e,t)=>{if(G(e)){let n=e.export({format:"jwk"});return delete n.d,delete n.dp,delete n.dq,delete n.p,delete n.q,delete n.qi,n.k?J(n.k):(K||(K=new WeakMap),Z(K,e,n,t))}if(z(e)){if(e.k)return y(e.k);K||(K=new WeakMap);return Z(K,e,e,t,!0)}return e},X=(e,t)=>{if(G(e)){let n=e.export({format:"jwk"});return n.k?J(n.k):(q||(q=new WeakMap),Z(q,e,n,t))}if(z(e)){if(e.k)return y(e.k);q||(q=new WeakMap);return Z(q,e,e,t,!0)}return e};async function Y(e,t,n){if("sign"===n&&(t=await X(t,e)),"verify"===n&&(t=await Q(t,e)),u(t))return W(t,e,n),t;if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError(p(t,...b));return l.subtle.importKey("raw",t,{hash:`SHA-${e.slice(-3)}`,name:"HMAC"},!1,[n])}throw new TypeError(p(t,...b,"Uint8Array","JSON Web Key"))}const ee=async(e,t,n)=>{const r=await Y(e,t,"sign");D(e,r);const i=await l.subtle.sign(B(e,r.algorithm),r,n);return new Uint8Array(i)},te=(...e)=>{const t=e.filter(Boolean);if(0===t.length||1===t.length)return!0;let n;for(const e of t){const t=Object.keys(e);if(n&&0!==n.size)for(const e of t){if(n.has(e))return!1;n.add(e)}else n=new Set(t)}return!0},ne=e=>e?.[Symbol.toStringTag],re=(e,t,n)=>{if(void 0!==t.use&&"sig"!==t.use)throw new TypeError("Invalid key for this operation, when present its use must be sig");if(void 0!==t.key_ops&&!0!==t.key_ops.includes?.(n))throw new TypeError(`Invalid key for this operation, when present its key_ops must include ${n}`);if(void 0!==t.alg&&t.alg!==e)throw new TypeError(`Invalid key for this operation, when present its alg must be ${e}`);return!0},ie=(e,t,n,r)=>{if(!(t instanceof Uint8Array)){if(r&&z(t)){if(function(e){return z(e)&&"oct"===e.kty&&"string"==typeof e.k}(t)&&re(e,t,n))return;throw new TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!w(t))throw new TypeError(f(e,t,...b,"Uint8Array",r?"JSON Web Key":null));if("secret"!==t.type)throw new TypeError(`${ne(t)} instances for symmetric algorithms must be of type "secret"`)}};function ae(e,t,n,r){t.startsWith("HS")||"dir"===t||t.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(t)?ie(t,n,r,e):((e,t,n,r)=>{if(r&&z(t))switch(n){case"sign":if(function(e){return"oct"!==e.kty&&"string"==typeof e.d}(t)&&re(e,t,n))return;throw new TypeError("JSON Web Key for this operation be a private JWK");case"verify":if(function(e){return"oct"!==e.kty&&void 0===e.d}(t)&&re(e,t,n))return;throw new TypeError("JSON Web Key for this operation be a public JWK")}if(!w(t))throw new TypeError(f(e,t,...b,r?"JSON Web Key":null));if("secret"===t.type)throw new TypeError(`${ne(t)} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===n&&"public"===t.type)throw new TypeError(`${ne(t)} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===n&&"public"===t.type)throw new TypeError(`${ne(t)} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===n&&"private"===t.type)throw new TypeError(`${ne(t)} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===n&&"private"===t.type)throw new TypeError(`${ne(t)} instances for asymmetric algorithm encryption must be of type "public"`)})(t,n,r,e)}ae.bind(void 0,!1);const oe=ae.bind(void 0,!0);const se=function(e,t,n,r,i){if(void 0!==i.crit&&void 0===r?.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!r||void 0===r.crit)return new Set;if(!Array.isArray(r.crit)||0===r.crit.length||r.crit.some(e=>"string"!=typeof e||0===e.length))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let a;a=void 0!==n?new Map([...Object.entries(n),...t.entries()]):t;for(const t of r.crit){if(!a.has(t))throw new S(`Extension Header Parameter "${t}" is not recognized`);if(void 0===i[t])throw new e(`Extension Header Parameter "${t}" is missing`);if(a.get(t)&&void 0===r[t])throw new e(`Extension Header Parameter "${t}" MUST be integrity protected`)}return new Set(r.crit)};class ce{constructor(e){if(!(e instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this._payload=e}setProtectedHeader(e){if(this._protectedHeader)throw new TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw new TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}async sign(e,t){if(!this._protectedHeader&&!this._unprotectedHeader)throw new T("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!te(this._protectedHeader,this._unprotectedHeader))throw new T("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const n={...this._protectedHeader,...this._unprotectedHeader};let r=!0;if(se(T,new Map([["b64",!0]]),t?.crit,this._protectedHeader,n).has("b64")&&(r=this._protectedHeader.b64,"boolean"!=typeof r))throw new T('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:i}=n;if("string"!=typeof i||!i)throw new T('JWS "alg" (Algorithm) Header Parameter missing or invalid');oe(i,e,"sign");let a,o=this._payload;r&&(o=h.encode(v(o))),a=this._protectedHeader?h.encode(v(JSON.stringify(this._protectedHeader))):h.encode("");const s=g(a,h.encode("."),o),c=await ee(i,e,s),l={signature:v(c),payload:""};return r&&(l.payload=m.decode(o)),this._unprotectedHeader&&(l.header=this._unprotectedHeader),this._protectedHeader&&(l.protected=m.decode(a)),l}}class le{constructor(e){this._flattened=new ce(e)}setProtectedHeader(e){return this._flattened.setProtectedHeader(e),this}async sign(e,t){const n=await this._flattened.sign(e,t);if(void 0===n.payload)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${n.protected}.${n.payload}.${n.signature}`}}const ue=e=>Math.floor(e.getTime()/1e3),de=86400,pe=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i,fe=e=>{const t=pe.exec(e);if(!t||t[4]&&t[1])throw new TypeError("Invalid time period format");const n=parseFloat(t[2]);let r;switch(t[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":r=Math.round(n);break;case"minute":case"minutes":case"min":case"mins":case"m":r=Math.round(60*n);break;case"hour":case"hours":case"hr":case"hrs":case"h":r=Math.round(3600*n);break;case"day":case"days":case"d":r=Math.round(n*de);break;case"week":case"weeks":case"w":r=Math.round(604800*n);break;default:r=Math.round(31557600*n)}return"-"===t[1]||"ago"===t[4]?-r:r};function he(e,t){if(!Number.isFinite(t))throw new TypeError(`Invalid ${e} input`);return t}class me{constructor(e={}){if(!V(e))throw new TypeError("JWT Claims Set MUST be an object");this._payload=e}setIssuer(e){return this._payload={...this._payload,iss:e},this}setSubject(e){return this._payload={...this._payload,sub:e},this}setAudience(e){return this._payload={...this._payload,aud:e},this}setJti(e){return this._payload={...this._payload,jti:e},this}setNotBefore(e){return"number"==typeof e?this._payload={...this._payload,nbf:he("setNotBefore",e)}:e instanceof Date?this._payload={...this._payload,nbf:he("setNotBefore",ue(e))}:this._payload={...this._payload,nbf:ue(new Date)+fe(e)},this}setExpirationTime(e){return"number"==typeof e?this._payload={...this._payload,exp:he("setExpirationTime",e)}:e instanceof Date?this._payload={...this._payload,exp:he("setExpirationTime",ue(e))}:this._payload={...this._payload,exp:ue(new Date)+fe(e)},this}setIssuedAt(e){return void 0===e?this._payload={...this._payload,iat:ue(new Date)}:e instanceof Date?this._payload={...this._payload,iat:he("setIssuedAt",ue(e))}:this._payload="string"==typeof e?{...this._payload,iat:he("setIssuedAt",ue(new Date)+fe(e))}:{...this._payload,iat:he("setIssuedAt",e)},this}}class ge extends me{setProtectedHeader(e){return this._protectedHeader=e,this}async sign(e,t){const n=new le(h.encode(JSON.stringify(this._payload)));if(n.setProtectedHeader(this._protectedHeader),Array.isArray(this._protectedHeader?.crit)&&this._protectedHeader.crit.includes("b64")&&!1===this._protectedHeader.b64)throw new R("JWTs MUST NOT use unencoded payload");return n.sign(e,t)}}const ve=async(e,t,n)=>{let r,i,a=!1;"function"==typeof AbortController&&(r=new AbortController,i=setTimeout(()=>{a=!0,r.abort()},t));const o=await fetch(e.href,{signal:r?r.signal:void 0,redirect:"manual",headers:n.headers}).catch(e=>{if(a)throw new O;throw e});if(void 0!==i&&clearTimeout(i),200!==o.status)throw new E("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await o.json()}catch{throw new E("Failed to parse the JSON Web Key Set HTTP response as JSON")}};async function ye(e,t){if(!V(e))throw new TypeError("JWK must be an object");switch(t||(t=e.alg),e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw new TypeError('missing "k" (Key Value) Parameter value');return y(e.k);case"RSA":if("oth"in e&&void 0!==e.oth)throw new S('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return $({...e,alg:t});default:throw new S('Unsupported "kty" (Key Type) Parameter value')}}function we(e){return V(e)}function be(e){return"function"==typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e))}class Ae{constructor(e){if(this._cached=new WeakMap,!function(e){return e&&"object"==typeof e&&Array.isArray(e.keys)&&e.keys.every(we)}(e))throw new I("JSON Web Key Set malformed");this._jwks=be(e)}async getKey(e,t){const{alg:n,kid:r}={...e,...t?.header},i=function(e){switch("string"==typeof e&&e.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";default:throw new S('Unsupported "alg" value for a JSON Web Key Set')}}(n),a=this._jwks.keys.filter(e=>{let t=i===e.kty;if(t&&"string"==typeof r&&(t=r===e.kid),t&&"string"==typeof e.alg&&(t=n===e.alg),t&&"string"==typeof e.use&&(t="sig"===e.use),t&&Array.isArray(e.key_ops)&&(t=e.key_ops.includes("verify")),t)switch(n){case"ES256":t="P-256"===e.crv;break;case"ES256K":t="secp256k1"===e.crv;break;case"ES384":t="P-384"===e.crv;break;case"ES512":t="P-521"===e.crv;break;case"Ed25519":t="Ed25519"===e.crv;break;case"EdDSA":t="Ed25519"===e.crv||"Ed448"===e.crv}return t}),{0:o,length:s}=a;if(0===s)throw new P;if(1!==s){const e=new N,{_cached:t}=this;throw e[Symbol.asyncIterator]=async function*(){for(const e of a)try{yield await xe(t,e,n)}catch{}},e}return xe(this._cached,o,n)}}async function xe(e,t,n){const r=e.get(t)||e.set(t,{}).get(t);if(void 0===r[n]){const e=await ye({...t,ext:!0},n);if(e instanceof Uint8Array||"public"!==e.type)throw new I("JSON Web Key Set members must be public keys");r[n]=e}return r[n]}function Ee(e){const t=new Ae(e),n=async(e,n)=>t.getKey(e,n);return Object.defineProperties(n,{jwks:{value:()=>be(t._jwks),enumerable:!0,configurable:!1,writable:!1}}),n}let Ce;if("undefined"==typeof navigator||!navigator.userAgent?.startsWith?.("Mozilla/5.0 ")){Ce=`${"jose"}/${"v5.10.0"}`}const ke=Symbol();class _e{constructor(e,t){if(!(e instanceof URL))throw new TypeError("url must be an instance of URL");var n,r;this._url=new URL(e.href),this._options={agent:t?.agent,headers:t?.headers},this._timeoutDuration="number"==typeof t?.timeoutDuration?t?.timeoutDuration:5e3,this._cooldownDuration="number"==typeof t?.cooldownDuration?t?.cooldownDuration:3e4,this._cacheMaxAge="number"==typeof t?.cacheMaxAge?t?.cacheMaxAge:6e5,void 0!==t?.[ke]&&(this._cache=t?.[ke],n=t?.[ke],r=this._cacheMaxAge,"object"==typeof n&&null!==n&&"uat"in n&&"number"==typeof n.uat&&!(Date.now()-n.uat>=r)&&"jwks"in n&&V(n.jwks)&&Array.isArray(n.jwks.keys)&&Array.prototype.every.call(n.jwks.keys,V)&&(this._jwksTimestamp=this._cache.uat,this._local=Ee(this._cache.jwks)))}coolingDown(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cooldownDuration}fresh(){return"number"==typeof this._jwksTimestamp&&Date.now()<this._jwksTimestamp+this._cacheMaxAge}async getKey(e,t){this._local&&this.fresh()||await this.reload();try{return await this._local(e,t)}catch(n){if(n instanceof P&&!1===this.coolingDown())return await this.reload(),this._local(e,t);throw n}}async reload(){this._pendingFetch&&("undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime)&&(this._pendingFetch=void 0);const e=new Headers(this._options.headers);Ce&&!e.has("User-Agent")&&(e.set("User-Agent",Ce),this._options.headers=Object.fromEntries(e.entries())),this._pendingFetch||(this._pendingFetch=ve(this._url,this._timeoutDuration,this._options).then(e=>{this._local=Ee(e),this._cache&&(this._cache.uat=Date.now(),this._cache.jwks=e),this._jwksTimestamp=Date.now(),this._pendingFetch=void 0}).catch(e=>{throw this._pendingFetch=void 0,e})),await this._pendingFetch}}const Se=async(e,t,n,r)=>{const i=await Y(e,t,"verify");D(e,i);const a=B(e,i.algorithm);try{return await l.subtle.verify(a,i,n,r)}catch{return!1}},Te=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw new TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)};async function Re(e,t,n){if(e instanceof Uint8Array&&(e=m.decode(e)),"string"!=typeof e)throw new T("Compact JWS must be a string or Uint8Array");const{0:r,1:i,2:a,length:o}=e.split(".");if(3!==o)throw new T("Invalid Compact JWS");const s=await async function(e,t,n){if(!V(e))throw new T("Flattened JWS must be an object");if(void 0===e.protected&&void 0===e.header)throw new T('Flattened JWS must have either of the "protected" or "header" members');if(void 0!==e.protected&&"string"!=typeof e.protected)throw new T("JWS Protected Header incorrect type");if(void 0===e.payload)throw new T("JWS Payload missing");if("string"!=typeof e.signature)throw new T("JWS Signature missing or incorrect type");if(void 0!==e.header&&!V(e.header))throw new T("JWS Unprotected Header incorrect type");let r={};if(e.protected)try{const t=y(e.protected);r=JSON.parse(m.decode(t))}catch{throw new T("JWS Protected Header is invalid")}if(!te(r,e.header))throw new T("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const i={...r,...e.header};let a=!0;if(se(T,new Map([["b64",!0]]),n?.crit,r,i).has("b64")&&(a=r.b64,"boolean"!=typeof a))throw new T('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:o}=i;if("string"!=typeof o||!o)throw new T('JWS "alg" (Algorithm) Header Parameter missing or invalid');const s=n&&Te("algorithms",n.algorithms);if(s&&!s.has(o))throw new _('"alg" (Algorithm) Header Parameter value not allowed');if(a){if("string"!=typeof e.payload)throw new T("JWS Payload must be a string")}else if("string"!=typeof e.payload&&!(e.payload instanceof Uint8Array))throw new T("JWS Payload must be a string or an Uint8Array instance");let c=!1;"function"==typeof t?(t=await t(r,e),c=!0,oe(o,t,"verify"),z(t)&&(t=await ye(t,o))):oe(o,t,"verify");const l=g(h.encode(e.protected??""),h.encode("."),"string"==typeof e.payload?h.encode(e.payload):e.payload);let u,d;try{u=y(e.signature)}catch{throw new T("Failed to base64url decode the signature")}if(!await Se(o,t,u,l))throw new M;if(a)try{d=y(e.payload)}catch{throw new T("Failed to base64url decode the payload")}else d="string"==typeof e.payload?h.encode(e.payload):e.payload;const p={payload:d};return void 0!==e.protected&&(p.protectedHeader=r),void 0!==e.header&&(p.unprotectedHeader=e.header),c?{...p,key:t}:p}({payload:i,protected:r,signature:a},t,n),c={payload:s.payload,protectedHeader:s.protectedHeader};return"function"==typeof t?{...c,key:s.key}:c}const Le=e=>e.toLowerCase().replace(/^application\//,""),Ie=(e,t,n={})=>{let r;try{r=JSON.parse(m.decode(t))}catch{}if(!V(r))throw new R("JWT Claims Set must be a top-level JSON object");const{typ:i}=n;if(i&&("string"!=typeof e.typ||Le(e.typ)!==Le(i)))throw new C('unexpected "typ" JWT header value',r,"typ","check_failed");const{requiredClaims:a=[],issuer:o,subject:s,audience:c,maxTokenAge:l}=n,u=[...a];void 0!==l&&u.push("iat"),void 0!==c&&u.push("aud"),void 0!==s&&u.push("sub"),void 0!==o&&u.push("iss");for(const e of new Set(u.reverse()))if(!(e in r))throw new C(`missing required "${e}" claim`,r,e,"missing");if(o&&!(Array.isArray(o)?o:[o]).includes(r.iss))throw new C('unexpected "iss" claim value',r,"iss","check_failed");if(s&&r.sub!==s)throw new C('unexpected "sub" claim value',r,"sub","check_failed");if(c&&(d=r.aud,p="string"==typeof c?[c]:c,!("string"==typeof d?p.includes(d):Array.isArray(d)&&p.some(Set.prototype.has.bind(new Set(d))))))throw new C('unexpected "aud" claim value',r,"aud","check_failed");var d,p;let f;switch(typeof n.clockTolerance){case"string":f=fe(n.clockTolerance);break;case"number":f=n.clockTolerance;break;case"undefined":f=0;break;default:throw new TypeError("Invalid clockTolerance option type")}const{currentDate:h}=n,g=ue(h||new Date);if((void 0!==r.iat||l)&&"number"!=typeof r.iat)throw new C('"iat" claim must be a number',r,"iat","invalid");if(void 0!==r.nbf){if("number"!=typeof r.nbf)throw new C('"nbf" claim must be a number',r,"nbf","invalid");if(r.nbf>g+f)throw new C('"nbf" claim timestamp check failed',r,"nbf","check_failed")}if(void 0!==r.exp){if("number"!=typeof r.exp)throw new C('"exp" claim must be a number',r,"exp","invalid");if(r.exp<=g-f)throw new k('"exp" claim timestamp check failed',r,"exp","check_failed")}if(l){const e=g-r.iat;if(e-f>("number"==typeof l?l:fe(l)))throw new k('"iat" claim timestamp check failed (too far in the past)',r,"iat","check_failed");if(e<0-f)throw new C('"iat" claim timestamp check failed (it should be in the past)',r,"iat","check_failed")}return r};const Pe=async(e,t)=>{const n=`SHA-${e.slice(-3)}`;return new Uint8Array(await l.subtle.digest(n,t))},Ne=(e,t)=>{if("string"!=typeof e||!e)throw new L(`${t} missing or invalid`)};async function Oe(e,t){if(!V(e))throw new TypeError("JWK must be an object");if(t??(t="sha256"),"sha256"!==t&&"sha384"!==t&&"sha512"!==t)throw new TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');let n;switch(e.kty){case"EC":Ne(e.crv,'"crv" (Curve) Parameter'),Ne(e.x,'"x" (X Coordinate) Parameter'),Ne(e.y,'"y" (Y Coordinate) Parameter'),n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};break;case"OKP":Ne(e.crv,'"crv" (Subtype of Key Pair) Parameter'),Ne(e.x,'"x" (Public Key) Parameter'),n={crv:e.crv,kty:e.kty,x:e.x};break;case"RSA":Ne(e.e,'"e" (Exponent) Parameter'),Ne(e.n,'"n" (Modulus) Parameter'),n={e:e.e,kty:e.kty,n:e.n};break;case"oct":Ne(e.k,'"k" (Key Value) Parameter'),n={k:e.k,kty:e.kty};break;default:throw new S('"kty" (Key Type) Parameter missing or unsupported')}const r=h.encode(JSON.stringify(n));return v(await Pe(t,r))}function Me(e){const t=e?.modulusLength??2048;if("number"!=typeof t||t<2048)throw new S("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return t}async function Be(e,t){return async function(e,t){let n,r;switch(e){case"PS256":case"PS384":case"PS512":n={name:"RSA-PSS",hash:`SHA-${e.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:Me(t)},r=["sign","verify"];break;case"RS256":case"RS384":case"RS512":n={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:Me(t)},r=["sign","verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":n={name:"RSA-OAEP",hash:`SHA-${parseInt(e.slice(-3),10)||1}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:Me(t)},r=["decrypt","unwrapKey","encrypt","wrapKey"];break;case"ES256":n={name:"ECDSA",namedCurve:"P-256"},r=["sign","verify"];break;case"ES384":n={name:"ECDSA",namedCurve:"P-384"},r=["sign","verify"];break;case"ES512":n={name:"ECDSA",namedCurve:"P-521"},r=["sign","verify"];break;case"Ed25519":n={name:"Ed25519"},r=["sign","verify"];break;case"EdDSA":{r=["sign","verify"];const e=t?.crv??"Ed25519";switch(e){case"Ed25519":case"Ed448":n={name:e};break;default:throw new S("Invalid or unsupported crv option provided")}break}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{r=["deriveKey","deriveBits"];const e=t?.crv??"P-256";switch(e){case"P-256":case"P-384":case"P-521":n={name:"ECDH",namedCurve:e};break;case"X25519":case"X448":n={name:e};break;default:throw new S("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}break}default:throw new S('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return l.subtle.generateKey(n,t?.extractable??!1,r)}(e,t)}const De=y;
/**
 * solid-oidc.js - Minimal Solid-OIDC client for browsers
 *
 * A zero-build, single-file Solid-OIDC authentication library.
 *
 * @license MIT
 * @author JavaScriptSolidServer
 * @see https://github.com/JavaScriptSolidServer/solid-oidc
 *
 * Based on solid-oidc-client-browser by uvdsl (Christoph Braun)
 * @see https://github.com/uvdsl/solid-oidc-client-browser
 *
 * Implements:
 * - RFC 6749 - OAuth 2.0
 * - RFC 7636 - PKCE
 * - RFC 9207 - OAuth 2.0 Authorization Server Issuer Identification
 * - RFC 9449 - DPoP (Demonstration of Proof-of-Possession)
 * - Solid-OIDC Specification
 */
const Ue="sessionStateChange",Fe="sessionExpirationWarning",je="sessionExpiration";class He{constructor(e="solid-oidc",t="session",n=1){this.dbName=e,this.storeName=t,this.dbVersion=n,this.db=null}async init(){return new Promise((e,t)=>{const n=indexedDB.open(this.dbName,this.dbVersion);n.onerror=()=>t(new Error(`Database error: ${n.error}`)),n.onsuccess=()=>{this.db=n.result,e(this)},n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(this.storeName)||t.createObjectStore(this.storeName)}})}async setItem(e,t){return this.db||await this.init(),new Promise((n,r)=>{const i=this.db.transaction(this.storeName,"readwrite");i.oncomplete=()=>n(),i.onerror=()=>r(new Error(`Transaction error: ${i.error}`)),i.objectStore(this.storeName).put(t,e)})}async getItem(e){return this.db||await this.init(),new Promise((t,n)=>{const r=this.db.transaction(this.storeName,"readonly");r.onerror=()=>n(new Error(`Transaction error: ${r.error}`));const i=r.objectStore(this.storeName).get(e);i.onsuccess=()=>t(i.result||null)})}async deleteItem(e){return this.db||await this.init(),new Promise((t,n)=>{const r=this.db.transaction(this.storeName,"readwrite");r.oncomplete=()=>t(),r.onerror=()=>n(new Error(`Transaction error: ${r.error}`)),r.objectStore(this.storeName).delete(e)})}async clear(){return this.db||await this.init(),new Promise((e,t)=>{const n=this.db.transaction(this.storeName,"readwrite");n.oncomplete=()=>e(),n.onerror=()=>t(new Error(`Transaction error: ${n.error}`)),n.objectStore(this.storeName).clear()})}close(){this.db&&(this.db.close(),this.db=null)}}async function We(e,t,n,r=null){const i=await x(e.publicKey),a={htu:t,htm:n};return r&&(a.ath=r),new ge(a).setIssuedAt().setJti(crypto.randomUUID()).setProtectedHeader({alg:"ES256",typ:"dpop+jwt",jwk:i}).sign(e.privateKey)}async function Ve(e,t,n){const r=await We(n,e,"POST"),i=await fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",DPoP:r},body:new URLSearchParams(t)});if(!i.ok)throw new Error(`Token request failed: ${i.status}`);return i.json()}async function ze(e,t,n,r,i){const a=function(e,t){const n=new _e(e,t),r=async(e,t)=>n.getKey(e,t);return Object.defineProperties(r,{coolingDown:{get:()=>n.coolingDown(),enumerable:!0,configurable:!1},fresh:{get:()=>n.fresh(),enumerable:!0,configurable:!1},reload:{value:()=>n.reload(),enumerable:!0,configurable:!1,writable:!1},reloading:{get:()=>!!n._pendingFetch,enumerable:!0,configurable:!1},jwks:{value:()=>n._local?.jwks(),enumerable:!0,configurable:!1,writable:!1}}),r}(new URL(t)),{payload:o}=await async function(e,t,n){const r=await Re(e,t,n);if(r.protectedHeader.crit?.includes("b64")&&!1===r.protectedHeader.b64)throw new R("JWTs MUST NOT use unencoded payload");const i={payload:Ie(r.protectedHeader,r.payload,n),protectedHeader:r.protectedHeader};return"function"==typeof t?{...i,key:r.key}:i}(e,a,{issuer:n,audience:"solid"}),s=await Oe(await x(i.publicKey));if(o.cnf?.jkt!==s)throw new Error("DPoP thumbprint mismatch");if(o.client_id!==r)throw new Error("client_id mismatch");return o}class $e extends EventTarget{constructor(e={}){super(),this.clientId=e.clientId||null,this.database=e.database||new He,this.onStateChange=e.onStateChange||null,this.onExpirationWarning=e.onExpirationWarning||null,this.onExpiration=e.onExpiration||null,this._isActive=!1,this._webId=null,this._exp=null,this._ath=null,this._tokens=null,this._idpDetails=null,this._refreshPromise=null,this.onStateChange&&this.addEventListener(Ue,this.onStateChange),this.onExpirationWarning&&this.addEventListener(Fe,this.onExpirationWarning),this.onExpiration&&this.addEventListener(je,this.onExpiration)}get isActive(){return this._isActive}get webId(){return this._webId}isExpired(){return!this._exp||Math.floor(Date.now()/1e3)>=this._exp}getExpiresIn(){return this._exp?this._exp-Math.floor(Date.now()/1e3):-1}async login(e,t){const n=new URL(t),r=n.origin+n.pathname+n.search,i=await async function(e){const t=new URL(e).origin,n=await fetch(`${t}/.well-known/openid-configuration`);if(!n.ok)throw new Error(`OIDC discovery failed: ${n.status}`);return n.json()}(e),a=i.issuer,o=e=>e.endsWith("/")?e.slice(0,-1):e;if(o(e)!==o(a))throw new Error(`Issuer mismatch: ${a} !== ${e}`);sessionStorage.setItem("solid_oidc_idp",a),sessionStorage.setItem("solid_oidc_token_endpoint",i.token_endpoint),sessionStorage.setItem("solid_oidc_jwks_uri",i.jwks_uri);let s=this.clientId;if(!s){s=(await async function(e,t){const n=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({application_type:"web",redirect_uris:t,token_endpoint_auth_method:"none",grant_types:["authorization_code","refresh_token"],response_types:["code"],scope:"openid offline_access webid"})});if(!n.ok)throw new Error(`Client registration failed: ${n.status}`);return n.json()}(i.registration_endpoint,[r])).client_id,sessionStorage.setItem("solid_oidc_client_id",s)}const c=await async function(){const e=crypto.randomUUID()+"-"+crypto.randomUUID(),t=new Uint8Array(await crypto.subtle.digest("SHA-256",(new TextEncoder).encode(e)));return{verifier:e,challenge:btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}}();sessionStorage.setItem("solid_oidc_pkce_verifier",c.verifier);const l=crypto.randomUUID();sessionStorage.setItem("solid_oidc_csrf",l);const u=new URL(i.authorization_endpoint);u.searchParams.set("response_type","code"),u.searchParams.set("redirect_uri",r),u.searchParams.set("scope","openid offline_access webid"),u.searchParams.set("client_id",s),u.searchParams.set("code_challenge_method","S256"),u.searchParams.set("code_challenge",c.challenge),u.searchParams.set("state",l),u.searchParams.set("prompt","consent"),window.location.href=u.toString()}async handleRedirectFromLogin(){const e=new URL(window.location.href),t=e.searchParams.get("code");if(!t)return;const n=sessionStorage.getItem("solid_oidc_idp"),r=e.searchParams.get("iss");if(!n||r!==n)throw new Error(`Issuer mismatch: ${r} !== ${n}`);const i=sessionStorage.getItem("solid_oidc_csrf");if(e.searchParams.get("state")!==i)throw new Error("CSRF token mismatch");e.searchParams.delete("code"),e.searchParams.delete("iss"),e.searchParams.delete("state"),window.history.replaceState({},document.title,e.toString());const a=sessionStorage.getItem("solid_oidc_pkce_verifier"),o=sessionStorage.getItem("solid_oidc_token_endpoint"),s=sessionStorage.getItem("solid_oidc_jwks_uri"),c=this.clientId||sessionStorage.getItem("solid_oidc_client_id");if(!a||!o||!c)throw new Error("Missing session data");const l=await Be("ES256"),u=await Ve(o,{grant_type:"authorization_code",code:t,code_verifier:a,redirect_uri:e.origin+e.pathname,client_id:c},l);await ze(u.access_token,s,n,c,l),this._idpDetails={idp:n,jwksUri:s,tokenEndpoint:o},await this.database.init(),await Promise.all([this.database.setItem("idp",n),this.database.setItem("jwks_uri",s),this.database.setItem("token_endpoint",o),this.database.setItem("client_id",c),this.database.setItem("dpop_keypair",l),this.database.setItem("refresh_token",u.refresh_token)]),this.database.close(),sessionStorage.removeItem("solid_oidc_idp"),sessionStorage.removeItem("solid_oidc_token_endpoint"),sessionStorage.removeItem("solid_oidc_jwks_uri"),sessionStorage.removeItem("solid_oidc_client_id"),sessionStorage.removeItem("solid_oidc_pkce_verifier"),sessionStorage.removeItem("solid_oidc_csrf"),await this._setTokens({...u,dpop_key_pair:l}),this._dispatchStateChange()}async restore(){return this._refreshPromise||(this._refreshPromise=(async()=>{try{const e=await async function(e){await e.init();const[t,n,r,i]=await Promise.all([e.getItem("refresh_token"),e.getItem("token_endpoint"),e.getItem("client_id"),e.getItem("dpop_keypair")]);if(!(t&&n&&r&&i))throw new Error("Missing refresh data");const a=await Ve(n,{grant_type:"refresh_token",refresh_token:t,client_id:r},i);return a.refresh_token&&await e.setItem("refresh_token",a.refresh_token),e.close(),{...a,dpop_key_pair:i}}(this.database);await this._setTokens(e),this._dispatchStateChange()}catch(e){throw this._isActive&&(this.isExpired()?this._dispatchExpiration():this._dispatchExpirationWarning()),e}finally{this._refreshPromise=null}})()),this._refreshPromise}async logout(){this._isActive=!1,this._webId=null,this._exp=null,this._ath=null,this._tokens=null,this._idpDetails=null,await this.database.init(),await this.database.clear(),this.database.close(),this._dispatchStateChange()}async authFetch(e,t={}){if(!this._isActive)return fetch(e,t);let n,r,i;this.isExpired()&&await this.restore(),e instanceof Request?(n=new URL(e.url),r=t.method||e.method||"GET",i=new Headers(e.headers)):(n=new URL(e.toString()),r=t.method||"GET",i=t.headers?new Headers(t.headers):new Headers);const a=await We(this._tokens.dpop_key_pair,`${n.origin}${n.pathname}`,r.toUpperCase(),this._ath);return i.set("DPoP",a),i.set("Authorization",`DPoP ${this._tokens.access_token}`),e instanceof Request?fetch(new Request(e,{...t,headers:i})):fetch(n,{...t,headers:i})}async _setTokens(e){this._tokens=e;const t=function(e){if("string"!=typeof e)throw new R("JWTs must use Compact JWS serialization, JWT must be a string");const{1:t,length:n}=e.split(".");if(5===n)throw new R("Only JWTs using Compact JWS serialization can be decoded");if(3!==n)throw new R("Invalid JWT");if(!t)throw new R("JWTs must contain a payload");let r,i;try{r=De(t)}catch{throw new R("Failed to base64url decode the payload")}try{i=JSON.parse(m.decode(r))}catch{throw new R("Failed to parse the decoded payload as JSON")}if(!V(i))throw new R("Invalid JWT Claims Set");return i}(e.access_token);if(!t.webid)throw new Error("Missing webid claim");if(!t.exp)throw new Error("Missing exp claim");this._ath=await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t),r=Array.from(new Uint8Array(n));return btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}(e.access_token),this._webId=t.webid,this._exp=t.exp,this._isActive=!0}_dispatchStateChange(){this.dispatchEvent(new CustomEvent(Ue,{detail:{isActive:this._isActive,webId:this._webId}}))}_dispatchExpirationWarning(){this.dispatchEvent(new CustomEvent(Fe,{detail:{expires_in:this.getExpiresIn()}}))}_dispatchExpiration(){this.dispatchEvent(new CustomEvent(je))}}const Je="sessionRestore",qe="login",Ke="logout",Ge="sessionExpired",Ze="error";class Qe{constructor(){this.listeners=new Map}on(e,t){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t)}off(e,t){var n;null===(n=this.listeners.get(e))||void 0===n||n.delete(t)}emit(e,...t){var n;null===(n=this.listeners.get(e))||void 0===n||n.forEach(e=>e(...t))}}const Xe=new class{constructor(e){this._session=new $e({clientId:null==e?void 0:e.clientId,database:new He,onStateChange:e=>{const t=e.detail;(null==t?void 0:t.isActive)?(this._events.emit(qe),this._events.emit(Je,window.location.href)):this._events.emit(Ke)},onExpiration:()=>{this._events.emit(Ge)}}),this._events=new Qe,this._sessionId=crypto.randomUUID()}get events(){return this._events}get info(){var e;return{isLoggedIn:this._session.isActive,webId:null!==(e=this._session.webId)&&void 0!==e?e:void 0,sessionId:this._sessionId,expirationDate:this._session.isActive?Date.now()+1e3*this._session.getExpiresIn():void 0}}async handleIncomingRedirect(e){const t="string"==typeof e?{url:e}:null!=e?e:{};try{if(await this._session.handleRedirectFromLogin(),!this._session.isActive&&!1!==t.restorePreviousSession)try{await this._session.restore()}catch{}return this.info}catch(e){return void this._events.emit(Ze,e)}}async login(e){const t=e.redirectUrl||window.location.href;await this._session.login(e.oidcIssuer,t)}async logout(){await this._session.logout()}async fetch(e,t){return this._session.authFetch(e,t)}},Ye=r;var et=o(386);const tt=o.n(et)()(Ye),nt=(0,Ye.sym)("http://www.iana.org/assignments/link-relations/acl");function rt(e){const t=tt;function n(e,n,r,i={}){const a=i.public||[],o=(0,Ye.graph)(),s=(0,Ye.Namespace)("http://www.w3.org/ns/auth/acl#");let c=o.sym(`${r}#a1`);const l=o.sym(r),u=o.sym(e);if(o.add(c,t.rdf("type"),s("Authorization"),l),o.add(c,s("accessTo"),u,l),i.defaultForNew&&o.add(c,s("default"),u,l),o.add(c,s("agent"),n,l),o.add(c,s("mode"),s("Read"),l),o.add(c,s("mode"),s("Write"),l),o.add(c,s("mode"),s("Control"),l),a.length){c=o.sym(`${r}#a2`),o.add(c,t.rdf("type"),s("Authorization"),l),o.add(c,s("accessTo"),u,l),o.add(c,s("agentClass"),t.foaf("Agent"),l);for(let e=0;e<a.length;e++)o.add(c,s("mode"),s(a[e]),l)}return(0,Ye.serialize)(l,o,r)}return{findAclDocUrl:async function(t){await e.fetcher.load(t);const n=e.any(t,nt);if(!n)throw new Error(`No ACL link discovered for ${t}`);return n.value},setACLUserPublic:function(t,r,i){const a=e.any(e.sym(t),nt);return Promise.resolve().then(()=>a||function(t){const n=e.fetcher;if(!n)throw new Error("Cannot fetch ACL rel, store has no fetcher");return n.load(t).then(n=>{if(!n.ok)throw new Error("fetchACLRel: While loading:"+n.error);const r=e.any(e.sym(t),nt);if(!r)throw new Error("fetchACLRel: No Link rel=ACL header for "+t);return r})}(t).catch(e=>{throw new Error(`Error fetching rel=ACL header for ${t}: ${e}`)})).then(a=>{const o=n(t,r,a.uri,i);if(!e.fetcher)throw new Error("Cannot PUT this, store has no fetcher");return e.fetcher.webOperation("PUT",a.uri,{data:o,contentType:"text/turtle"}).then(e=>{if(!e.ok)throw new Error("Error writing ACL text: "+e.error);return a})})},genACLText:n}}function it(){const{$SolidTestEnvironment:e}=window;if(void 0!==e&&e.username)return s("Assuming the user is "+e.username),(0,Ye.sym)(e.username);if("undefined"!=typeof document&&document.location&&"http://localhost"===(""+document.location).slice(0,16)){const e=document.getElementById("appTarget");if(!e)return null;const t=e.getAttribute("testID");return t?(s("Assuming user is "+t),(0,Ye.sym)(t)):null}return null}class at{constructor(e){this.session=e}get authSession(){return this.session}currentUser(){const e=(()=>{let{SolidAppContext:e}=window;if(e||(e={}),e.viewingNoAuthPage=!1,e.noAuth&&window.document&&window.document.location.href.startsWith(e.noAuth)){e.viewingNoAuthPage=!0;const t=new URLSearchParams(window.document.location.search);if(t){let n=e.viewedPage=t.get("uri")||null;if(n&&(n=decodeURI(n),!n.startsWith(e.noAuth))){const t=n.split(/\//);e.idp=t[0]+"//"+t[2],e.viewingNoAuthPage=!1}}}return e})();return e.viewingNoAuthPage?(0,Ye.sym)(e.webId):this&&this.session&&this.session.info&&this.session.info.webId&&this.session.info.isLoggedIn?(0,Ye.sym)(this.session.info.webId):it()}async checkUser(e){const t=new URL(window.location.href).hash;t&&window.localStorage.setItem("preLoginRedirectHash",t),this.session.events.on(Je,e=>{s(`Session restored to ${e}`),document.location.toString()!==e&&history.replaceState(null,"",e)});const n=new URL(window.location.href);n.hash="",await this.session.handleIncomingRedirect({restorePreviousSession:!0,url:n.href});const r=window.localStorage.getItem("preLoginRedirectHash");if(r){const e=new URL(window.location.href);e.hash!==r&&(history.pushState?history.pushState(null,document.title,r):location.hash=r,e.hash=r),window.localStorage.setItem("preLoginRedirectHash","")}let i=it();if(i)return Promise.resolve(e?e(i):i);const a=this.webIdFromSession(this.session.info);return a&&(i=this.saveUser(a)),i&&s(`(Logged in as ${i} by authentication)`),Promise.resolve(e?e(i):i)}saveUser(e,t){let n;if(e){n="string"==typeof e?e:e.uri;const r=(0,Ye.namedNode)(n);return t&&(t.me=r),r}return null}webIdFromSession(e){return(null==e?void 0:e.webId)&&e.isLoggedIn?e.webId:null}}function ot(e){return(0,Ye.sym)(e.uri+"#id"+Date.now())}function st(e){return!e||`${window.location.origin}/`!==new URL(e.value).origin}const ct="index.ttl#this";function lt(e,t){const n=tt;async function r(t,n,r){await e.fetcher.load(t);const i=e.any(t,new Ye.NamedNode("http://www.iana.org/assignments/link-relations/acl"));if(!i)throw new Error("Chat ACL doc not found!");const a=`\n            @prefix acl: <http://www.w3.org/ns/auth/acl#>.\n            <#owner>\n            a acl:Authorization;\n            acl:agent <${n.value}>;\n            acl:accessTo <.>;\n            acl:default <.>;\n            acl:mode\n                acl:Read, acl:Write, acl:Control.\n            <#invitee>\n            a acl:Authorization;\n            acl:agent <${r.value}>;\n            acl:accessTo <.>;\n            acl:default <.>;\n            acl:mode\n                acl:Read, acl:Append.\n            `;await e.fetcher.webOperation("PUT",i.value,{data:a,contentType:"text/turtle"})}async function i(t,r){const i=e.any(r,n.solid("privateTypeIndex"));if(!i)throw new Error("Private type index not found!");await e.fetcher.load(i);const a=ot(i),o=[(0,Ye.st)(a,n.rdf("type"),n.solid("TypeRegistration"),i.doc()),(0,Ye.st)(a,n.solid("forClass"),n.meeting("LongChat"),i.doc()),(0,Ye.st)(a,n.solid("instance"),t,i.doc())];await new Promise((t,n)=>{e.updater.update([],o,function(e,r,i){r?t(null):n(new Error(i))})})}async function a(n){const r=await t.loadMe(),i=function(e,t){const n=new URL(`IndividualChats/${new URL(e.value).host}/`,t.value).toString();return new Ye.NamedNode(n)}(n,await t.getPodRoot(r));let a=!0;try{await e.fetcher.load(new Ye.NamedNode(i.value+"index.ttl#this"))}catch(e){a=!1}return{me:r,chatContainer:i,exists:a}}async function o(e,t){return(await s({me:t,newBase:e.value})).newInstance}function s(t){const r=e,i=r.updater;if(t.me&&!t.me.uri)throw new Error("chat mintNew:  Invalid userid "+t.me);const a=t.newInstance=t.newInstance||r.sym(t.newBase+ct),o=a.doc();return r.add(a,n.rdf("type"),n.meeting("LongChat"),o),r.add(a,n.dc("title"),"Chat channel",o),r.add(a,n.dc("created"),(0,Ye.term)(new Date(Date.now())),o),t.me&&r.add(a,n.dc("author"),t.me,o),new Promise(function(e,n){null==i||i.put(o,r.statementsMatching(void 0,void 0,void 0,o),"text/turtle",function(r,i,o){i?e({...t,newInstance:a}):n(new Error("FAILED to save new chat channel at: "+r+" : "+o))})})}async function c(t,r){var i;await e.fetcher.load(t.doc());const a=e.any(t,n.ldp("inbox"),void 0,t.doc());if(!a)throw new Error(`Invitee inbox not found! ${t.value}`);const o=`\n        <> a <http://www.w3.org/ns/pim/meeting#LongChatInvite> ;\n        ${n.rdf("seeAlso")} <${r.value}> .\n        `,s=await(null===(i=e.fetcher)||void 0===i?void 0:i.webOperation("POST",a.value,{data:o,contentType:"text/turtle"}));if(!(null==s?void 0:s.headers.get("location")))throw new Error(`Invite sending returned a ${null==s?void 0:s.status}`)}return{setAcl:r,addToPrivateTypeIndex:i,findChat:a,createChatThing:o,getChat:async function(e,t=!0){const{me:n,chatContainer:s,exists:l}=await a(e);if(l)return new Ye.NamedNode(s.value+ct);if(t){const t=await o(s,n);return await c(e,t),await r(s,n,e),await i(t,n),t}return null},sendInvite:c,mintNew:s}}function ut(e,t,n,r,i){return{createInboxFor:async function(e,i){const a=await t.loadMe(),o=`${(await t.getPodRoot(a)).value}p2p-inboxes/${encodeURIComponent(i)}/`;return await r.createContainer(o),await n.setSinglePeerAccess({ownerWebId:a.value,peerWebId:e,accessToModes:"acl:Append",target:o}),o},getNewMessages:async function(e){e||(e=await t.loadMe());const n=await t.getMainInbox(e);return(await r.getContainerMembers(n)).filter(e=>!r.isContainer(e))},markAsRead:async function(t,n){const r=await e.fetcher._fetch(t);if(200!==r.status)throw new Error(`Not OK! ${t}`);const i=function(e,t){const n=t.getUTCFullYear(),r=("0"+(t.getUTCMonth()+1)).slice(-2),i=("0"+t.getUTCDate()).slice(-2),a=e.split("/"),o=a[a.length-1];return new URL(`./archive/${n}/${r}/${i}/${o}`,e).toString()}(t,n),a={method:"PUT",body:await r.text(),headers:[["Content-Type",r.headers.get("Content-Type")||"application/octet-stream"]]};"2"===(await e.fetcher._fetch(i,a)).status.toString()[0]&&await e.fetcher._fetch(t,{method:"DELETE"})}}}class dt extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name}}class pt extends dt{}class ft extends dt{}class ht extends dt{}class mt extends dt{}class gt extends dt{}class vt extends dt{constructor(e,t){super(t),this.status=e}}function yt(e,t,n){const r=tt;async function i(t){await a(t);const i=function(e){const t=e.uri.replace("/profile/","/").replace("/public/","/").split("/").slice(0,-1).join("/")+"/Settings/Preferences.ttl";return(0,Ye.sym)(t)}(t);let o;try{o=await n.followOrCreateLink(t,r.space("preferencesFile"),i,t.doc())}catch(e){if(c(`User ${t} has no pointer in profile to preferences file.`),e instanceof mt)throw e;if(e instanceof gt)throw e;if(e instanceof pt)throw e;if(e instanceof ft)throw e;if(e instanceof ht)throw e;if(e instanceof vt)throw e;throw e}try{await e.fetcher.load(o)}catch(e){const n=`Unable to load preference of user ${t}: ${e}`;if(c(n),401===e.response.status)throw new pt;if(403===e.response.status){if(st(o))throw new ft;throw new ht}throw new Error(n)}return o}async function a(t){if(!t)throw new Error("loadProfile: no user given.");try{await e.fetcher.load(t.doc())}catch(e){throw new Error(`Unable to load profile of user ${t}: ${e}`)}return t.doc()}function o(t){return e.any(t,r.space("storage"),void 0,t.doc())}return{loadMe:async function(){const n=t.currentUser();if(null===n)throw new Error("Current user not found! Not logged in?");return await e.fetcher.load(n.doc()),n},getPodRoot:function(e){const t=o(e);if(!t)throw new Error("User pod root not found!");return t},getMainInbox:async function(t){await e.fetcher.load(t);const n=e.any(t,r.ldp("inbox"),void 0,t.doc());if(!n)throw new Error("User main inbox not found!");return n},findStorage:o,loadPreferences:i,loadProfile:a,silencedLoadPreferences:async function(e){try{return await i(e)}catch(e){return}}}}function wt(e,t,n,r){const i=tt;async function a(t){if(!t)throw new Error("loadTypeIndexesFor: No user given");const a=await n.loadProfile(t),o=u(t);let s;try{s=await r.followOrCreateLink(t,i.solid("publicTypeIndex"),o,a)}catch(e){c(`User ${t} has no pointer in profile to publicTypeIndex file.`)}const l=s?[{label:"public",index:s,agent:t}]:[];let p,f;try{p=await n.silencedLoadPreferences(t)}catch(e){p=null}if(p){const n=d(p);let o;try{o=e.any(t,i.solid("privateTypeIndex"),void 0,a)||await r.followOrCreateLink(t,i.solid("privateTypeIndex"),n,p)}catch(e){c(`User ${t} has no pointer in preference file to privateTypeIndex file.`)}f=o?[{label:"private",index:o,agent:t}]:[]}else f=[];const h=l.concat(f);if(0===h.length)return h;const m=h.map(e=>e.index);try{await e.fetcher.load(m)}catch(e){c("Problems loading type index: ",e)}return h}async function o(t){let r;try{r=await n.silencedLoadPreferences(t)}catch(e){c(`User ${t} has no pointer in profile to preferences file.`)}if(r){const n=e.each(t,i.solid("community"),void 0,r).concat(e.each(t,i.solid("community"),void 0,t.doc()));let o=[];for(const e of n)o=o.concat(await a(e));return o}return[]}async function s(e){return(await a(e)).concat((await o(e)).flat())}async function l(e,t){const n=await s(t);let r=[];for(const t of n){const n=await p(t,e);r=r.concat(n)}return r}function u(e){var t;return(0,Ye.sym)((null===(t=e.doc().dir())||void 0===t?void 0:t.uri)+"publicTypeIndex.ttl")}function d(e){var t;return(0,Ye.sym)((null===(t=e.doc().dir())||void 0===t?void 0:t.uri)+"privateTypeIndex.ttl")}async function p(t,n){const r=t.index,a=[],o=e.statementsMatching(null,i.solid("instance"),null,r).concat(e.statementsMatching(null,i.solid("instanceContainer"),null,r)).map(e=>e.subject);for(const s of o){const o=e.any(s,i.solid("forClass"),null,r);if(!n||o.sameTerm(n)){const n=e.each(s,i.solid("instance"),null,r);for(const e of n)a.push({instance:e,type:o,scope:t});const c=e.each(s,i.solid("instanceContainer"),null,r);for(const n of c)await e.fetcher.load(n),a.push({instance:(0,Ye.sym)(n.value),type:o,scope:t})}}return a}return{registerInTypeIndex:async function(t,n,r){const a=ot(n),o=[(0,Ye.st)(a,i.rdf("type"),i.solid("TypeRegistration"),n),(0,Ye.st)(a,i.solid("forClass"),r,n),(0,Ye.st)(a,i.solid("instance"),t,n)];try{await e.updater.update([],o)}catch(e){const r=`Unable to register ${t} in index ${n}: ${e}`;return console.warn(r),null}return a},getRegistrations:function(t,n){return e.each(void 0,i.solid("instance"),t).filter(t=>e.holds(t,i.solid("forClass"),n))},loadTypeIndexesFor:a,loadCommunityTypeIndexes:o,loadAllTypeIndexes:s,getScopedAppInstances:l,getAppInstances:async function(e){const n=t.currentUser();if(!n)throw new Error("getAppInstances: Must be logged in to find apps.");return(await l(e,n)).map(e=>e.instance)},suggestPublicTypeIndex:u,suggestPrivateTypeIndex:d,deleteTypeIndexRegistration:async function(t){const n=e.the(null,i.solid("instance"),t.instance,t.scope.index);if(!n)throw new Error(`deleteTypeIndexRegistration: No registration found for ${t.instance}`);const r=e.statementsMatching(n,null,null,t.scope.index);await e.updater.update(r,[])},getScopedAppsFromIndex:p}}function bt(e,t){s("SolidLogic: Unique instance created.  There should only be one of these.");const n=Ye.graph();Ye.fetcher(n,{fetch:e.fetch}),n.updater=new Ye.UpdateManager(n),n.features=[];const r=new at(t),i=rt(n),a=function(e){function t(t){return e.statementsMatching(t,(0,Ye.sym)("http://www.w3.org/ns/ldp#contains"),void 0).map(e=>e.object)}function n(e){const t=e.value;return"/"===t.charAt(t.length-1)}return{isContainer:n,createContainer:async function(t){if(!n((0,Ye.sym)(t)))throw new Error(`Not a container URL ${t}`);const r=await e.fetcher._fetch(t,{method:"PUT",headers:{"Content-Type":"text/turtle","If-None-Match":"*",Link:'<http://www.w3.org/ns/ldp#BasicContainer>; rel="type"'},body:" "});if("2"!==r.status.toString()[0])throw new Error(`Not OK: got ${r.status} response while creating container at ${t}`)},getContainerElements:t,getContainerMembers:async function(n){return await e.fetcher.load(n),t(n)}}}(n),o=function(e,t,n){async function r(t){let n;try{n=await e.fetcher.load(t)}catch(n){if(404!==n.response.status){if(401===n.response.status)throw new pt;if(403===n.response.status){if(st(t))throw new ft;throw new ht}const e="createIfNotExists doc load error NOT 404:  "+t+": "+n;throw new vt(n.status,n.message+e)}try{await e.fetcher.webOperation("PUT",t,{data:"",contentType:"text/turtle"})}catch(e){throw new gt("createIfNotExists: PUT FAILED: "+t+": "+e)}await e.fetcher.load(t)}return n}return{recursiveDelete:async function r(i){try{if(n.isContainer(i)){const a=await t.findAclDocUrl(i);await e.fetcher._fetch(a,{method:"DELETE"});const o=await n.getContainerMembers(i);await Promise.all(o.map(e=>r(e)))}const a=i.value;return e.fetcher._fetch(a,{method:"DELETE"})}catch(e){s(`Please manually remove ${i.value} from your system.`,e)}},setSinglePeerAccess:async function(n){let r=["@prefix acl: <http://www.w3.org/ns/auth/acl#>.","",`<#alice> a acl:Authorization;\n  acl:agent <${n.ownerWebId}>;`,`  acl:accessTo <${n.target}>;`,`  acl:default <${n.target}>;`,"  acl:mode acl:Read, acl:Write, acl:Control.",""].join("\n");n.accessToModes&&(r+=["<#bobAccessTo> a acl:Authorization;",`  acl:agent <${n.peerWebId}>;`,`  acl:accessTo <${n.target}>;`,`  acl:mode ${n.accessToModes}.`,""].join("\n")),n.defaultModes&&(r+=["<#bobDefault> a acl:Authorization;",`  acl:agent <${n.peerWebId}>;`,`  acl:default <${n.target}>;`,`  acl:mode ${n.defaultModes}.`,""].join("\n"));const i=await t.findAclDocUrl((0,Ye.sym)(n.target));return e.fetcher._fetch(i,{method:"PUT",body:r,headers:[["Content-Type","text/turtle"]]})},createEmptyRdfDoc:async function(t,n){await e.fetcher.webOperation("PUT",t.uri,{data:`# ${new Date} ${n}\n  `,contentType:"text/turtle"})},followOrCreateLink:async function(t,n,i,a){await e.fetcher.load(a);const o=e.any(t,n,null,a);if(o)return o;if(!e.updater.editable(a)){const e=`followOrCreateLink: cannot edit ${a.value}`;throw c(e),new mt(e)}try{await e.updater.update([],[(0,Ye.st)(t,n,i,a)])}catch(e){throw c(`followOrCreateLink: Error making link in ${a} to ${i}: ${e}`),new gt(e)}try{await r(i)}catch(e){throw c(`followOrCreateLink: Error loading or saving new linked document: ${i}: ${e}`),e}return i},loadOrCreateIfNotExists:r}}(n,i,a),l=yt(n,r,o),u=lt(n,l),d=ut(n,l,o,a),p=wt(n,r,l,o);return s("SolidAuthnLogic initialized"),{store:n,authn:r,acl:i,inbox:d,chat:u,profile:l,typeIndex:p,load:function(e){return n.fetcher.load(e)},updatePromise:function(e,t=[]){return new Promise((r,i)=>{n.updater.update(e,t,function(e,t,n){t?r():i(new Error(n))})})},clearStore:function(){n.statements.slice().forEach(n.remove.bind(n))}}}const At=async(e,t)=>{const n=t&&t.credentials&&"omit"==t.credentials;return Xe.info.webId&&!n?Xe.fetch(e,t):window.fetch(e,t)},xt=Symbol.for("solid-logic-singleton"),Et="undefined"!=typeof window?window:o.g;const Ct=(Et[xt]?s("SolidLogic: Using existing global singleton instance."):(s("SolidLogic: Creating new global singleton instance."),Et[xt]=bt({fetch:At},Xe),s("Unique quadstore initialized.")),Et[xt]),kt=[{name:"Solid Community",uri:"https://solidcommunity.net"},{name:"Solid Web",uri:"https://solidweb.org"},{name:"Solid Web ME",uri:"https://solidweb.me"},{name:"Inrupt.com",uri:"https://login.inrupt.com"}];function _t(){const e=[...kt],{host:t,origin:n}=new URL(location.href),r=e.map(({uri:e})=>new URL(e).host);return r.includes(t)||r.some(e=>function(e,t){const n=e.length-t.length-1;return n>0&&"."===e[n]&&e.endsWith(t)}(t,e))||e.unshift({name:t,uri:n}),e}const St=Ct.authn,Tt=Ct.authn.authSession,Rt=Ct.store},5187(e,t,n){n.d(t,{lk:()=>A,tJ:()=>E});var r=n(3453),i=n(467),a=n(4756),o=n.n(a),s=n(7423),c=n(3378),l=n(1795),u=n(4961),d=n(9612),p=n(3291),f=n(3468),h=n(1763),m=n(7236),g=n(5175),v=n(2465),y=n(3262),w=window.document,b={};function A(e,t){return x.apply(this,arguments)}function x(){return x=(0,i.A)(o().mark(function e(t,n){var a,c,u;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=function(){return(u=(0,i.A)(o().mark(function e(){var i,s,c;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.innerHTML="",!(0,v.oy)(t)){e.next=1;break}return e.abrupt("return",a);case 1:return e.next=2,(0,v.x6)(t);case 2:if(i=e.sent,0!==(s=i.map(function(e){return g.M_.each(null,l.A.schema("target"),e,n)}).flat()).length){e.next=3;break}return e.abrupt("return",a);case 3:(c=s.map(function(e){return[g.M_.any(e,l.A.rdf("type"),null,n),g.M_.any(e,l.A.sioc("content"),null,n),g.M_.any(e,l.A.schema("agent"),null,n)]})).sort(),c.forEach(function(e){var t,n=(0,r.A)(e,3),i=n[0],o=n[1],s=n[2];s?(t=w.createElement("a")).setAttribute("href",s.uri):t=w.createTextNode(""),t.textContent=o||b[i]||"â¬œï¸",a.appendChild(t)});case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)},c=function(){return u.apply(this,arguments)},a=w.createElement("span"),c().then(s.Rm("sentimentStripLinked: sentimentStripLinked async refreshed")),a.refresh=c,e.abrupt("return",a);case 1:case"end":return e.stop()}},e)})),x.apply(this,arguments)}function E(e,t,n,r){return C.apply(this,arguments)}function C(){return C=(0,i.A)(o().mark(function e(t,n,r,a){var b,A,x,E,C,k,_,S,T,R,L,I,P,N,O,M,B,D,U;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I=function(e,t,r,a,s,c){function f(){v.style.backgroundColor=m?"yellow":"white"}var m,v=p.x6(w,r,d.P(a),function(){var r=(0,i.A)(o().mark(function r(i){var d,v,w,b;return o().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!m){r.next=2;break}return r.next=1,T(m);case 1:m=null,f(),r.next=8;break;case 2:return m=h.xV(s),d=[u.st(m,l.A.schema("agent"),e.me,s),u.st(m,l.A.rdf("type"),a,s),u.st(m,l.A.schema("target"),t,s)],r.next=3,g.M_.updater.update([],d);case 3:if(f(),!c){r.next=8;break}v=!1,w=0;case 4:if(!(w<c.length)){r.next=7;break}if(!(b=y(c[w]))){r.next=6;break}return r.next=5,T(b);case 5:v=!0;case 6:w++,r.next=4;break;case 7:v&&p.uS(n);case 8:case"end":return r.stop()}},r)}));return function(e){return r.apply(this,arguments)}}());function y(n){var r=g.M_.each(null,l.A.schema("agent"),e.me,s).filter(function(e){return g.M_.holds(e,l.A.rdf("type"),n,s)}).filter(function(e){return g.M_.holds(e,l.A.schema("target"),t,s)});return r.length?r[0]:null}function b(){m=y(a),f()}return v.refresh=b,b(),v},R=function(){return(R=(0,i.A)(o().mark(function e(t){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,g.M_.updater.update(g.M_.connectedStatements(t),[]);case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)},T=function(e){return R.apply(this,arguments)},S=function(){_.parentElement.parentElement.removeChild(_.parentElement)},k=function(){return(k=(0,i.A)(o().mark(function e(){var n,i;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,a.createThread(t);case 1:if(n=e.sent,i=r.chatOptions){e.next=2;break}throw new Error("replyInThread: missing options");case 2:i.showThread(n,i),S();case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)},C=function(){return k.apply(this,arguments)},E=function(){return E=(0,i.A)(o().mark(function e(n){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(L.value!==g.M_.any(t,l.A.foaf("maker")).value){e.next=1;break}return S(),e.next=1,(0,y.zt)(n,t,a,r);case 1:case"end":return e.stop()}},e)})),E.apply(this,arguments)},x=function(e){return E.apply(this,arguments)},A=function(){return(A=(0,i.A)(o().mark(function e(){var i,c,u;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=g.M_.any(t,l.A.foaf("maker")),L){e.next=1;break}alert("You can't delete the message, you are not logged in."),e.next=7;break;case 1:if(!L.sameTerm(i)){e.next=6;break}return e.prev=2,e.next=3,a.deleteMessage(t);case 3:e.next=5;break;case 4:e.prev=4,u=e.catch(2),c="Error deleting messaage "+u,s.R8(c),alert(c),(r.statusArea||n.parentNode).appendChild(f.F(w,c));case 5:n.parentNode.removeChild(n),e.next=7;break;case 6:alert("You can't delete the message, you are not logged in as the author, "+i);case 7:S();case 8:case"end":return e.stop()}},e,null,[[2,4]])}))).apply(this,arguments)},b=function(){return A.apply(this,arguments)},_=w.createElement("div"),e.next=1,(0,v.n6)(t).value;case 1:if(O=e.sent,M=l.A.schema("dateDeleted").value,O!==M){e.next=2;break}return e.abrupt("return",_);case 2:if((L=g.jO.currentUser())&&g.M_.holds(t,l.A.foaf("maker"),L)&&(_.appendChild(p.Qy(w,_,"message",b)),_.appendChild(p.x6(w,c.Pt.iconBase+"noun_253504.svg","edit",function(){return x(n)}))),(0,m.eD)(r).then(function(e){e&&_.appendChild(e)}),L=g.jO.currentUser(),!(B=L)){e.next=4;break}return e.next=3,(0,v.n6)(t).value;case 3:D=e.sent,U=l.A.schema("dateDeleted").value,B=D!==U;case 4:if(!B){e.next=5;break}P={me:L,dom:w,div:_},_.appendChild(I(P,t,c.Pt.iconBase+"noun_1384132.svg",l.A.schema("AgreeAction"),t.doc(),[l.A.schema("DisagreeAction")])),_.appendChild(I(P,t,c.Pt.iconBase+"noun_1384135.svg",l.A.schema("DisagreeAction"),t.doc(),[l.A.schema("AgreeAction")]));case 5:return g.M_.any(t,l.A.dct("created"))&&_.appendChild(p.x6(w,c.Pt.iconBase+"noun-reply-5506924.svg","Reply in thread",(0,i.A)(o().mark(function e(){return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,C();case 1:case"end":return e.stop()}},e)})))),(N=_.appendChild(p.x7(w))).style.float="right",N.firstChild.style.opacity="0.3",N.addEventListener("click",S),e.abrupt("return",_);case 6:case"end":return e.stop()}},e)})),C.apply(this,arguments)}b[l.A.schema("AgreeAction")]="ðŸ‘",b[l.A.schema("DisagreeAction")]="ðŸ‘Ž",b[l.A.schema("EndorseAction")]="â­ï¸",b[l.A.schema("LikeAction")]="â¤ï¸"},5386(e){const t={acl:"http://www.w3.org/ns/auth/acl#",arg:"http://www.w3.org/ns/pim/arg#",as:"https://www.w3.org/ns/activitystreams#",bookmark:"http://www.w3.org/2002/01/bookmark#",cal:"http://www.w3.org/2002/12/cal/ical#",cco:"http://www.ontologyrepository.com/CommonCoreOntologies/",cert:"http://www.w3.org/ns/auth/cert#",contact:"http://www.w3.org/2000/10/swap/pim/contact#",dc:"http://purl.org/dc/elements/1.1/",dct:"http://purl.org/dc/terms/",doap:"http://usefulinc.com/ns/doap#",foaf:"http://xmlns.com/foaf/0.1/",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",gpx:"http://www.w3.org/ns/pim/gpx#",gr:"http://purl.org/goodrelations/v1#",http:"http://www.w3.org/2007/ont/http#",httph:"http://www.w3.org/2007/ont/httph#",icalTZ:"http://www.w3.org/2002/12/cal/icaltzd#",ldp:"http://www.w3.org/ns/ldp#",link:"http://www.w3.org/2007/ont/link#",log:"http://www.w3.org/2000/10/swap/log#",meeting:"http://www.w3.org/ns/pim/meeting#",mo:"http://purl.org/ontology/mo/",org:"http://www.w3.org/ns/org#",owl:"http://www.w3.org/2002/07/owl#",pad:"http://www.w3.org/ns/pim/pad#",patch:"http://www.w3.org/ns/pim/patch#",prov:"http://www.w3.org/ns/prov#",pto:"http://www.productontology.org/id/",qu:"http://www.w3.org/2000/10/swap/pim/qif#",trip:"http://www.w3.org/ns/pim/trip#",rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",rss:"http://purl.org/rss/1.0/",sched:"http://www.w3.org/ns/pim/schedule#",schema:"http://schema.org/",sioc:"http://rdfs.org/sioc/ns#",skos:"http://www.w3.org/2004/02/skos/core#",solid:"http://www.w3.org/ns/solid/terms#",space:"http://www.w3.org/ns/pim/space#",stat:"http://www.w3.org/ns/posix/stat#",tab:"http://www.w3.org/2007/ont/link#",tabont:"http://www.w3.org/2007/ont/link#",ui:"http://www.w3.org/ns/ui#",vann:"http://purl.org/vocab/vann/",vcard:"http://www.w3.org/2006/vcard/ns#",wf:"http://www.w3.org/2005/01/wf/flow#",xsd:"http://www.w3.org/2001/XMLSchema#"};e.exports=function(e={namedNode:e=>e}){const n={};for(const r in t){const i=t[r];n[r]=function(t=""){return e.namedNode(i+t)}}return n}},5429(e,t,n){n.d(t,{sc:()=>c});var r=n(6013),i=(n(9271),n(4976));const a=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),o=new Uint32Array(64);class s extends r.ol{constructor(e=32){super(64,e,8,!1),this.A=0|r.yc[0],this.B=0|r.yc[1],this.C=0|r.yc[2],this.D=0|r.yc[3],this.E=0|r.yc[4],this.F=0|r.yc[5],this.G=0|r.yc[6],this.H=0|r.yc[7]}get(){const{A:e,B:t,C:n,D:r,E:i,F:a,G:o,H:s}=this;return[e,t,n,r,i,a,o,s]}set(e,t,n,r,i,a,o,s){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|i,this.F=0|a,this.G=0|o,this.H=0|s}process(e,t){for(let n=0;n<16;n++,t+=4)o[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=o[e-15],n=o[e-2],r=(0,i.Ow)(t,7)^(0,i.Ow)(t,18)^t>>>3,a=(0,i.Ow)(n,17)^(0,i.Ow)(n,19)^n>>>10;o[e]=a+o[e-7]+r+o[e-16]|0}let{A:n,B:s,C:c,D:l,E:u,F:d,G:p,H:f}=this;for(let e=0;e<64;e++){const t=f+((0,i.Ow)(u,6)^(0,i.Ow)(u,11)^(0,i.Ow)(u,25))+(0,r.r9)(u,d,p)+a[e]+o[e]|0,h=((0,i.Ow)(n,2)^(0,i.Ow)(n,13)^(0,i.Ow)(n,22))+(0,r.TQ)(n,s,c)|0;f=p,p=d,d=u,u=l+t|0,l=c,c=s,s=n,n=t+h|0}n=n+this.A|0,s=s+this.B|0,c=c+this.C|0,l=l+this.D|0,u=u+this.E|0,d=d+this.F|0,p=p+this.G|0,f=f+this.H|0,this.set(n,s,c,l,u,d,p,f)}roundClean(){(0,i.uH)(o)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,i.uH)(this.buffer)}}r.ol;const c=(0,i.qj)(()=>new s)},5501(e,t,n){n.d(t,{A:()=>i});var r=n(3662);function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,r.A)(e,t)}},5546(e){function t(n,r,i,a){var o=Object.defineProperty;try{o({},"",{})}catch(n){o=0}e.exports=t=function(e,n,r,i){function a(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?o?o(e,n,{value:r,enumerable:!i,configurable:!i,writable:!i}):e[n]=r:(a("next",0),a("throw",1),a("return",2))},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r,i,a)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},5561(e,t,n){n.d(t,{i:()=>r});
/**
 * @version IconicMultiSelect v0.7.0
 * @licence  MIT
 */
var r={multiselect__container:"\n        -webkit-box-align: center;\n        -ms-flex-align: center;\n            align-items: center;\n        background-color: #fff;\n        border-radius: 2px;\n        -webkit-box-shadow: 0 1px 3px 0 #d1d1d2, 0 0 0 1px #d1d1d2;\n                box-shadow: 0 1px 3px 0 #d1d1d2, 0 0 0 1px #d1d1d2;\n        -webkit-box-sizing: border-box;\n                box-sizing: border-box;\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        min-height: 36px;\n        padding: 4px 8px 0 8px;\n        position: relative;\n        width: 354px;\n        margin-bottom: 5px;\n        font-size: 100%\n    ",multiselect__wrapper:"\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        -ms-flex-wrap: wrap;\n            flex-wrap: wrap;\n        height: 100%;\n        width: 100%;\n    ",multiselect__clear_btn:"\n        cursor: pointer;\n        align-items: center;\n        margin-bottom: 4px;\n        margin-left: 4px;\n    ",multiselect__options:"\n        background-color: #f6f6f6;\n        border-radius: 2px;\n        left: 0;\n        max-height: 0;\n        overflow: hidden;\n        position: absolute;\n        top: calc(100% + 3px);\n        z-index: 9999;\n        width: 100%;\n        opacity: 0;\n        transition: max-height 0.1s ease;\n    ",multiselect__options_visible:"\n        background-color: #f6f6f6;\n        border-radius: 2px;\n        left: 0;\n        max-height: 0;\n        overflow: hidden;\n        position: absolute;\n        top: calc(100% + 3px);\n        z-index: 9999;\n        width: 100%;\n        opacity: 0;\n        transition: max-height 0.1s ease;\n        max-height: 200px;\n        -webkit-box-shadow: 0 1px 3px 0 #d1d1d2, 0 0 0 1px #d1d1d2;\n        box-shadow: 0 1px 3px 0 #d1d1d2, 0 0 0 1px #d1d1d2;\n        opacity: 1;\n        transition: max-height 0.2s ease;\n    ",multiselect__options_ul:"\n        list-style: none;\n        margin: 0;\n        padding: 2px 0;\n        max-height: 200px;\n        overflow: auto;\n    ",multiselect__options_ul_li:"\n        cursor: pointer;\n        padding: 4px 8px;\n    ",multiselect__options_ul_li_hover:"\n        background-color: #dedede;\n    ",multiselect__options_ul_p_multiselect__options_no_results:"\n        margin: 0;\n        padding: 8px;\n        text-align: center;\n    ",multiselect__options_ul_p_multiselect__options_no_data:"\n        margin: 0;\n        padding: 8px;\n        text-align: center;\n    ",multiselect__options_ul_li_multiselect__options_selected:"\n        background-color: #656565;\n        color: #fff;\n    ",multiselect__options_ul_li_multiselect__options_selected_hover:"\n    background-color: #656565;\n    ",multiselect__options_ul_li_arrow_selected:"\n        border: 2px solid rgba(101, 101, 101, 0.5);\n    ",multiselect__selected:"\n        background-color: #656565;\n        border-radius: 2px;\n        color: #fff;\n        margin-bottom: 4px;\n        margin-right: 4px;\n        padding: 4px 8px;\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        -webkit-box-align: center;\n        -ms-flex-align: center;\n        align-items: center;\n    ",multiselect__selected_multiselect__remove_btn:"\n        cursor: pointer;\n        display: flex;\n        margin-left: 6px;\n    ",multiselect__input:"\n        border: none;\n        -ms-flex-preferred-size: 40%;\n            flex-basis: 40%;\n        -webkit-box-flex: 1;\n            -ms-flex-positive: 1;\n                flex-grow: 1;\n        height: 5px;        \n        margin-bottom: 4px;\n        min-width: 40%;\n        outline: none;      \n    ",setStyle:function(e,t){e.style=r[t]}}},5579(e,t,n){n.d(t,{A:()=>s});var r=n(3954),i=n(3662),a=n(202),o=n(6324);function s(e){var t="function"==typeof Map?new Map:void 0;return s=function(e){if(null===e||!(0,a.A)(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return(0,o.A)(e,arguments,(0,r.A)(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),(0,i.A)(n,e)},s(e)}},5619(e,t,n){n.d(t,{D9:()=>A,H0:()=>C,L$:()=>L,Lu:()=>b,P3:()=>h,Tm:()=>y,Uf:()=>g,VM:()=>T,_7:()=>m,_E:()=>p,cH:()=>x,cl:()=>w,fb:()=>S,fg:()=>f,n1:()=>_,pe:()=>R,pp:()=>k,xo:()=>E,xw:()=>v});var r=n(467),i=n(4756),a=n.n(i),o=n(1795),s=n(5175),c=n(9612),l=n(7423),u=n(4961),d=s.hV.store;function p(e,t,n,r){var i=o.A.acl,a="/"===e.uri.slice(-1),s=d.each(void 0,i("default"),n,r).concat(d.each(void 0,i("defaultForNew"),n,r)).reduce(function(t,n){return t.concat(d.statementsMatching(n,o.A.rdf("type"),i("Authorization"),r)).concat(d.statementsMatching(n,i("agent"),void 0,r)).concat(d.statementsMatching(n,i("agentClass"),void 0,r)).concat(d.statementsMatching(n,i("agentGroup"),void 0,r)).concat(d.statementsMatching(n,i("origin"),void 0,r)).concat(d.statementsMatching(n,i("originClass"),void 0,r)).concat(d.statementsMatching(n,i("mode"),void 0,r)).concat((0,u.st)(n,i("accessTo"),e,r)).concat(a?(0,u.st)(n,i("default"),e,r):[])},[]),c=(0,u.graph)();return s.forEach(function(e){return c.add(l(e.subject),l(e.predicate),l(e.object),(0,u.sym)(t.uri))}),c;function l(e){var n=r.uri.length;return(0,u.sym)(e.uri.slice(0,n)===r.uri?t.uri+e.uri.slice(n):e.uri)}}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3]?function(t,n){return t.each(void 0,n.acl("default"),e).concat(t.each(void 0,n.acl("defaultForNew"),e))}(n,o.A):n.each(void 0,o.A.acl("accessTo"),e),i=o.A.acl,a={agent:{},agentClass:{},agentGroup:{},origin:{},originClass:{}};return Object.keys(a).forEach(function(e){r.forEach(function(t){n.each(t,i("mode")).forEach(function(r){n.each(t,i(e)).forEach(function(n){a[e][n.uri]=a[e][n.uri]||{},a[e][n.uri][r.uri]=t})})})}),a}function h(e,t){var n=function(e,t){for(var n in{agent:!0,agentClass:!0,agentGroup:!0,origin:!0,originClass:!0})if(e[n])for(var r in e[n])for(var i in e[n][r])if(!t[n][r]||!t[n][r][i])return!1;return!0};return n(e,t)&&n(t,e)}function m(e){for(var t,n,r=e[0],i=function(i){["agent","agentClass","agentGroup","origin","originClass"].forEach(function(a){if((t=e[i])[a])for(n in t[a])for(var o in t[a][n])r[a][n]||(r[a][n]=[]),r[a][n][o]=!0})},a=1;a<e.length;a++)i(a);return r}function g(e,t){var n=[],r=function(e){e.length?T(e.shift().doc(),function(i,a,o,s,c,l){var u=!a;if(!i||!c||!l)return t(i,s);var d=u?f(c,l):f(o,s);n.push(d),r(e.slice(1))}):t(!0,m(n))};r(e)}function v(e){var t={};return["agent","agentClass","agentGroup","origin","originClass"].forEach(function(n){for(var r in e[n]){var i=[];for(var a in e[n][r])i.push(a);i.sort();var o=i.join("\n");t[o]||(t[o]=[]),t[o].push([n,r])}}),t}function y(e,t,n,r){return w(e,t,v(n),r)}function w(e,t,n,r,i,a){var s=o.A.acl;for(var c in n){var l=n[c];if(l.length){var u=c.split("\n"),d=u.map(function(e){return e.split("#")[1]}).join("");a&&!i&&(d+="Default");var p=e.sym(r.uri+"#"+d);e.add(p,o.A.rdf("type"),s("Authorization"),r),i&&e.add(p,s("accessTo"),t,r),a&&e.add(p,s("default"),t,r);for(var f=0;f<u.length;f++)e.add(p,s("mode"),e.sym(u[f]),r);for(var h=0;h<l.length;h++){var m=l[h][0],g=l[h][1];e.add(p,s(m),e.sym(g),r)}}}}function b(e){return A(v(e))}function A(e){var t="";for(var n in e){t+=n.split("\n").map(function(e){return e.split("#")[1][0]}).join("")+":";for(var r=e[n],i=0;i<r.length;i++){var a=r[i][0],s=(0,u.sym)(r[i][1]);t+="agent"===a?"@":"",t+=s.sameTerm(o.A.foaf("Agent"))?"*":c.P(s),i<r.length-1&&(t+=",")}t+=";"}return"{"+t.slice(0,-1)+"}"}function x(e,t,n){var r=(0,u.graph)();return y(r,e,t,n),(0,u.serialize)(n,r,n.uri,"text/turtle")||""}function E(e,t,n,r,i){return C(e,t,v(n),r,i)}function C(e,t,n,r,i){var a,o=(0,u.graph)();w(o,t,n,r,!0),null===(a=e.updater)||void 0===a||a.put(r,o.statementsMatching(void 0,void 0,void 0,r),"text/turtle",function(a,o,s){var c;o?(null===(c=e.fetcher)||void 0===c||c.unload(r),w(e,t,n,r,!0),e.fetcher.requested[r.uri]="done",i(o)):i(o,s)})}function k(e,t,n){var r=d.each(void 0,o.A.vcard("hasMember"),e);r?_(e,r,t,n):(t("This card is in no groups"),n(!0))}function _(e,t,n,r){n=n||l.Rm;var i=e.doc();T(i,function(a,o,s,l,u,p){if(!a||!u||!p)return r(!1,l);var m=o?f(s,l):f(u,p);g(t,function(t,a){if(!t)return r(!1,a);h(a,m)?n("Nice - same ACL. no change "+c.P(e)+" "+i):(n("Group ACLs differ for "+c.P(e)+" "+i),E(d,s,a,l,r))})})}function S(e,t,n){var r=d.any(e,s.Oo);if(!d.fetcher)throw new Error("Store has no fetcher");r?d.fetcher.webOperation("PUT",r.value,{data:t,contentType:"text/turtle"}).then(function(e){n(e.ok,e.error||"")}):d.fetcher.nowOrWhenFetched(e,void 0,function(r,i){if(!r)return n(r,"Gettting headers for ACL: "+i);var a=d.any(e,s.Oo);if(a){if(!d.fetcher)throw new Error("Store has no fetcher");d.fetcher.webOperation("PUT",a.value,{data:t,contentType:"text/turtle"}).then(function(e){n(e.ok,e.error||"")})}else n(!1,"No Link rel=ACL header for "+e)})}function T(e,t){R(e,function(n,r,i,a){var s=o.A.acl;if(!n)return t(!1,!1,r,a);var c=function(n){"/"===n.slice(-1)&&(n=n.slice(0,-1));var r=n.lastIndexOf("/");if(n.indexOf("/",n.indexOf("//")+2)>r)return t(!1,!0,404,"Found no ACL resource");n=n.slice(0,r+1);var a=(0,u.sym)(n);R(a,function(r,o,l){if(!r)return t(!1,!0,o,"( No ACL pointer ".concat(n," ").concat(o,")").concat(l));if(403===o)return t(!1,!0,o,"( default ACL file FORBIDDEN. Stop.".concat(n,")"));if(404===o)return c(n);if(200!==o)return t(!1,!0,o,"Error status '".concat(o,"' searching for default for ").concat(a));if(!d.each(void 0,s("default"),d.sym(n),l).concat(d.each(void 0,s("defaultForNew"),d.sym(n),l)).length)return c(n);var u=d.sym(n);return t(!0,!1,e,i,u,l)})};return n?404!==r?403===r?t(!1,!1,r,"(Sharing not available to you)".concat(a)):200!==r?t(!1,!1,r,"Error ".concat(r," accessing Access Control information for ").concat(e,": ").concat(a)):t(!0,!0,e,i):void c(e.uri):t(!1,!1,r,"Error accessing Access Control information for ".concat(e,") ").concat(a))})}function R(e,t){if(!d.fetcher)throw new Error("kb has no fetcher");d.fetcher.nowOrWhenFetched(e,void 0,function(n,r){if(!n)return t(n,"Can't get headers to find ACL for ".concat(e,": ").concat(r));var i=d.any(e,s.Oo);if(i){if(!d.fetcher)throw new Error("kb has no fetcher");if(d.fetcher.nonexistent[i.value])return t(!0,404,i,"ACL file ".concat(i," does not exist."));d.fetcher.nowOrWhenFetched(i,void 0,function(e,n,r){e?t(!0,200,i):t(!0,r.status,i,"Can't read Access Control File ".concat(i,": ").concat(n))})}else t(!1,900,"No Link rel=ACL header for ".concat(e))})}function L(e){return I.apply(this,arguments)}function I(){return(I=(0,r.A)(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){return T((0,u.sym)(t),function(r,i,a,o,s){return r?e(i?a:s):n(new Error("Error loading ".concat(t)))})}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}},5747(e,t,n){n.d(t,{Kf:()=>y,OU:()=>v,YJ:()=>w,ZT:()=>b,_A:()=>A});var r,i=n(7528),a=n(3029),o=n(2901),s=n(580),c=n.n(s),l=n(6235),u=n(4961),d=n(7423),p=n(386),f=n(3468),h=n(3378),m=n(1795),g=n(5175).hV.store,v=function(){return(0,o.A)(function e(t,n,r,i){(0,a.A)(this,e),this.options=i||{},this.element=t,this.typeIndex=n,this.groupPickedCb=r,this.selectedgroup=this.options.selectedgroup,this.onSelectGroup=this.onSelectGroup.bind(this)},[{key:"render",value:function(){var e=this,t=document.createElement("div");if(t.style.maxWidth="350px",t.style.minHeight="200px",t.style.outline="1px solid black",t.style.display="flex",this.selectedgroup){t.style.flexDirection="column";var n=document.createElement("div");new w(n,this.selectedgroup).render();var r=document.createElement("button");r.textContent=c()("Change group"),r.addEventListener("click",function(t){e.selectedgroup=null,e.render()}),t.appendChild(n),t.appendChild(r)}else this.findAddressBook(this.typeIndex).then(function(n){var r=n.book,i=document.createElement("button");i.textContent=c()("Pick an existing group"),i.style.margin="auto",i.addEventListener("click",function(n){new y(t,r,e.onSelectGroup).render()});var a=document.createElement("button");a.textContent=c()("Create a new group"),a.style.margin="auto",a.addEventListener("click",function(t){e.createNewGroup(r,e.options.defaultNewGroupName).then(function(t){var n=t.group;new b(e.element,r,n,e.onSelectGroup).render()}).catch(function(t){e.element.appendChild((0,f.F)(document,c()("Error creating a new group. (".concat(t,")"))))})}),t.appendChild(i),t.appendChild(a),e.element.innerHTML="",e.element.appendChild(t)}).catch(function(t){e.element.appendChild((0,f.F)(document,c()("Could find your groups. (".concat(t,")"))))});return this.element.innerHTML="",this.element.appendChild(t),this}},{key:"findAddressBook",value:function(e){return new Promise(function(t,n){g.fetcher.nowOrWhenFetched(e,function(r,i){if(!r)return n(i);var a=g.any(null,m.A.solid("forClass"),m.A.vcard("AddressBook"));if(!a)return n(new Error("no address book registered in the solid type index "+e));var o=g.any(a,m.A.solid("instance"));if(!o)return n(new Error("incomplete address book registration"));g.fetcher.load(o).then(function(e){return t({book:o})}).catch(function(e){return n(new Error("Could not load address book "+e))})})})}},{key:"createNewGroup",value:function(e,t){var n=C(e),r=n.groupIndex,i=n.groupContainer,a=u.sym("".concat(i.uri).concat((0,l.A)().slice(0,8),".ttl#this")),o=t||"Untitled Group",s=[a.doc(),r].map(function(t){var n=u.st(a,m.A.rdf("type"),m.A.vcard("Group"),t),i=u.st(a,m.A.vcard("fn"),o,a.doc(),t),s=u.st(e,m.A.vcard("includesGroup"),a,t),c=t.equals(r)?[n,i,s]:[n,i];return E(t.uri,{toIns:c}).then(function(){c.forEach(function(e){g.add(e)})})});return Promise.all(s).then(function(){return{group:a}}).catch(function(e){throw d.Rm("Could not create new group.  PATCH failed "+e),new Error("Couldn't create new group.  PATCH failed for (".concat(e.xhr?e.xhr.responseURL:""," )"))})}},{key:"onSelectGroup",value:function(e){this.selectedgroup=e,this.groupPickedCb(e),this.render()}}])}(),y=function(){return(0,o.A)(function e(t,n,r){(0,a.A)(this,e),this.element=t,this.book=n,this.onSelectGroup=r},[{key:"render",value:function(){var e=this;return this.loadGroups().then(function(t){var n=document.createElement("div");n.style.display="flex",n.style.flexDirection="column",t.forEach(function(t){var r=document.createElement("button");r.addEventListener("click",e.handleClickGroup(t)),new w(r,t).render(),n.appendChild(r)}),e.element.innerHTML="",e.element.appendChild(n)}).catch(function(t){e.element.appendChild((0,f.F)(document,c()("There was an error loading your groups. (".concat(t,")"))))}),this}},{key:"loadGroups",value:function(){var e=this;return new Promise(function(t,n){var r=C(e.book).groupIndex;g.fetcher.nowOrWhenFetched(r,function(r,i){if(!r)return n(i);var a=g.each(e.book,m.A.vcard("includesGroup"));return t(a)})})}},{key:"handleClickGroup",value:function(e){var t=this;return function(n){t.onSelectGroup(e)}}}])}(),w=function(){return(0,o.A)(function e(t,n){(0,a.A)(this,e),this.element=t,this.group=n},[{key:"render",value:function(){var e=document.createElement("div");return e.textContent=c()(x(this.group,m.A.vcard("fn"),"[".concat(this.group.value,"]"))),this.element.innerHTML="",this.element.appendChild(e),this}}])}(),b=function(){return(0,o.A)(function e(t,n,r,i,o){(0,a.A)(this,e),this.element=t,this.book=n,this.group=r,this.onGroupChanged=function(e,t,n){o&&o(e,t,n)},this.groupChangedCb=o,this.doneBuildingCb=i},[{key:"refresh",value:function(){}},{key:"render",value:function(){var e=this,t=document.createElement("div");t.style.maxWidth="350px",t.style.minHeight="200px",t.style.outline="1px solid black",t.style.display="flex",t.style.flexDirection="column",(0,p.DK)(t,function(t){t.forEach(function(t){e.add(t).catch(function(t){e.element.appendChild((0,f.F)(document,c()("Could not add the given WebId. (".concat(t,")"))))})})});var n=document.createElement("input");n.type="text",n.value=x(this.group,m.A.vcard("fn"),"Untitled Group"),n.addEventListener("change",function(t){e.setGroupName(t.target.value).catch(function(t){e.element.appendChild((0,f.F)(document,"Error changing group name. (".concat(t,")")))})});var a=document.createElement("label");if(a.textContent=c()("Group Name:"),a.appendChild(n),t.appendChild(a),g.any(this.group,m.A.vcard("hasMember")))g.match(this.group,m.A.vcard("hasMember")).forEach(function(n){var r=n.object,i=document.createElement("div");new A(i,r,e.handleRemove(r)).render(),t.appendChild(i)});else{var o=document.createElement("p");o.textContent=c()(r||(r=(0,i.A)(["\n        To add someone to this group, drag and drop their WebID URL onto the box.\n      "]))),t.appendChild(o)}var s=document.createElement("button");return s.textContent=c()("Done"),s.addEventListener("click",function(t){e.doneBuildingCb(e.group)}),t.appendChild(s),this.element.innerHTML="",this.element.appendChild(t),this}},{key:"add",value:function(e){var t=this;return new Promise(function(n,r){g.fetcher.nowOrWhenFetched(e,function(i,a){if(!i)return t.onGroupChanged(a),r(a);var o=u.namedNode(e),s=g.any(o,m.A.rdf("type"));return s&&s.equals(m.A.foaf("Person"))?n(o):r(new Error("Only people supported right now. (tried to add something of type ".concat(s.value,")")))})}).then(function(e){var n=u.st(t.group,m.A.vcard("hasMember"),e);return g.holdsStatement(n)?e:E(t.group.doc().uri,{toIns:[n]}).then(function(){n.why=t.group.doc(),g.add(n),t.onGroupChanged(null,"added",e),t.render()})})}},{key:"handleRemove",value:function(e){var t=this;return function(n){var r=u.st(t.group,m.A.vcard("hasMember"),e);return E(t.group.doc().uri,{toDel:[r]}).then(function(){return g.remove(r),t.onGroupChanged(null,"removed",e),t.render(),!0}).catch(function(t){var n=g.any(e,m.A.foaf("name")),r=n&&n.value?"Could not remove ".concat(n.value,". (").concat(t,")"):"Could not remove ".concat(e.value,". (").concat(t,")");throw new Error(r)})}}},{key:"setGroupName",value:function(e){var t=this,n=C(this.book).groupIndex,r=[this.group.doc(),n].map(function(n){var r=g.match(t.group,m.A.vcard("fn"),null,n),i=u.st(t.group,m.A.vcard("fn"),u.literal(e));return E(n.value,{toDel:r,toIns:[i]}).then(function(e){g.removeStatements(r),i.why=n,g.add(i)})});return Promise.all(r)}}])}(),A=function(){return(0,o.A)(function e(t,n,r){(0,a.A)(this,e),this.webIdNode=n,this.element=t,this.handleRemove=r},[{key:"render",value:function(){var e=this,t=document.createElement("div");t.style.display="flex";var n=x(this.webIdNode,m.A.foaf("img"),h.LN+"noun_15059.svg"),r=document.createElement("img");r.src=c()(n),r.width="50",r.height="50",r.style.margin="5px";var i=x(this.webIdNode,m.A.foaf("name"),"[".concat(this.webIdNode,"]")),a=document.createElement("span");a.innerHTML=c()(i),a.style.flexGrow="1",a.style.margin="auto 0";var o=document.createElement("button");return o.textContent="Remove",o.addEventListener("click",function(t){return e.handleRemove().catch(function(t){e.element.appendChild((0,f.F)(document,c()("".concat(t))))})}),o.style.margin="5px",t.appendChild(r),t.appendChild(a),t.appendChild(o),this.element.innerHTML="",this.element.appendChild(t),this}}])}();function x(e,t,n){var r=g.any(e,t);return r?r.value:n}function E(e,t){var n=t.toDel,r=t.toIns;return new Promise(function(e,t){g.updater.update(n,r,function(n,r,i){if(!r)return t(new Error("PATCH failed for resource <".concat(n,">: ").concat(i)));e()})})}function C(e){return{groupIndex:g.any(e,m.A.vcard("groupIndex")),groupContainer:g.sym(e.dir().uri+"Group/")}}},5869(e,t,n){var r=n(887);e.exports=function(e,t,n,i,a){var o=r(e,t,n,i,a);return o.next().then(function(e){return e.done?e.value:o.next()})},e.exports.__esModule=!0,e.exports.default=e.exports},5912(e,t,n){n.r(t)},5923(e,t,n){n.d(t,{B:()=>a,u:()=>o});var r=n(5619),i=n(7367),a={adoptACLDefault:r._E,readACL:r.fg,sameACL:r.P3,ACLunion:r._7,loadUnionACL:r.Uf,ACLbyCombination:r.xw,makeACLGraph:r.Tm,makeACLGraphbyCombo:r.cl,ACLToString:r.Lu,comboToString:r.D9,makeACLString:r.cH,putACLObject:r.xo,putACLbyCombo:r.H0,fixIndividualCardACL:r.pp,fixIndividualACL:r.n1,setACL:r.fb,getACLorDefault:r.VM,getACL:r.pe},o={preventBrowserDropEvents:i.Fp,shortNameForFolder:i.DR,ACLControlBox5:i.wR}},6013(e,t,n){n.d(t,{Az:()=>l,DM:()=>c,TQ:()=>a,ol:()=>o,r9:()=>i,tT:()=>u,yc:()=>s});var r=n(4976);function i(e,t,n){return e&t^~e&n}function a(e,t,n){return e&t^e&n^t&n}class o extends r.Vw{constructor(e,t,n,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=i,this.buffer=new Uint8Array(e),this.view=(0,r.O8)(this.buffer)}update(e){(0,r.CC)(this),e=(0,r.ZJ)(e),(0,r.DO)(e);const{view:t,buffer:n,blockLen:i}=this,a=e.length;for(let o=0;o<a;){const s=Math.min(i-this.pos,a-o);if(s===i){const t=(0,r.O8)(e);for(;i<=a-o;o+=i)this.process(t,o);continue}n.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,r.CC)(this),(0,r.Ht)(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:i,isLE:a}=this;let{pos:o}=this;t[o++]=128,(0,r.uH)(this.buffer.subarray(o)),this.padOffset>i-o&&(this.process(n,0),o=0);for(let e=o;e<i;e++)t[e]=0;!function(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const i=BigInt(32),a=BigInt(4294967295),o=Number(n>>i&a),s=Number(n&a),c=r?4:0,l=r?0:4;e.setUint32(t+c,o,r),e.setUint32(t+l,s,r)}(n,i-8,BigInt(8*this.length),a),this.process(n,0);const s=(0,r.O8)(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<l;e++)s.setUint32(4*e,u[e],a)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:i,destroyed:a,pos:o}=this;return e.destroyed=a,e.finished=i,e.length=r,e.pos=o,r%t&&e.buffer.set(n),e}clone(){return this._cloneInto()}}const s=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),c=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),l=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),u=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])},6127(e,t,n){n.d(t,{$:()=>i});var r=n(7008),i={cameraCaptureControl:r.V,cameraButton:r.Y}},6235(e,t,n){n.d(t,{A:()=>o});var r=n(4210),i=n(6984),a=n(1060);const o=function(e,t,n){if(r.A.randomUUID&&!t&&!e)return r.A.randomUUID();const o=(e=e||{}).random??e.rng?.()??(0,i.A)();if(o.length<16)throw new Error("Random bytes length must be >= 16");if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=o[e];return t}return(0,a.k)(o)}},6247(e,t,n){n.d(t,{l:()=>i});var r=n(9417);function i(e){this.config=e||r.A}i.prototype.listen=function(){return new Promise(function(e,t){var n=window.addEventListener?"addEventListener":"attachEvent";(0,window[n])("attachEvent"===n?"onmessage":"message",function(n){var r=n.data;if("User:"===r.slice(0,5)){var i=r.slice(5,r.length);return i&&i.length>0&&"http"===i.slice(0,4)?e(i):t(i)}},!0)})},i.prototype.signup=function(e){e=e||this.config.signupEndpoint;var t=this.config.signupWindowWidth,n=this.config.signupWindowHeight,r=window.screen.width/2-(t/2+10),i=window.screen.height/2-(n/2+50),a=e+"?origin="+encodeURIComponent(window.location.origin),o="resizable,scrollbars,status,width="+t+",height="+n+",left="+r+",top="+i;window.open(a,"Solid signup",o);var s=this;return new Promise(function(e){s.listen().then(function(t){return e(t)})})}},6316(e,t,n){n.d(t,{x3:()=>C,y6:()=>y});var r=n(1454),i=n(4976),a=n(1848),o=n(615),s=n(8030);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const c=(e,t)=>(e+(e>=0?t:-t)/m)/t;function l(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function u(e,t){const n={};for(let r of Object.keys(t))n[r]=void 0===e[r]?t[r]:e[r];return(0,a.d6)(n.lowS,"lowS"),(0,a.d6)(n.prehash,"prehash"),void 0!==n.format&&l(n.format),n}class d extends Error{constructor(e=""){super(e)}}const p={Err:d,_tlv:{encode:(e,t)=>{const{Err:n}=p;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(1&t.length)throw new n("tlv.encode: unpadded data");const r=t.length/2,i=(0,a.zW)(r);if(i.length/2&128)throw new n("tlv.encode: long form length too big");const o=r>127?(0,a.zW)(i.length/2|128):"";return(0,a.zW)(e)+o+i+t},decode(e,t){const{Err:n}=p;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const i=t[r++];let a=0;if(!!(128&i)){const e=127&i;if(!e)throw new n("tlv.decode(long): indefinite length not supported");if(e>4)throw new n("tlv.decode(long): byte length is too big");const o=t.subarray(r,r+e);if(o.length!==e)throw new n("tlv.decode: length bytes not complete");if(0===o[0])throw new n("tlv.decode(long): zero leftmost byte");for(const e of o)a=a<<8|e;if(r+=e,a<128)throw new n("tlv.decode(long): not minimal encoding")}else a=i;const o=t.subarray(r,r+a);if(o.length!==a)throw new n("tlv.decode: wrong value length");return{v:o,l:t.subarray(r+a)}}},_int:{encode(e){const{Err:t}=p;if(e<f)throw new t("integer: negative integers are not allowed");let n=(0,a.zW)(e);if(8&Number.parseInt(n[0],16)&&(n="00"+n),1&n.length)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=p;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return(0,a.Ph)(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=p,i=(0,a.qj)("signature",e),{v:o,l:s}=r.decode(48,i);if(s.length)throw new t("invalid signature: left bytes after parsing");const{v:c,l}=r.decode(2,o),{v:u,l:d}=r.decode(2,l);if(d.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(c),s:n.decode(u)}},hexFromSig(e){const{_tlv:t,_int:n}=p,r=t.encode(2,n.encode(e.r))+t.encode(2,n.encode(e.s));return t.encode(48,r)}},f=BigInt(0),h=BigInt(1),m=BigInt(2),g=BigInt(3),v=BigInt(4);function y(e,t){const{BYTES:n}=e;let r;if("bigint"==typeof t)r=t;else{let i=(0,a.qj)("private key",t);try{r=e.fromBytes(i)}catch(e){throw new Error(`invalid private key: expected ui8a of size ${n}, got ${typeof t}`)}}if(!e.isValidNot0(r))throw new Error("invalid private key: out of range [1..N-1]");return r}function w(e,t={}){const n=(0,o.UT)("weierstrass",e,t),{Fp:r,Fn:s}=n;let l=n.CURVE;const{h:u,n:d}=l;(0,a.DS)(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:p}=t;if(p&&(!r.is0(l.a)||"bigint"!=typeof p.beta||!Array.isArray(p.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const m=A(r,s);function w(){if(!r.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}const x=t.toBytes||function(e,t,n){const{x:o,y:s}=t.toAffine(),c=r.toBytes(o);if((0,a.d6)(n,"isCompressed"),n){w();const e=!r.isOdd(s);return(0,i.Id)(b(e),c)}return(0,i.Id)(Uint8Array.of(4),c,r.toBytes(s))},E=t.fromBytes||function(e){(0,a.eV)(e,void 0,"Point");const{publicKey:t,publicKeyUncompressed:n}=m,i=e.length,o=e[0],s=e.subarray(1);if(i!==t||2!==o&&3!==o){if(i===n&&4===o){const e=r.BYTES,t=r.fromBytes(s.subarray(0,e)),n=r.fromBytes(s.subarray(e,2*e));if(!k(t,n))throw new Error("bad point: is not on curve");return{x:t,y:n}}throw new Error(`bad point: got length ${i}, expected compressed=${t} or uncompressed=${n}`)}{const e=r.fromBytes(s);if(!r.isValid(e))throw new Error("bad point: is not on curve, wrong x");const t=C(e);let n;try{n=r.sqrt(t)}catch(e){const t=e instanceof Error?": "+e.message:"";throw new Error("bad point: is not on curve, sqrt error"+t)}w();return!(1&~o)!==r.isOdd(n)&&(n=r.neg(n)),{x:e,y:n}}};function C(e){const t=r.sqr(e),n=r.mul(t,e);return r.add(r.add(n,r.mul(e,l.a)),l.b)}function k(e,t){const n=r.sqr(t),i=C(e);return r.eql(n,i)}if(!k(l.Gx,l.Gy))throw new Error("bad curve params: generator point");const _=r.mul(r.pow(l.a,g),v),S=r.mul(r.sqr(l.b),BigInt(27));if(r.is0(r.add(_,S)))throw new Error("bad curve params: a or b");function T(e,t,n=!1){if(!r.isValid(t)||n&&r.is0(t))throw new Error(`bad point coordinate ${e}`);return t}function R(e){if(!(e instanceof O))throw new Error("ProjectivePoint expected")}function L(e){if(!p||!p.basises)throw new Error("no endo");return function(e,t,n){const[[r,i],[o,s]]=t,l=c(s*e,n),u=c(-i*e,n);let d=e-l*r-u*o,p=-l*i-u*s;const m=d<f,g=p<f;m&&(d=-d),g&&(p=-p);const v=(0,a.OG)(Math.ceil((0,a.dJ)(n)/2))+h;if(d<f||d>=v||p<f||p>=v)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:m,k1:d,k2neg:g,k2:p}}(e,p.basises,s.ORDER)}const I=(0,a.x)((e,t)=>{const{X:n,Y:i,Z:a}=e;if(r.eql(a,r.ONE))return{x:n,y:i};const o=e.is0();null==t&&(t=o?r.ONE:r.inv(a));const s=r.mul(n,t),c=r.mul(i,t),l=r.mul(a,t);if(o)return{x:r.ZERO,y:r.ZERO};if(!r.eql(l,r.ONE))throw new Error("invZ was invalid");return{x:s,y:c}}),P=(0,a.x)(e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.Y))return;throw new Error("bad point: ZERO")}const{x:n,y:i}=e.toAffine();if(!r.isValid(n)||!r.isValid(i))throw new Error("bad point: x or y not field elements");if(!k(n,i))throw new Error("bad point: equation left != right");if(!e.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function N(e,t,n,i,a){return n=new O(r.mul(n.X,e),n.Y,n.Z),t=(0,o.u0)(i,t),n=(0,o.u0)(a,n),t.add(n)}class O{constructor(e,t,n){this.X=T("x",e),this.Y=T("y",t,!0),this.Z=T("z",n),Object.freeze(this)}static CURVE(){return l}static fromAffine(e){const{x:t,y:n}=e||{};if(!e||!r.isValid(t)||!r.isValid(n))throw new Error("invalid affine point");if(e instanceof O)throw new Error("projective point not allowed");return r.is0(t)&&r.is0(n)?O.ZERO:new O(t,n,r.ONE)}static fromBytes(e){const t=O.fromAffine(E((0,a.eV)(e,void 0,"point")));return t.assertValidity(),t}static fromHex(e){return O.fromBytes((0,a.qj)("pointHex",e))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(e=8,t=!0){return B.createCache(this,e),t||this.multiply(g),this}assertValidity(){P(this)}hasEvenY(){const{y:e}=this.toAffine();if(!r.isOdd)throw new Error("Field doesn't support isOdd");return!r.isOdd(e)}equals(e){R(e);const{X:t,Y:n,Z:i}=this,{X:a,Y:o,Z:s}=e,c=r.eql(r.mul(t,s),r.mul(a,i)),l=r.eql(r.mul(n,s),r.mul(o,i));return c&&l}negate(){return new O(this.X,r.neg(this.Y),this.Z)}double(){const{a:e,b:t}=l,n=r.mul(t,g),{X:i,Y:a,Z:o}=this;let s=r.ZERO,c=r.ZERO,u=r.ZERO,d=r.mul(i,i),p=r.mul(a,a),f=r.mul(o,o),h=r.mul(i,a);return h=r.add(h,h),u=r.mul(i,o),u=r.add(u,u),s=r.mul(e,u),c=r.mul(n,f),c=r.add(s,c),s=r.sub(p,c),c=r.add(p,c),c=r.mul(s,c),s=r.mul(h,s),u=r.mul(n,u),f=r.mul(e,f),h=r.sub(d,f),h=r.mul(e,h),h=r.add(h,u),u=r.add(d,d),d=r.add(u,d),d=r.add(d,f),d=r.mul(d,h),c=r.add(c,d),f=r.mul(a,o),f=r.add(f,f),d=r.mul(f,h),s=r.sub(s,d),u=r.mul(f,p),u=r.add(u,u),u=r.add(u,u),new O(s,c,u)}add(e){R(e);const{X:t,Y:n,Z:i}=this,{X:a,Y:o,Z:s}=e;let c=r.ZERO,u=r.ZERO,d=r.ZERO;const p=l.a,f=r.mul(l.b,g);let h=r.mul(t,a),m=r.mul(n,o),v=r.mul(i,s),y=r.add(t,n),w=r.add(a,o);y=r.mul(y,w),w=r.add(h,m),y=r.sub(y,w),w=r.add(t,i);let b=r.add(a,s);return w=r.mul(w,b),b=r.add(h,v),w=r.sub(w,b),b=r.add(n,i),c=r.add(o,s),b=r.mul(b,c),c=r.add(m,v),b=r.sub(b,c),d=r.mul(p,w),c=r.mul(f,v),d=r.add(c,d),c=r.sub(m,d),d=r.add(m,d),u=r.mul(c,d),m=r.add(h,h),m=r.add(m,h),v=r.mul(p,v),w=r.mul(f,w),m=r.add(m,v),v=r.sub(h,v),v=r.mul(p,v),w=r.add(w,v),h=r.mul(m,w),u=r.add(u,h),h=r.mul(b,w),c=r.mul(y,c),c=r.sub(c,h),h=r.mul(y,m),d=r.mul(b,d),d=r.add(d,h),new O(c,u,d)}subtract(e){return this.add(e.negate())}is0(){return this.equals(O.ZERO)}multiply(e){const{endo:n}=t;if(!s.isValidNot0(e))throw new Error("invalid scalar: out of range");let r,i;const a=e=>B.cached(this,e,e=>(0,o.Ak)(O,e));if(n){const{k1neg:t,k1:o,k2neg:s,k2:c}=L(e),{p:l,f:u}=a(o),{p:d,f:p}=a(c);i=u.add(p),r=N(n.beta,l,d,t,s)}else{const{p:t,f:n}=a(e);r=t,i=n}return(0,o.Ak)(O,[r,i])[0]}multiplyUnsafe(e){const{endo:n}=t,r=this;if(!s.isValid(e))throw new Error("invalid scalar: out of range");if(e===f||r.is0())return O.ZERO;if(e===h)return r;if(B.hasCache(this))return this.multiply(e);if(n){const{k1neg:t,k1:i,k2neg:a,k2:s}=L(e),{p1:c,p2:l}=(0,o.fH)(O,r,i,s);return N(n.beta,c,l,t,a)}return B.unsafe(r,e)}multiplyAndAddUnsafe(e,t,n){const r=this.multiplyUnsafe(t).add(e.multiplyUnsafe(n));return r.is0()?void 0:r}toAffine(e){return I(this,e)}isTorsionFree(){const{isTorsionFree:e}=t;return u===h||(e?e(O,this):B.unsafe(this,d).is0())}clearCofactor(){const{clearCofactor:e}=t;return u===h?this:e?e(O,this):this.multiplyUnsafe(u)}isSmallOrder(){return this.multiplyUnsafe(u).is0()}toBytes(e=!0){return(0,a.d6)(e,"isCompressed"),this.assertValidity(),x(O,this,e)}toHex(e=!0){return(0,i.My)(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(e=!0){return this.toBytes(e)}_setWindowSize(e){this.precompute(e)}static normalizeZ(e){return(0,o.Ak)(O,e)}static msm(e,t){return(0,o.Xf)(O,s,e,t)}static fromPrivateKey(e){return O.BASE.multiply(y(s,e))}}O.BASE=new O(l.Gx,l.Gy,r.ONE),O.ZERO=new O(r.ZERO,r.ONE,r.ZERO),O.Fp=r,O.Fn=s;const M=s.BITS,B=new o.hT(O,t.endo?Math.ceil(M/2):M);return O.BASE.precompute(8),O}function b(e){return Uint8Array.of(e?2:3)}function A(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function x(e,t,n={}){(0,i.sd)(t),(0,a.DS)(n,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const o=n.randomBytes||i.po,c=n.hmac||((e,...n)=>(0,r.w)(t,e,(0,i.Id)(...n))),{Fp:d,Fn:g}=e,{ORDER:v,BITS:w}=g,{keygen:x,getPublicKey:E,getSharedSecret:C,utils:k,lengths:_}=function(e,t={}){const{Fn:n}=e,r=t.randomBytes||i.po,o=Object.assign(A(e.Fp,n),{seed:(0,s.Tp)(n.ORDER)});function c(e){try{return!!y(n,e)}catch(e){return!1}}function l(e=r(o.seed)){return(0,s.qy)((0,a.eV)(e,o.seed,"seed"),n.ORDER)}function u(t,r=!0){return e.BASE.multiply(y(n,t)).toBytes(r)}function d(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;const{secretKey:r,publicKey:i,publicKeyUncompressed:s}=o;if(n.allowedLengths||r===i)return;const c=(0,a.qj)("key",t).length;return c===i||c===s}const p={isValidSecretKey:c,isValidPublicKey:function(t,n){const{publicKey:r,publicKeyUncompressed:i}=o;try{const a=t.length;return!(!0===n&&a!==r||!1===n&&a!==i||!e.fromBytes(t))}catch(e){return!1}},randomSecretKey:l,isValidPrivateKey:c,randomPrivateKey:l,normPrivateKeyToScalar:e=>y(n,e),precompute:(t=8,n=e.BASE)=>n.precompute(t,!1)};return Object.freeze({getPublicKey:u,getSharedSecret:function(t,r,i=!0){if(!0===d(t))throw new Error("first arg must be private key");if(!1===d(r))throw new Error("second arg must be public key");const a=y(n,t);return e.fromHex(r).multiply(a).toBytes(i)},keygen:function(e){const t=l(e);return{secretKey:t,publicKey:u(t)}},Point:e,utils:p,lengths:o})}(e,n),S={prehash:!1,lowS:"boolean"==typeof n.lowS&&n.lowS,format:void 0,extraEntropy:!1},T="compact";function R(e){return e>v>>h}function L(e,t){if(!g.isValidNot0(t))throw new Error(`invalid signature ${e}: out of range 1..Point.Fn.ORDER`);return t}class I{constructor(e,t,n){this.r=L("r",e),this.s=L("s",t),null!=n&&(this.recovery=n),Object.freeze(this)}static fromBytes(e,t=T){let n;if(function(e,t){l(t);const n=_.signature,r="compact"===t?n:"recovered"===t?n+1:void 0;(0,a.eV)(e,r,`${t} signature`)}(e,t),"der"===t){const{r:t,s:n}=p.toSig((0,a.eV)(e));return new I(t,n)}"recovered"===t&&(n=e[0],t="compact",e=e.subarray(1));const r=g.BYTES,i=e.subarray(0,r),o=e.subarray(r,2*r);return new I(g.fromBytes(i),g.fromBytes(o),n)}static fromHex(e,t){return this.fromBytes((0,i.aT)(e),t)}addRecoveryBit(e){return new I(this.r,this.s,e)}recoverPublicKey(t){const n=d.ORDER,{r,s:o,recovery:s}=this;if(null==s||![0,1,2,3].includes(s))throw new Error("recovery id invalid");if(v*m<n&&s>1)throw new Error("recovery id is ambiguous for h>1 curve");const c=2===s||3===s?r+v:r;if(!d.isValid(c))throw new Error("recovery id 2 or 3 invalid");const l=d.toBytes(c),u=e.fromBytes((0,i.Id)(b(!(1&s)),l)),p=g.inv(c),f=N((0,a.qj)("msgHash",t)),h=g.create(-f*p),y=g.create(o*p),w=e.BASE.multiplyUnsafe(h).add(u.multiplyUnsafe(y));if(w.is0())throw new Error("point at infinify");return w.assertValidity(),w}hasHighS(){return R(this.s)}toBytes(e=T){if(l(e),"der"===e)return(0,i.aT)(p.hexFromSig(this));const t=g.toBytes(this.r),n=g.toBytes(this.s);if("recovered"===e){if(null==this.recovery)throw new Error("recovery bit must be present");return(0,i.Id)(Uint8Array.of(this.recovery),t,n)}return(0,i.Id)(t,n)}toHex(e){return(0,i.My)(this.toBytes(e))}assertValidity(){}static fromCompact(e){return I.fromBytes((0,a.qj)("sig",e),"compact")}static fromDER(e){return I.fromBytes((0,a.qj)("sig",e),"der")}normalizeS(){return this.hasHighS()?new I(this.r,g.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,i.My)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,i.My)(this.toBytes("compact"))}}const P=n.bits2int||function(e){if(e.length>8192)throw new Error("input is too large");const t=(0,a.Ph)(e),n=8*e.length-w;return n>0?t>>BigInt(n):t},N=n.bits2int_modN||function(e){return g.create(P(e))},O=(0,a.OG)(w);function M(e){return(0,a.aK)("num < 2^"+w,e,f,O),g.toBytes(e)}function B(e,n){return(0,a.eV)(e,void 0,"message"),n?(0,a.eV)(t(e),void 0,"prehashed message"):e}return Object.freeze({keygen:x,getPublicKey:E,getSharedSecret:C,utils:k,lengths:_,Point:e,sign:function(n,r,s={}){n=(0,a.qj)("message",n);const{seed:l,k2sig:d}=function(t,n,r){if(["recovered","canonical"].some(e=>e in r))throw new Error("sign() legacy options not supported");const{lowS:s,prehash:c,extraEntropy:l}=u(r,S);t=B(t,c);const d=N(t),p=y(g,n),m=[M(p),M(d)];if(null!=l&&!1!==l){const e=!0===l?o(_.secretKey):l;m.push((0,a.qj)("extraEntropy",e))}const v=(0,i.Id)(...m),w=d;return{seed:v,k2sig:function(t){const n=P(t);if(!g.isValidNot0(n))return;const r=g.inv(n),i=e.BASE.multiply(n).toAffine(),a=g.create(i.x);if(a===f)return;const o=g.create(r*g.create(w+a*p));if(o===f)return;let c=(i.x===a?0:2)|Number(i.y&h),l=o;return s&&R(o)&&(l=g.neg(o),c^=1),new I(a,l,c)}}}(n,r,s);return(0,a.fg)(t.outputLen,g.BYTES,c)(l,d)},verify:function(t,n,r,o={}){const{lowS:s,prehash:c,format:l}=u(o,S);if(r=(0,a.qj)("publicKey",r),n=B((0,a.qj)("message",n),c),"strict"in o)throw new Error("options.strict was renamed to lowS");const d=void 0===l?function(e){let t;const n="string"==typeof e||(0,i.aY)(e),r=!n&&null!==e&&"object"==typeof e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!n&&!r)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(r)t=new I(e.r,e.s);else if(n){try{t=I.fromBytes((0,a.qj)("sig",e),"der")}catch(e){if(!(e instanceof p.Err))throw e}if(!t)try{t=I.fromBytes((0,a.qj)("sig",e),"compact")}catch(e){return!1}}return t||!1}(t):I.fromBytes((0,a.qj)("sig",t),l);if(!1===d)return!1;try{const t=e.fromBytes(r);if(s&&d.hasHighS())return!1;const{r:i,s:a}=d,o=N(n),c=g.inv(a),l=g.create(o*c),u=g.create(i*c),p=e.BASE.multiplyUnsafe(l).add(t.multiplyUnsafe(u));if(p.is0())return!1;return g.create(p.x)===i}catch(e){return!1}},recoverPublicKey:function(e,t,n={}){const{prehash:r}=u(n,S);return t=B(t,r),I.fromBytes(e,"recovered").recoverPublicKey(t).toBytes()},Signature:I,hash:t})}function E(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp;let r=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(e=>Math.ceil(e/2)))):void 0;return{CURVE:t,curveOpts:{Fp:n,Fn:(0,s.D0)(t.n,{BITS:e.nBitLength,allowedLengths:r,modFromBytes:e.wrapPrivateKey}),allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes}}}function C(e){const{CURVE:t,curveOpts:n,hash:r,ecdsaOpts:i}=function(e){const{CURVE:t,curveOpts:n}=E(e),r={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:n,hash:e.hash,ecdsaOpts:r}}(e);return function(e,t){const n=t.Point;return Object.assign({},t,{ProjectivePoint:n,CURVE:Object.assign({},e,(0,s.LH)(n.Fn.ORDER,n.Fn.BITS))})}(e,x(w(t,n),r,i))}},6324(e,t,n){n.d(t,{A:()=>a});var r=n(2176),i=n(3662);function a(e,t,n){if((0,r.A)())return Reflect.construct.apply(null,arguments);var a=[null];a.push.apply(a,t);var o=new(e.bind.apply(e,a));return n&&(0,i.A)(o,n.prototype),o}},6355(e,t,n){n.d(t,{$I:()=>d,ck:()=>p});for(var r=n(3453),i={jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",webp:"image/webp",svg:"image/svg+xml",ico:"image/x-icon",bmp:"image/bmp",tiff:"image/tiff",tif:"image/tiff",avif:"image/avif",pdf:"application/pdf",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",odt:"application/vnd.oasis.opendocument.text",ods:"application/vnd.oasis.opendocument.spreadsheet",txt:"text/plain",html:"text/html",htm:"text/html",css:"text/css",csv:"text/csv",xml:"text/xml",md:"text/markdown",markdown:"text/markdown",js:"text/javascript",mjs:"text/javascript",ts:"text/typescript",json:"application/json",jsonld:"application/ld+json",ttl:"text/turtle",n3:"text/n3",nt:"application/n-triples",nq:"application/n-quads",rdf:"application/rdf+xml",trig:"application/trig",mp3:"audio/mpeg",wav:"audio/wav",ogg:"audio/ogg",oga:"audio/ogg",m4a:"audio/mp4",flac:"audio/flac",aac:"audio/aac",weba:"audio/webm",mp4:"video/mp4",m4v:"video/mp4",webm:"video/webm",ogv:"video/ogg",avi:"video/x-msvideo",mov:"video/quicktime",mkv:"video/x-matroska",zip:"application/zip",gz:"application/gzip",tar:"application/x-tar",rar:"application/vnd.rar","7z":"application/x-7z-compressed",woff:"font/woff",woff2:"font/woff2",ttf:"font/ttf",otf:"font/otf",eot:"application/vnd.ms-fontobject",wasm:"application/wasm",bin:"application/octet-stream"},a={},o=0,s=Object.entries(i);o<s.length;o++){var c=(0,r.A)(s[o],2),l=c[0],u=c[1];a[u]||(a[u]=l)}function d(e){var t,n=null===(t=e.split(".").pop())||void 0===t?void 0:t.toLowerCase();return n&&i[n]||!1}function p(e){var t=e.split(";")[0].trim().toLowerCase();return a[t]||!1}},6369(e,t,n){function r(e){if(Array.isArray(e))return e}n.d(t,{A:()=>r})},6466(e,t,n){n.d(t,{v:()=>m});var r=n(467),i=n(3029),a=n(2901),o=n(4756),s=n.n(o),c=n(5619),l=n(4961),u=n(1214),d=n(7367),p=n(9612),f=n(7423),h=n(675),m=function(){return(0,a.A)(function e(t,n,r,a,o,s,l,d,p,f,m,g){if((0,i.A)(this,e),this.subject=t,this.noun=n,this.context=r,this.statusElement=a,this.targetIsProtected=o,this.targetDoc=s,this.targetACLDoc=l,this.defaultHolder=d,this.defaultACLDoc=p,this.prospectiveDefaultHolder=f,this.store=m,this.dom=g,this.rootElement=g.createElement("div"),this.rootElement.setAttribute("style",h.i.aclGroupContent),this.isContainer="/"===s.uri.slice(-1),d&&p){this.isUsingDefaults=!0;var v=(0,c._E)(this.targetDoc,l,d,p);this.mainCombo=new u.h(s,l,this,v,{defaults:this.isContainer}),this.defaultsCombo=null,this.defaultsDiffer=!1}else this.isUsingDefaults=!1,this.mainCombo=new u.h(s,l,this,m),this.defaultsCombo=new u.h(s,l,this,m,{defaults:this.isContainer}),this.defaultsDiffer=!(0,c.P3)(this.mainCombo.aclMap,this.defaultsCombo.aclMap)},[{key:"isEditable",get:function(){return!this.isUsingDefaults}},{key:"render",value:function(){if(this.rootElement.innerHTML="",this.isUsingDefaults){if(this.renderStatus("The sharing for this ".concat(this.noun," is the default for folder ")),this.defaultHolder){var e=this.statusElement.appendChild(this.dom.createElement("a"));e.href=this.defaultHolder.uri,e.innerText=(0,d.DR)(this.defaultHolder)}}else!this.defaultsDiffer&&this.isContainer?this.renderStatus("This is also the default for things in this folder."):this.renderStatus("");return this.rootElement.appendChild(this.mainCombo.render()),this.defaultsCombo&&this.defaultsDiffer?(this.rootElement.appendChild(this.renderRemoveDefaultsController()),this.rootElement.appendChild(this.defaultsCombo.render())):this.isEditable&&this.isContainer&&this.rootElement.appendChild(this.renderAddDefaultsController()),!this.targetIsProtected&&this.isUsingDefaults?this.rootElement.appendChild(this.renderAddAclsController()):this.targetIsProtected||this.rootElement.appendChild(this.renderRemoveAclsController()),this.rootElement}},{key:"renderRemoveAclsController",value:function(){var e=this,t=this.dom.createElement("button");return t.innerText="Remove custom sharing settings for this ".concat(this.noun," -- just use default").concat(this.prospectiveDefaultHolder?" for ".concat(p.P(this.prospectiveDefaultHolder)):""),t.setAttribute("style",h.i.bigButton),t.addEventListener("click",function(){return e.removeAcls().then(function(){return e.render()}).catch(function(t){return e.renderStatus(t)})}),t}},{key:"renderAddAclsController",value:function(){var e=this,t=this.dom.createElement("button");return t.innerText="Set specific sharing for this ".concat(this.noun),t.setAttribute("style",h.i.bigButton),t.addEventListener("click",function(){return e.addAcls().then(function(){return e.render()}).catch(function(t){return e.renderStatus(t)})}),t}},{key:"renderAddDefaultsController",value:function(){var e=this,t=this.dom.createElement("div");t.setAttribute("style",h.i.defaultsController);var n=t.appendChild(this.dom.createElement("div"));n.innerText="Sharing for things within the folder currently tracks sharing for the folder.",n.setAttribute("style",h.i.defaultsControllerNotice);var r=t.appendChild(this.dom.createElement("button"));return r.innerText="Set the sharing of folder contents separately from the sharing for the folder",r.setAttribute("style",h.i.bigButton),r.addEventListener("click",function(){return e.addDefaults().then(function(){return e.render()})}),t}},{key:"renderRemoveDefaultsController",value:function(){var e=this,t=this.dom.createElement("div");t.setAttribute("style",h.i.defaultsController);var n=t.appendChild(this.dom.createElement("div"));n.innerText="Access to things within this folder:",n.setAttribute("style",h.i.defaultsControllerNotice);var r=t.appendChild(this.dom.createElement("button"));return r.innerText="Set default for folder contents to just track the sharing for the folder",r.setAttribute("style",h.i.bigButton),r.addEventListener("click",function(){return e.removeDefaults().then(function(){return e.render()}).catch(function(t){return e.renderStatus(t)})}),t}},{key:"renderTemporaryStatus",value:function(e){var t=this;this.statusElement.setAttribute("style",h.i.aclControlBoxStatusRevealed),this.statusElement.innerText=e,this.statusElement.setAttribute("style",h.i.temporaryStatusInit),setTimeout(function(){t.statusElement.setAttribute("style",h.i.temporaryStatusEnd)}),setTimeout(function(){t.statusElement.innerText=""},5e3)}},{key:"renderStatus",value:function(e){e||this.statusElement.setAttribute("style",h.i.aclControlBoxStatusRevealed),this.statusElement.innerText=e}},{key:"addAcls",value:(o=(0,r.A)(s().mark(function e(){var t,n,r,i=this;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.defaultHolder&&this.defaultACLDoc){e.next=1;break}return t="Unable to find defaults to copy",f.z3(t),e.abrupt("return",Promise.reject(t));case 1:return(0,c._E)(this.targetDoc,this.targetACLDoc,this.defaultHolder,this.defaultACLDoc).statements.forEach(function(e){return i.store.add(e.subject,e.predicate,e.object,i.targetACLDoc)}),e.prev=2,e.next=3,this.store.fetcher.putBack(this.targetACLDoc);case 3:return this.isUsingDefaults=!1,e.abrupt("return",Promise.resolve());case 4:return e.prev=4,r=e.catch(2),n=" Error writing back access control file! ".concat(r),f.z3(n),e.abrupt("return",Promise.reject(n));case 5:case"end":return e.stop()}},e,this,[[2,4]])})),function(){return o.apply(this,arguments)})},{key:"addDefaults",value:(n=(0,r.A)(s().mark(function e(){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.defaultsCombo=new u.h(this.targetDoc,this.targetACLDoc,this,this.store,{defaults:!0}),this.defaultsDiffer=!0;case 1:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"removeAcls",value:(t=(0,r.A)(s().mark(function e(){var t,n,r;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,this.store.fetcher.delete(this.targetACLDoc.uri,{});case 1:return this.isUsingDefaults=!0,e.prev=2,e.next=3,(0,c.L$)(this.targetDoc.uri);case 3:this.prospectiveDefaultHolder=e.sent,e.next=5;break;case 4:e.prev=4,n=e.catch(2),f.R8(n);case 5:e.next=7;break;case 6:return e.prev=6,r=e.catch(0),t="Error deleting access control file: ".concat(this.targetACLDoc,": ").concat(r),f.z3(t),e.abrupt("return",Promise.reject(t));case 7:case"end":return e.stop()}},e,this,[[0,6],[2,4]])})),function(){return t.apply(this,arguments)})},{key:"removeDefaults",value:(e=(0,r.A)(s().mark(function e(){var t,n;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.defaultsCombo,e.prev=1,this.defaultsCombo=null,this.defaultsDiffer=!1,e.next=2,this.save();case 2:e.next=4;break;case 3:return e.prev=3,n=e.catch(1),this.defaultsCombo=t,this.defaultsDiffer=!0,f.z3(n),e.abrupt("return",Promise.reject(n));case 4:case"end":return e.stop()}},e,this,[[1,3]])})),function(){return e.apply(this,arguments)})},{key:"save",value:function(){var e=this,t=(0,l.graph)();this.isContainer?this.defaultsCombo&&this.defaultsDiffer?((0,c.cl)(t,this.targetDoc,this.mainCombo.byCombo,this.targetACLDoc,!0),(0,c.cl)(t,this.targetDoc,this.defaultsCombo.byCombo,this.targetACLDoc,!1,!0)):(0,c.cl)(t,this.targetDoc,this.mainCombo.byCombo,this.targetACLDoc,!0,!0):(0,c.cl)(t,this.targetDoc,this.mainCombo.byCombo,this.targetACLDoc,!0),t.fetcher=(0,l.fetcher)(t,{fetch:this.store.fetcher._fetch});var n=t.updater||new l.UpdateManager(t);return new Promise(function(r,i){n.put(e.targetACLDoc,t.statementsMatching(void 0,void 0,void 0,e.targetACLDoc),"text/turtle",function(n,a,o){if(!a)return i(new Error("ACL file save failed: ".concat(o)));e.store.fetcher.unload(e.targetACLDoc),e.store.add(t.statements),e.store.fetcher.requested[e.targetACLDoc.uri]="done",e.mainCombo.store=e.store,e.defaultsCombo&&(e.defaultsCombo.store=e.store),e.defaultsDiffer=!!e.defaultsCombo&&!(0,c.P3)(e.mainCombo.aclMap,e.defaultsCombo.aclMap),f.Rm("ACL modification: success!"),r()})})}}]);var e,t,n,o}()},6562(e,t,n){function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{A:()=>r})},6564(e,t,n){n.d(t,{Nr:()=>f,PM:()=>g,WG:()=>m,bk:()=>h});var r=n(4961),i=n(5175),a=n(1795),o=n(675),s=n(4762),c=n(9612),l=n(3468),u=n(9086),d=n(588),p=i.hV.store;function f(e,t,n,r,i){n.style.display="flex",n.style.flexDirection="row";var c=n.appendChild(e.createElement("div"));c.style.width=s.A.formFieldNameBoxWidth;var u=n.appendChild(e.createElement("div"));return c.setAttribute("class","formFieldName"),c.setAttribute("style",o.i.formFieldNameBoxStyle),u.setAttribute("class","formFieldValue"),i?c.appendChild(e.createTextNode(i)):t.any(r,a.A.ui("property"))?c.appendChild(h(e,t.any(r,a.A.ui("property")),r)):(u.appendChild((0,l.F)(e,"No property or label given for form field: "+r)),c.appendChild(e.createTextNode("???"))),u}function h(e,t,n){var r=p.any(n,a.A.ui("label"));if(r||(r=(0,c.P)(t,!0)),void 0===t)return e.createTextNode("@@Internal error: undefined property");var i=e.createElement("a");return t.uri&&i.setAttribute("href",t.uri),i.setAttribute("style","color: #3B5998; text-decoration: none;"),i.textContent=r,i}function m(e,t,n){var r=p.statementsMatching(e,t);if(0===r.length)return n;if(!p.updater)throw new Error("Store has no updater");return r.length>0&&r[0].why.value&&p.updater.editable(r[0].why.value,p)?p.sym(r[0].why.value):n}function g(e,t,n,i,c,h,g){var v=p,y=c.doc?c.doc():null,w=e.createElement("div"),b=v.any(c,a.A.ui("property"));if(t&&t.appendChild(w),!b)return w.appendChild((0,l.F)(e,"Error: No property given for text field: "+c));var A=f(e,v,w,c),x=v.anyJS(c,a.A.ui("suppressEmptyUneditable"),null,y),E=(0,u.K)(c),C=d.t[E];void 0===C&&(C={style:""});var k=C.style||"",_=o.i.textInputStyle+k,S=e.createElement("input");S.style=_,A.appendChild(S),S.setAttribute("type",C.type?C.type:"text");var T=v.anyJS(c,a.A.ui("size"))||s.A.textInputSize||20;S.setAttribute("size",T);var R=v.any(c,a.A.ui("maxLength"));S.setAttribute("maxLength",R?""+R:s.A.basicMaxLength),h=h||m(i,b,h);var L=v.any(i,b,void 0,h);if(L||(L=v.any(c,a.A.ui("default"))),L&&L.value&&C.uriPrefix?S.value=decodeURIComponent(L.value.replace(C.uriPrefix,"")).replace(/ /g,""):L&&(S.value=L.value||L.value||""),S.setAttribute("style",_),!v.updater)throw new Error("kb has no updater");return v.updater.editable(h.uri)?(S.addEventListener("keyup",function(e){C.pattern&&S.setAttribute("style",_+(S.value.match(C.pattern)?"color: green;":"color: red;"))},!0),S.addEventListener("change",function(t){if(!C.pattern||S.value.match(C.pattern)){S.disabled=!0,S.setAttribute("style",_+"color: gray;");var n,o=v.statementsMatching(i,b);C.namedNode?n=v.sym(S.value):C.uriPrefix?(n=encodeURIComponent(S.value.replace(/ /g,"")),n=v.sym(C.uriPrefix+S.value)):n=C.dt?new r.Literal(S.value.trim(),void 0,a.A.xsd(C.dt)):new r.Literal(S.value);var s=o.map(function(e){return(0,r.st)(e.subject,e.predicate,n,e.why)});0===s.length&&(s=[(0,r.st)(i,b,n,h)]),function e(t,n,r){var i=[];if(n.forEach(function(e){i.includes(e.why.uri)||i.push(e.why.uri)}),t.forEach(function(e){i.includes(e.why.uri)||i.push(e.why.uri)}),0===i.length)throw new Error("updateMany has no docs to patch");if(!v.updater)throw new Error("kb has no updater");if(1===i.length)return v.updater.update(t,n,r);var a=i.pop(),o=n.filter(function(e){return e.why.uri===a}),s=n.filter(function(e){return e.why.uri!==a}),c=t.filter(function(e){return e.why.uri===a}),l=t.filter(function(e){return e.why.uri!==a});v.updater.update(c,o,function(t,n,i){n?e(l,s,r):r(t,n,i)})}(o,s,function(t,n,r){n?(S.disabled=!1,S.setAttribute("style",_)):w.appendChild((0,l.F)(e,r)),g(n,r)})}},!0),w):(S.readOnly=!0,S.style=o.i.textInputStyleUneditable+k,x&&""===S.value&&(w.style.display="none"),w)}},6589(e,t,n){n.d(t,{v:()=>r});var r={newThingUI:n(8613).T}},6670(e,t,n){n.r(t),n.d(t,{TabWidgetElement:()=>g,tabWidget:()=>v});var r=n(3453),i=n(2901),a=n(3029),o=n(6822),s=n(3954),c=n(5501),l=n(5579),u=n(3291),d=n(9612),p=n(675),f=n(5175);function h(e,t,n){return t=(0,s.A)(t),(0,o.A)(e,m()?Reflect.construct(t,n||[],(0,s.A)(e).constructor):t.apply(e,n))}function m(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(m=function(){return!!e})()}var g=function(e){function t(){return(0,a.A)(this,t),h(this,t,arguments)}return(0,c.A)(t,e),(0,i.A)(t)}((0,l.A)(HTMLElement));function v(e){var t=e.subject,n=e.dom||document,i=parseInt(e.orientation||"0"),a=e.backgroundColor||"#ddddcc",o=2&i,s=1&i,c=e.onClose,l=function(e){return function(e){for(var t=0,n=0;n<3;n++)t+=parseInt(e.slice(2*n+1,2*n+3),16);return t>384}(e)?[y(e,"#ffffff",.3),"#000000"]:[y(e,"#000000",.3),"#ffffff"]}(a),h=(0,r.A)(l,2),m=h[0],g=h[1],v="flex: 2; width: auto; height: 100%; border: 0.1em; border-style: solid; border-color: ".concat(m,"; padding: 1em;"),w=n.createElement("div");w.setAttribute("style",p.i.tabsRootElement),w.style.flexDirection=(s?"row":"column")+(o?"-reverse":"");var b=w.appendChild(n.createElement("nav"));b.setAttribute("style",p.i.tabsNavElement);var A=w.appendChild(n.createElement("main"));A.setAttribute("style",p.i.tabsMainElement);var x=b.appendChild(n.createElement("ul"));x.setAttribute("style",p.i.tabContainer),x.style.flexDirection="".concat(s?"column":"row");var E=A;w.tabContainer=x,w.bodyContainer=E;var C=["0.2em","0.2em","0","0"],k=C.concat(C).slice(i,i+4),_="border-radius: ".concat(k.join(" "),";"),S=["0.3em","0.3em","0","0.3em"],T=S.concat(S).slice(i,i+4),R="margin: ".concat(T.join(" "),";"),L="padding: ".concat(T.join(" "),";"),I=_+"position: relative; padding: 0.7em; max-width: 20em; color: ".concat(g,";"),P="".concat(I+R," opacity: 50%; background-color: ").concat(a,";"),N="".concat(I+R," background-color: ").concat(m,";"),O="height: 100%; width: 100%;",M=O+"display: none;";if(w.refresh=H,H(),!e.startEmpty&&x.children.length&&e.selectedTab){var B=Array.from(x.children).map(function(e){return e.firstChild}).find(function(t){return t.dataset.name===e.selectedTab}),D=e.selectedTab.uri,U=Array.from(x.children).find(function(e){return e.subject&&e.subject.uri&&e.subject.uri===D}),F=(U||B||x.children[0]).firstChild;F&&F.click()}else e.startEmpty||x.children[0].firstChild.click();return w;function j(t){var r=n.createElement("li");r.setAttribute("style",P),r.subject=t;var i=r.appendChild(n.createElement("button"));if(i.setAttribute("style",p.i.makeNewSlot),i.onclick=function(){if(W(),V(),r.setAttribute("style",N),r.bodyTR){r.bodyTR.setAttribute("style",O);var n=o(r);e.renderMain&&r.subject&&!1!==n.asSettings&&(n.innerHTML="loading item ..."+t,e.renderMain(n,r.subject),n.asSettings=!1)}},e.renderTabSettings&&r.subject){var a=n.createElement("button");a.textContent="...",a.setAttribute("style",p.i.ellipsis),a.onclick=function(){if(W(),V(),r.setAttribute("style",N),r.bodyTR){r.bodyTR.setAttribute("style",O);var n=o(r);e.renderTabSettings&&r.subject&&!0!==n.asSettings&&(n.innerHTML="loading settings ..."+t,e.renderTabSettings(n,r.subject),n.asSettings=!0)}},r.appendChild(a)}return e.renderTab?e.renderTab(i,t):i.innerHTML=(0,d.P)(t),r;function o(e){var t,r=null===(t=e.bodyTR)||void 0===t?void 0:t.children[0];if(r)return r;var i=e.bodyTR.appendChild(n.createElement("main"));return i.setAttribute("style",v),i}}function H(){var r,i,a,o,s,l=e.items?e.items:!1!==e.ordered?f.M_.the(t,e.predicate).elements:f.M_.each(t,e.predicate),d=!1;for(o=0;o<x.children.length;o++)if(r=x.children[o],o>=l.length||r.subject&&!r.subject.sameTerm(l[o])){d=!0;break}if(d||l.length!==x.children.length){for(s=x.children.length-1;s>=0&&(r=x.children[s],a=s-x.children.length+l.length,!r.subject||r.subject.sameTerm(l[a]));s--);for(var p=l.slice(o,s-x.children.length+l.length+1);s>=o;)x.removeChild(x.children[o]),E.removeChild(E.children[o]),s-=1;for(i=0;i<p.length;i++){var h=j(p[i]),m=n.createElement("div");h.bodyTR=m,o===x.children.length?(x.appendChild(h),E.appendChild(m)):(x.insertBefore(h,x.children[o+i]),E.insertBefore(m,E.children[o+i]))}c&&function(e){if(e.dataset.onCloseSet){var t=e.querySelector(".unstyled");e.removeChild(t)}var r=n.createElement("li");r.classList.add("unstyled");var i=(0,u.x7)(n,c);i.setAttribute("style",i.getAttribute("style")+L),r.appendChild(i),e.appendChild(r),e.dataset.onCloseSet="true"}(x)}}function W(){for(var e=0;e<x.children.length;e++){var t=x.children[e];t.classList.contains("unstyled")||t.setAttribute("style",P)}}function V(){for(var e=0;e<E.children.length;e++)E.children[e].setAttribute("style",M)}}function y(e,t,n){for(var r,i,a="#",o="0123456789abcdef",s=0;s<3;s++){r=parseInt(e.slice(2*s+1,2*s+3),16),i=parseInt(t.slice(2*s+1,2*s+3),16);var c=parseInt((""+(r*(1-n)+i*n)).split(".")[0]),l=parseInt((""+c/16).split(".")[0]),u=parseInt((""+c%16).split(".")[0]);a+=o[l]+o[u]}return a}},6822(e,t,n){n.d(t,{A:()=>a});var r=n(2284),i=n(1798);function a(e,t){if(t&&("object"==(0,r.A)(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.A)(e)}},6855(e,t,n){n.d(t,{Tn:()=>y,lG:()=>g});var r=n(467),i=n(4756),a=n.n(i),o=n(7423),s=n(4329),c=n(4976),l=n(1795),u=n(5175),d=n(4961),p=n(8425),f=n(3907);function h(){return(0,c.My)(s.ko.utils.randomPrivateKey())}function m(e){return(0,c.My)(s.ko.getPublicKey(e))}function g(e){return v.apply(this,arguments)}function v(){return(v=(0,r.A)(a().mark(function e(t){var n,r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,u.M_.fetcher.load(t);case 1:return e.next=2,(0,p.AB)(t);case 2:return n=e.sent,e.prev=3,e.next=4,u.M_.fetcher.load(n);case 4:return r=u.M_.any(t,l.A.solid("publicKey")),e.abrupt("return",null==r?void 0:r.value);case 5:return e.prev=5,e.catch(3),e.abrupt("return",void 0);case 6:case"end":return e.stop()}},e,null,[[3,5]])}))).apply(this,arguments)}function y(e){return w.apply(this,arguments)}function w(){return(w=(0,r.A)(a().mark(function e(t){var n,r,i,s,c,g,v,y,w;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,u.M_.fetcher.load(t);case 1:return e.next=2,(0,p.AB)(t);case 2:return n=e.sent,e.next=3,(0,p.ED)(t);case 3:return r=e.sent,e.next=4,(0,p.S3)(t,n);case 4:return i=e.sent,e.next=5,(0,p.cX)(t,r);case 5:if(s=e.sent,c=!0,s&&i!==m(s)&&confirm("This is strange the publicKey is not valid for\n"+(null==t?void 0:t.uri)+"'shall we repair keeping the private key ?")&&(c=!1),s&&i&&c){e.next=8;break}if(g=[],v=[],s){e.next=6;break}return s=h(),v=[d.st(t,l.A.solid("privateKey"),d.literal(s),u.M_.sym(r))],e.next=6,A(r,[],v,t.uri);case 6:if(i&&c){e.next=7;break}return g=[],i&&(g=[d.st(t,l.A.solid("publicKey"),d.lit(i),u.M_.sym(n))],o.Rm("delete invalid publicKey "+g)),y=m(s),v=[d.st(t,l.A.solid("publicKey"),d.literal(y),u.M_.sym(n))],e.next=7,A(n,g,v);case 7:return w=r.substring(0,r.lastIndexOf("/")+1),e.next=8,(0,f.lO)(w,(0,f.vb)(t.uri));case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var b=function(){var e=(0,r.A)(a().mark(function e(t){var n,r,i;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,u.M_.fetcher.load(t);case 1:if(!(n=u.M_.any(u.M_.sym(t),u.M_.sym("http://www.iana.org/assignments/link-relations/acl")))){e.next=6;break}return e.prev=2,e.next=3,u.M_.fetcher.webOperation("DELETE",n.value);case 3:r=e.sent,o.Rm("delete keyAcl"+n.value+" "+r.status),e.next=6;break;case 4:if(e.prev=4,404===(i=e.catch(2)).response.status){e.next=5;break}throw new Error(i);case 5:o.Rm("delete keyAcl"+n.value+" "+i.response.status);case 6:case"end":return e.stop()}},e,null,[[2,4]])}));return function(t){return e.apply(this,arguments)}}();function A(e,t,n){return x.apply(this,arguments)}function x(){return x=(0,r.A)(a().mark(function e(t,n,r){var i,o,s=arguments;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>3&&void 0!==s[3]?s[3]:"",e.next=1,b(t);case 1:return e.next=2,u.M_.updater.updateMany(n,r);case 2:return o=(0,f.G2)(t,i),e.next=3,(0,f.lO)(t,o);case 3:case"end":return e.stop()}},e)})),x.apply(this,arguments)}},6984(e,t,n){let r;n.d(t,{A:()=>a});const i=new Uint8Array(16);function a(){if(!r){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");r=crypto.getRandomValues.bind(crypto)}return r(i)}},6986(e,t,n){function r(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a,o,s=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(e){l=!0,i=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw i}}return s}}n.d(t,{A:()=>r})},6993(e,t,n){var r=n(5546);function i(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var t,n,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.toStringTag||"@@toStringTag";function c(e,i,a,o){var s=i&&i.prototype instanceof u?i:u,c=Object.create(s.prototype);return r(c,"_invoke",function(e,r,i){var a,o,s,c=0,u=i||[],d=!1,p={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(e,n){return a=e,o=0,s=t,p.n=n,l}};function f(e,r){for(o=e,s=r,n=0;!d&&c&&!i&&n<u.length;n++){var i,a=u[n],f=p.p,h=a[2];e>3?(i=h===r)&&(s=a[(o=a[4])?5:(o=3,3)],a[4]=a[5]=t):a[0]<=f&&((i=e<2&&f<a[1])?(o=0,p.v=r,p.n=a[1]):f<h&&(i=e<3||a[0]>r||r>h)&&(a[4]=e,a[5]=r,p.n=h,o=0))}if(i||e>1)return l;throw d=!0,r}return function(i,u,h){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&f(u,h),o=u,s=h;(n=o<2?t:s)||!d;){a||(o?o<3?(o>1&&(p.n=-1),f(o,s)):p.n=s:p.v=s);try{if(c=2,a){if(o||(i="next"),n=a[i]){if(!(n=n.call(a,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,o<2&&(o=0)}else 1===o&&(n=a.return)&&n.call(a),o<2&&(s=TypeError("The iterator does not provide a '"+i+"' method"),o=1);a=t}else if((n=(d=p.n<0)?s:e.call(r,p))!==l)break}catch(e){a=t,o=1,s=e}finally{c=1}}return{value:n,done:d}}}(e,a,o),!0),c}var l={};function u(){}function d(){}function p(){}n=Object.getPrototypeOf;var f=[][o]?n(n([][o]())):(r(n={},o,function(){return this}),n),h=p.prototype=u.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,r(e,s,"GeneratorFunction")),e.prototype=Object.create(h),e}return d.prototype=p,r(h,"constructor",p),r(p,"constructor",d),d.displayName="GeneratorFunction",r(p,s,"GeneratorFunction"),r(h),r(h,s,"Generator"),r(h,o,function(){return this}),r(h,"toString",function(){return"[object Generator]"}),(e.exports=i=function(){return{w:c,m}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},7008(e,t,n){n.d(t,{V:()=>p,Y:()=>f});var r=n(467),i=n(4756),a=n.n(i),o=n(7423),s=n(3378),c=n(675),l=n(3291),u=s.Pt.iconBase+"noun_Camera_1618446_000000.svg",d=s.Pt.iconBase+"noun_479395.svg";function p(e,t,n,r){var i,a,u,p,f=e.createElement("div"),h=f.appendChild(e.createElement("table")),m=h.appendChild(e.createElement("tr")).appendChild(e.createElement("td"));m.setAttribute("colspan","4");var g=h.appendChild(e.createElement("tr"));g.appendChild(e.createElement("td")).appendChild(l.x7(e)).addEventListener("click",function(e){x(),r(null)});var v=g.appendChild(e.createElement("td")).appendChild(l.x6(e,d,"Retake"));v.addEventListener("click",function(e){m.removeChild(p),b()}),v.style.visibility="collapse";var y=g.appendChild(e.createElement("td")).appendChild(l.x6(e,s.Pt.iconBase+"noun_10636.svg","Snap"));y.addEventListener("click",function(){(p=e.createElement("canvas")).setAttribute("width",c.i.canvasWidth),p.setAttribute("height",c.i.canvasHeight),p.setAttribute("style",c.i.controlStyle),m.appendChild(p),p.getContext("2d").drawImage(u,0,0,p.width,p.height),u.parentNode.removeChild(u),p.toBlob(function(e){var t="got blob type ".concat(e.type," size ").concat(e.size);o.Rm(t),i=n(),a=e,w.style.visibility="visible",v.style.visibility="visible",y.style.visibility="collapse"},"image/png")}),y.style.visibility="collapse";var w=g.appendChild(e.createElement("td")).appendChild(l.kz(e));function b(){if((u=m.appendChild(e.createElement("video"))).setAttribute("controls","1"),u.setAttribute("autoplay","1"),u.setAttribute("style",c.i.controlStyle),!navigator.mediaDevices)throw new Error("navigator.mediaDevices not available");navigator.mediaDevices.getUserMedia(A).then(function(e){u.srcObject=e,y.style.visibility="visible",w.style.visibility="collapse",v.style.visibility="collapse"})}w.addEventListener("click",function(e){!function(e,n){var i=e.type;o.Rm("Putting "+e.size+" bytes of "+i+" to "+n),t.fetcher.webOperation("PUT",n.uri,{data:e,contentType:i}).then(function(e){o.Rm("ok saved "+n),x(),r(n)},function(e){x(),alert(e)})}(a,i)}),w.style.visibility="collapse";var A={video:!0};function x(){u&&u.srcObject&&u.srcObject.getVideoTracks().forEach(function(e){return e.stop()})}return b(),f}function f(e,t,n,i){var o,s=e.createElement("div"),c=l.x6(e,u,"Take picture");function d(e){return f.apply(this,arguments)}function f(){return(f=(0,r.A)(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s.removeChild(o),s.appendChild(c),i(t);case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}return s.appendChild(c),c.addEventListener("click",function(r){s.removeChild(c),o=p(e,t,n,d),s.appendChild(o)}),s}},7134(e,t,n){n.d(t,{Ux:()=>l});var r=n(467),i=n(4756),a=n.n(i),o=n(5175),s=n(675),c=n(8565);function l(e,t){return u.apply(this,arguments)}function u(){return(u=(0,r.A)(a().mark(function e(t,n){var r,i,s;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=document.getElementById("PageFooter")){e.next=1;break}return e.abrupt("return");case 1:return i=(0,c.E6)(),e.next=2,(0,c.bB)(i,t);case 2:s=e.sent,d(r,t,i,s,n)(),o.lG.events.on("login",d(r,t,i,s,n)),o.lG.events.on("logout",d(r,t,i,s,n));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function d(e,t,n,i,s){return(0,r.A)(a().mark(function r(){var c,l;return a().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return c=o.jO.currentUser(),e.innerHTML="",l=e,r.next=1,p(t,c,n,i,s);case 1:l.appendChild.call(l,r.sent);case 2:case"end":return r.stop()}},r)}))}function p(e,t,n,r,i){var a=document.createElement("div");if(!n||!r||t&&t.equals(r))return a;a.setAttribute("style",s.i.footer);var o=document.createElement("span");o.innerText="You're visiting ";var l=document.createElement("a");l.href=n.uri,l.innerText="the Pod";var u=document.createElement("span");u.innerText=" controlled by ";var d=document.createElement("a");d.href=r.uri,d.innerText=(0,c.mG)(e,r);var p=document.createElement("span");p.innerText=". For more info, check out ";var f=document.createElement("a");f.href=i&&i.solidProjectUrl?i.solidProjectUrl:"https://solidproject.org",f.innerText=i&&i.solidProjectName?i.solidProjectName:"solidproject.org";var h=document.createElement("span");return h.innerText=".",a.appendChild(o),a.appendChild(l),a.appendChild(u),a.appendChild(d),a.appendChild(p),a.appendChild(f),a.appendChild(h),a}},7236(e,t,n){n.d(t,{eD:()=>R,z6:()=>E});var r=n(467),i=n(4756),a=n.n(i),o=n(7423),s=n(3378),c=n(6127),l=n(1795),u=n(8153),d=n(4961),p=n(675),f=n(52),h=n(9612),m=n(4608),g=n(5175),v=n(967),y={icons:s.Pt,ns:l.A,media:c.$,pad:u,style:p.i,utils:f,widgets:m},w=d.Namespace("http://www.w3.org/2002/01/bookmark#"),b=h.P,A=window.document||null;function x(e,t){return new Promise(function(n,r){g.M_.updater.update(e,t,function(e,t,i){t?n():r(new Error(i))})})}function E(e){return C.apply(this,arguments)}function C(){return(C=(0,r.A)(a().mark(function e(t){var n,r,i,s;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=w("Bookmark"),r="bookmarks.ttl",e.next=1,(0,v.findAppInstances)(t,n,true);case 1:if(!(t.instances&&t.instances.length>0)){e.next=2;break}t.bookmarkDocument=t.instances[0],t.instances.length>1&&o.R8("More than one bookmark file! "+t.instances),e.next=9;break;case 2:if(!t.publicProfile){e.next=8;break}return i=d.sym(t.publicProfile.dir().uri+r),e.prev=3,o.Rm("Creating new bookmark file "+i),e.next=4,g.M_.fetcher.createIfNotExists(i);case 4:e.next=6;break;case 5:return e.prev=5,s=e.catch(3),o.R8("Can't make fresh bookmark file:"+s),e.abrupt("return",t);case 6:return e.next=7,g.T4.registerInTypeIndex(i,t.index,n);case 7:t.bookmarkDocument=i,e.next=9;break;case 8:o.R8("You seem to have no bookmark file, nor even a profile file!");case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}},e,null,[[3,5]])}))).apply(this,arguments)}function k(e,t){return _.apply(this,arguments)}function _(){return(_=(0,r.A)(a().mark(function e(t,n){var r,i,s,c,u,p,f,h;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r="",i=g.jO.currentUser()){e.next=1;break}throw new Error("Must be logged on to add Bookmark");case 1:return s=g.M_.any(n,l.A.foaf("maker")),r=b(s)+": "+g.M_.anyValue(n,l.A.sioc("content")).slice(0,80),c=t.bookmarkDocument,u=y.widgets.newThing(c,r),p=[d.st(c,y.ns.dct("references"),u,c),d.st(u,y.ns.rdf("type"),w("Bookmark"),c),d.st(u,y.ns.dct("created"),new Date,c),d.st(u,w("recalls"),n,c),d.st(u,y.ns.foaf("maker"),i,c),d.st(u,y.ns.dct("title"),r,c)],e.prev=2,e.next=3,x([],p);case 3:e.next=5;break;case 4:return e.prev=4,h=e.catch(2),f="Making bookmark: "+h,o.R8(f),e.abrupt("return",null);case 5:return e.abrupt("return",u);case 6:case"end":return e.stop()}},e,null,[[2,4]])}))).apply(this,arguments)}function S(e,t,n){return T.apply(this,arguments)}function T(){return(T=(0,r.A)(a().mark(function e(t,n,r){var i,s,c,l;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,g.M_.fetcher.load(t.bookmarkDocument);case 1:if(!(i=g.M_.each(null,w("recalls"),n,t.bookmarkDocument)).length){e.next=9;break}if(confirm("Delete bookmark on this?"+i.length)){e.next=2;break}return e.abrupt("return");case 2:s=0;case 3:if(!(s<i.length)){e.next=8;break}return e.prev=4,e.next=5,x(g.M_.connectedStatements(i[s]),[]);case 5:r.style.backgroundColor="white",o.Rm("Bookmark deleted: "+i[s]),e.next=7;break;case 6:e.prev=6,l=e.catch(4),o.z3("Cant delete bookmark:"+l),o.R8("Cannot delete bookmark:"+l);case 7:s++,e.next=3;break;case 8:e.next=11;break;case 9:return e.next=10,k(t,n);case 10:c=e.sent,r.style.backgroundColor="yellow",o.Rm("Bookmark added: "+c);case 11:case"end":return e.stop()}},e,null,[[4,6]])}))).apply(this,arguments)}function R(e,t){return L.apply(this,arguments)}function L(){return L=(0,r.A)(a().mark(function e(t,n){var i,o,s;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=function(){return o=(0,r.A)(a().mark(function e(n){var r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,g.M_.fetcher.load(t.bookmarkDocument);case 1:r=g.M_.any(null,w("recalls"),n.target,t.bookmarkDocument),n.style=y.style.buttonStyle,r&&(n.style.backgroundColor="yellow");case 2:case"end":return e.stop()}},e)})),o.apply(this,arguments)},i=function(e){return o.apply(this,arguments)},!t.bookmarkDocument){e.next=2;break}return(s=y.widgets.button(A,y.icons.iconBase+"noun_45961.svg",b(w("Bookmark")),function(){S(t,n,s)})).target=n,e.next=1,i(s);case 1:return e.abrupt("return",s);case 2:case"end":return e.stop()}},e)})),L.apply(this,arguments)}},7333(e,t,n){n.d(t,{s:()=>i});var r=n(6316);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function i(e,t){const n=t=>(0,r.x3)({...e,hash:t});return{...n(t),create:n}}},7367(e,t,n){n.d(t,{DR:()=>v,Fp:()=>h,wR:()=>y});var r=n(467),i=n(4756),a=n.n(i),o=n(1795),s=n(9612),c=n(5619),l=n(6466),u=n(675),d=n(7423),p=window,f=Symbol("prevent double triggering of drop event");function h(e){if((0,d.Rm)("preventBrowserDropEvents called."),void 0!==p){if(p[f])return;p[f]=!0}e.addEventListener("drop",g,!1),e.addEventListener("dragenter",m,!1),e.addEventListener("dragover",m,!1)}function m(e){e.stopPropagation(),e.preventDefault()}function g(e){e.dataTransfer.files.length>0&&(p.confirm("Are you sure you want to drop this file here? (Cancel opens it in a new tab)")||(e.stopPropagation(),e.preventDefault(),(0,d.Rm)("@@@@ document-level DROP suppressed: "+e.dataTransfer.dropEffect)))}function v(e){var t=e.uri;"/"===t.slice(-1)&&(t=t.slice(0,-1));var n=t.lastIndexOf("/");return n>=0&&(t=t.slice(n+1)),t||"/"}function y(e,t,n,r){var i=t.dom,a=e.doc(),o=i.createElement("div");o.setAttribute("style",u.i.aclControlBoxContainer);var c=o.appendChild(i.createElement("h1"));c.textContent="Sharing for ".concat(n," ").concat(s.P(e)),c.setAttribute("style",u.i.aclControlBoxHeader);var l=o.appendChild(i.createElement("div"));l.setAttribute("style",u.i.aclControlBoxStatus);try{(function(e,t,n,r,i,a,o){return w.apply(this,arguments)})(a,r,e,n,t,i,l).then(function(e){return o.appendChild(e.render())})}catch(e){l.innerText=e}return o}function w(){return w=(0,r.A)(a().mark(function e(t,n,i,o,s,u,p){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,f){return(0,c.VM)(t,function(){var t=(0,r.A)(a().mark(function t(r,h,m,g,v,y){var w,E,C,k,_;return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(k=function(e){return new l.v(i,o,s,p,E,m,g,v,y,e,n,u)},r){t.next=1;break}return t.abrupt("return",f(new Error("Error reading ".concat(h?"":" default ","ACL. status ").concat(m,": ").concat(g))));case 1:if(w=b(m),(E=A(m,g,n)||x(m))||!w){t.next=5;break}return t.prev=2,t.next=3,(0,c.L$)(w);case 3:return C=t.sent,t.abrupt("return",e(k(C)));case 4:t.prev=4,_=t.catch(2),(0,d.R8)(_);case 5:return t.abrupt("return",e(k()));case 6:case"end":return t.stop()}},t,null,[[2,4]])}));return function(e,n,r,i,a,o){return t.apply(this,arguments)}}())}));case 1:case"end":return e.stop()}},e)})),w.apply(this,arguments)}function b(e){var t=e.uri.split("#")[0],n=t.slice(0,-1).lastIndexOf("/"),r=t.indexOf("//");return r>=0&&n<r+2||n<0?null:t.slice(0,n+1)}function A(e,t,n){return n.holds(e,o.A.rdf("type"),o.A.space("Storage"),t)}function x(e){return e.uri===e.site().uri}},7423(e,t,n){function r(){var e;(e=console).log.apply(e,arguments)}function i(){var e;(e=console).warn.apply(e,arguments)}function a(){var e;(e=console).error.apply(e,arguments)}function o(){var e;(e=console).trace.apply(e,arguments)}n.d(t,{R8:()=>i,Rm:()=>r,uP:()=>o,z3:()=>a})},7528(e,t,n){function r(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}n.d(t,{A:()=>r})},7580(e,t,n){n.d(t,{U:()=>r});var r={matrixForQuery:n(7659).p}},7659(e,t,n){n.d(t,{p:()=>o});var r=n(9612),i=n(4961),a=n(5175).hV.store;function o(e,t,n,o,s,c,l){var u=e.createElement("table"),d=e.createElement("tr");d.appendChild(e.createElement("td")).setAttribute("class","MatrixCorner"),u.appendChild(d),u.lastHeader=d;var p=[],f=[],h=function(e,t,n,i){for(;e.firstChild;)e.removeChild(e.firstChild);e.setAttribute("style",""),e.style.textAlign="center",c.cellFunction?c.cellFunction(e,t,n,i):(e.textContent=r.P(i),e.setAttribute("style","padding: 0.3em")),delete e.old},m=function(t){var n=t.toNT();if(f[n])return f[n];var o=e.createElement("tr"),s=o.appendChild(e.createElement("td"));s.setAttribute("style","padding: 0.3em;"),s.textContent=r.P(t),"NamedNode"===t.termType&&a.fetcher.nowOrWhenFetched(t.uri.split("#")[0],void 0,function(e,n,i){e&&(s.textContent=r.P(t))});for(var l=0;l<p.length;l++)h(o.appendChild(e.createElement("td")),i.fromNT(p[l]),t,null);o.dataValueNT=n,f[n]=o;for(var d=u.lastHeader.nextSibling;d;d=d.nextSibling)if(n>d.dataValueNT&&c&&c.yDecreasing||n<d.dataValueNT&&(!c||!c.yDecreasing))return u.insertBefore(o,d);return u.appendChild(o)},g=function(t){for(var n=t.toNT(),a=null,o=0;o<p.length;o++){if(p[o]===n)return o;if(n>p[o]&&c.xDecreasing||n<p[o]&&!c.xDecreasing){p=p.slice(0,o).concat([n]).concat(p.slice(o)),a=o;break}}null===a&&(a=p.length,p.push(n));for(var s=u.firstChild;s;s=s.nextSibling){var l=s.dataValueNT,d=e.createElement("td");if(d.style.textAlign="center",s===u.firstChild?d.textContent=r.P(t):h(d,t,i.fromNT(l),null),a===p.length-1)s.appendChild(d);else{for(var f=s.firstChild,m=0;m<a+1;m++)f=f.nextSibling;s.insertBefore(d,f)}}return a},v=function(){var e,t,n=[],r=[];if(c.set_y)for(var a=0;a<c.set_y.length;a++)r[c.set_y[a]]=!0;if(c.set_x)for(var o=0;o<c.set_x.length;o++)n[g(c.set_x[o])+1]=!0;for(var s=1;s<u.children.length;s++){e=u.children[s];for(var l=1;l<e.children.length;l++)if((t=e.children[l]).old){var d=i.fromNT(e.dataValueNT),m=i.fromNT(p[l-1]);h(t,m,d,null)}else r[e.dataValueNT]=!0,n[l]=!0}for(var v=0;v<u.children.length;v++)if(e=u.children[v],v>0&&!r[e.dataValueNT])delete f[e.dataValueNT],u.removeChild(e);else for(var y=e.children.length-1;y>0;y--){var w=e.children[y];n[y]||e.removeChild(w)}for(var b=[],A=0;A<p.length;A++)n[A+1]&&b.push(p[A]);p=b};u.refresh=function(){!function(){for(var e=1;e<u.children.length;e++)for(var t=u.children[e],n=1;n<t.children.length;n++)t.children[n].old=!0}(),a.query(t,y,void 0,v)};var y=function(e){var t=e[n.toString()],r=e[o.toString()],i=e[s.toString()],a=m(r),c=g(t),l=a.children[c+1];h(l,t,r,i)};if(c.set_y)for(var w=0;w<c.set_y.length;w++)m(c.set_y[w]);if(c.set_x)for(var b=0;b<c.set_x.length;b++)g(c.set_x[b]);return a.query(t,y,void 0,l),u}},7673(e,t,n){n.d(t,{c:()=>c});var r=n(1795),i=n(5175),a=n(588),o=n(9086),s="https://www.w3.org/ns/css#";function c(e,t){var n=(0,o.K)(t),c=a.t[n]||{},l=i.M_.any(t,r.A.ui("style"));l?"Literal"===l.termType?l&&e.setAttribute("style",l.value):i.M_.statementsMatching(l,null,null,t.doc()).forEach(function(t){if(t.predicate.uri&&t.predicate.uri.startsWith(s)){var n=t.predicate.uri.slice(26);try{e.style[n]=t.object.value}catch(r){console.warn("setFieldStyle: Error setting element style ".concat(n,' to "').concat(t.object.value,'"')),console.warn('setFieldStyle:   ... Element tagName was "'.concat(e.tagName||"???",'"'))}}}):c.style&&e.setAttribute("style",c.style)}},7800(e,t,n){n.d(t,{A:()=>i});var r=n(3145);function i(e,t){if(e){if("string"==typeof e)return(0,r.A)(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.A)(e,t):void 0}}},8030(e,t,n){n.d(t,{D0:()=>R,LH:()=>T,Tp:()=>I,jr:()=>C,pS:()=>_,qy:()=>P,zH:()=>g,zi:()=>m});var r=n(1848),i=n(4976);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const a=BigInt(0),o=BigInt(1),s=BigInt(2),c=BigInt(3),l=BigInt(4),u=BigInt(5),d=BigInt(7),p=BigInt(8),f=BigInt(9),h=BigInt(16);function m(e,t){const n=e%t;return n>=a?n:t+n}function g(e,t,n){let r=e;for(;t-- >a;)r*=r,r%=n;return r}function v(e,t){if(e===a)throw new Error("invert: expected non-zero number");if(t<=a)throw new Error("invert: expected positive modulus, got "+t);let n=m(e,t),r=t,i=a,s=o,c=o,l=a;for(;n!==a;){const e=r/n,t=r%n,a=i-c*e,o=s-l*e;r=n,n=t,i=c,s=l,c=a,l=o}if(r!==o)throw new Error("invert: does not exist");return m(i,t)}function y(e,t,n){if(!e.eql(e.sqr(t),n))throw new Error("Cannot find square root")}function w(e,t){const n=(e.ORDER+o)/l,r=e.pow(t,n);return y(e,r,t),r}function b(e,t){const n=(e.ORDER-u)/p,r=e.mul(t,s),i=e.pow(r,n),a=e.mul(t,i),o=e.mul(e.mul(a,s),i),c=e.mul(a,e.sub(o,e.ONE));return y(e,c,t),c}function A(e){if(e<c)throw new Error("sqrt is not defined for small field");let t=e-o,n=0;for(;t%s===a;)t/=s,n++;let r=s;const i=R(e);for(;1===S(i,r);)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===n)return w;let l=i.pow(r,t);const u=(t+o)/s;return function(e,r){if(e.is0(r))return r;if(1!==S(e,r))throw new Error("Cannot find square root");let i=n,a=e.mul(e.ONE,l),s=e.pow(r,t),c=e.pow(r,u);for(;!e.eql(s,e.ONE);){if(e.is0(s))return e.ZERO;let t=1,n=e.sqr(s);for(;!e.eql(n,e.ONE);)if(t++,n=e.sqr(n),t===i)throw new Error("Cannot find square root");const r=o<<BigInt(i-t-1),l=e.pow(a,r);i=t,a=e.sqr(l),s=e.mul(s,a),c=e.mul(c,l)}return c}}function x(e){return e%l===c?w:e%p===u?b:e%h===f?function(e){const t=R(e),n=A(e),r=n(t,t.neg(t.ONE)),i=n(t,r),a=n(t,t.neg(r)),o=(e+d)/h;return(e,t)=>{let n=e.pow(t,o),s=e.mul(n,r);const c=e.mul(n,i),l=e.mul(n,a),u=e.eql(e.sqr(s),t),d=e.eql(e.sqr(c),t);n=e.cmov(n,s,u),s=e.cmov(l,c,d);const p=e.eql(e.sqr(s),t),f=e.cmov(n,s,p);return y(e,f,t),f}}(e):A(e)}const E=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function C(e){const t=E.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"});return(0,r.DS)(e,t),e}function k(e,t,n){if(n<a)throw new Error("invalid exponent, negatives unsupported");if(n===a)return e.ONE;if(n===o)return t;let r=e.ONE,i=t;for(;n>a;)n&o&&(r=e.mul(r,i)),i=e.sqr(i),n>>=o;return r}function _(e,t,n=!1){const r=new Array(t.length).fill(n?e.ZERO:void 0),i=t.reduce((t,n,i)=>e.is0(n)?t:(r[i]=t,e.mul(t,n)),e.ONE),a=e.inv(i);return t.reduceRight((t,n,i)=>e.is0(n)?t:(r[i]=e.mul(t,r[i]),e.mul(t,n)),a),r}function S(e,t){const n=(e.ORDER-o)/s,r=e.pow(t,n),i=e.eql(r,e.ONE),a=e.eql(r,e.ZERO),c=e.eql(r,e.neg(e.ONE));if(!i&&!a&&!c)throw new Error("invalid Legendre symbol result");return i?1:a?0:-1}function T(e,t){void 0!==t&&(0,i.Fe)(t);const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function R(e,t,n=!1,i={}){if(e<=a)throw new Error("invalid field: expected ORDER > 0, got "+e);let s,c,l,u=!1;if("object"==typeof t&&null!=t){if(i.sqrt||n)throw new Error("cannot specify opts in two arguments");const e=t;e.BITS&&(s=e.BITS),e.sqrt&&(c=e.sqrt),"boolean"==typeof e.isLE&&(n=e.isLE),"boolean"==typeof e.modFromBytes&&(u=e.modFromBytes),l=e.allowedLengths}else"number"==typeof t&&(s=t),i.sqrt&&(c=i.sqrt);const{nBitLength:d,nByteLength:p}=T(e,s);if(p>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let f;const h=Object.freeze({ORDER:e,isLE:n,BITS:d,BYTES:p,MASK:(0,r.OG)(d),ZERO:a,ONE:o,allowedLengths:l,create:t=>m(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("invalid field element: expected bigint, got "+typeof t);return a<=t&&t<e},is0:e=>e===a,isValidNot0:e=>!h.is0(e)&&h.isValid(e),isOdd:e=>(e&o)===o,neg:t=>m(-t,e),eql:(e,t)=>e===t,sqr:t=>m(t*t,e),add:(t,n)=>m(t+n,e),sub:(t,n)=>m(t-n,e),mul:(t,n)=>m(t*n,e),pow:(e,t)=>k(h,e,t),div:(t,n)=>m(t*v(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>v(t,e),sqrt:c||(t=>(f||(f=x(e)),f(h,t))),toBytes:e=>n?(0,r.z)(e,p):(0,r.lq)(e,p),fromBytes:(t,i=!0)=>{if(l){if(!l.includes(t.length)||t.length>p)throw new Error("Field.fromBytes: expected "+l+" bytes, got "+t.length);const e=new Uint8Array(p);e.set(t,n?0:e.length-t.length),t=e}if(t.length!==p)throw new Error("Field.fromBytes: expected "+p+" bytes, got "+t.length);let a=n?(0,r.lX)(t):(0,r.Ph)(t);if(u&&(a=m(a,e)),!i&&!h.isValid(a))throw new Error("invalid field element: outside of range 0..ORDER");return a},invertBatch:e=>_(h,e),cmov:(e,t,n)=>n?t:e});return Object.freeze(h)}function L(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function I(e){const t=L(e);return t+Math.ceil(t/2)}function P(e,t,n=!1){const i=e.length,a=L(t),s=I(t);if(i<16||i<s||i>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+i);const c=m(n?(0,r.lX)(e):(0,r.Ph)(e),t-o)+o;return n?(0,r.z)(c,a):(0,r.lq)(c,a)}},8153(e,t,n){n.r(t),n.d(t,{getChunks:()=>g,lightColorHash:()=>h,manageParticipation:()=>d.manageParticipation,notepad:()=>m,notepadToHTML:()=>y,participationObject:()=>d.participationObject,recordParticipation:()=>d.recordParticipation,renderParticipants:()=>d.renderParticipants,xmlEncode:()=>v});var r=n(1795),i=n(4961),a=n(3468),o=n(1763),s=n(52),c=n(7423),l=n(5175),u=n(675),d=n(3605);var p=l.hV.store,f=(0,i.Namespace)("http://www.w3.org/ns/pim/pad#");function h(e){var t;return e&&e.uri?"#"+(16777215&(t=e.uri,t.split("").reduce(function(e,t){return(e=(e<<5)-e+t.charCodeAt(0))&e},0))|12632256).toString(16):"#ffffff"}function m(e,t,n,l,d){var f=(d=d||{}).exists,m=e.createElement("table"),g=p;if(l&&!l.uri)throw new Error("UI.pad.notepad:  Invalid userid");var v=p.updater,y=(0,i.Namespace)("http://www.w3.org/ns/pim/pad#");m.setAttribute("style",u.i.notepadStyle);var w=null,b=null;if(d.statusArea){var A=d.statusArea.appendChild(e.createElement("table")).appendChild(e.createElement("tr"));w=A.appendChild(e.createElement("td")),b=A.appendChild(e.createElement("td")),w&&w.setAttribute("style",u.i.upstreamStatus),b&&b.setAttribute("style",u.i.downstreamStatus)}var x=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,c.Rm)(t),d.statusArea&&(n?w:b).appendChild((0,a.F)(e,t,"pink"))},E=function(e){d.statusArea&&(d.statusArea.innerHTML="")},C=function(e,t,n){var i=e.subject;t=t||"";var a=u.i.baseStyle,o=u.i.headingCore,s=u.i.headingStyle,c=g.any(i,r.A.dc("author"));!t&&c&&(t="color: "+(n?"#888":"black")+"; background-color: "+h(c)+";");var l=g.any(i,y("indent")),d=(l=l?l.value:0)>=0?a+"text-indent: "+3*l+"em;":o+s[-1-l];e.setAttribute("style",d+t)},k=function(e){var r=e.subject;if(!r)throw new Error("No chunk for line to be deleted!");var a=g.any(void 0,y("next"),r),o=g.any(r,y("next"));if(a.sameTerm(n)&&o.sameTerm(n))(0,c.Rm)("You can't delete the only line.");else{var l=g.statementsMatching(r,void 0,void 0,t).concat(g.statementsMatching(void 0,void 0,r,t)),u=[(0,i.st)(a,y("next"),o,t)];if(r instanceof i.NamedNode){var d=r.uri.slice(-4);(0,c.Rm)("Deleting line "+d)}if(!v)throw new Error("have no updater");v.update(l,u,function(t,n,i,a){if(n){var o=e.parentNode;if(o){var u=o.previousSibling;o.parentNode&&o.parentNode.removeChild(o),u&&u.firstChild&&u.firstChild.focus()}}else if(a&&409===a.status)C(e,"color: black;  background-color: #ffd;"),e.state=0,(0,s.beep)(.5,512),setTimeout(function(){N()},1e3);else{(0,c.Rm)("    removePart FAILED "+r+": "+i),(0,c.Rm)("    removePart was deleteing :'"+l),C(e,"color: black;  background-color: #fdd;");var d=a?a.status:" [no response field] ";x("Error "+d+" saving changes: "+i.true)}})}},_=function(e,n){e.addEventListener("keydown",function(r){if(!v)throw new Error("no updater");var a,o;switch(r.keyCode){case 13:var s=r.shiftKey;if((0,c.Rm)("enter"),s?(o=g.any(void 0,y("next"),n),a="newlinesAfter"):(o=g.any(n,y("next")),a="newlinesBefore"),o[a]=o[a]||0,o[a]+=1,o[a]>1)return void(0,c.Rm)("    queueing newline queue = "+o[a]);(0,c.Rm)("    go ahead line before "+o[a]),T(e,s);break;case 8:if(0===e.value.length)switch((0,c.Rm)("Delete key line "+n.uri.slice(-4)+" state "+e.state),e.state){case 1:case 2:return void(e.state=4);case 3:case 4:return;case void 0:case 0:e.state=3,k(e),r.preventDefault();break;default:throw new Error("pad: Unexpected state "+e)}break;case 9:var l=r.shiftKey?-1:1;!function(e,n,r){var a=g.statementsMatching(n,y("indent")),o=a.length?Number(a[0].object.value):0;if(!(o+r<-3)){var s=o+r,l=(0,i.st)(n,y("indent"),s,t);if(!v)throw new Error("no updater");v.update(a,l,function(n,r,i){r?C(e):((0,c.Rm)("Indent change FAILED '"+s+"' for "+t+": "+i),C(e,"color: black;  background-color: #fdd;"),v.requestDownstreamAction(t,N))})}}(e,n,l),r.preventDefault();break;case 27:(0,c.Rm)("escape"),v.requestDownstreamAction(t,N),r.preventDefault();break;case 38:e.parentNode.previousSibling&&(e.parentNode.previousSibling.firstChild.focus(),r.preventDefault());break;case 40:e.parentNode.nextSibling&&(e.parentNode.nextSibling.firstChild.focus(),r.preventDefault())}});var a=function(e){var n=e.subject;C(e,void 0,!0);var o,l=g.any(n,r.A.sioc("content")).value,u=[(0,i.st)(n,r.A.sioc("content"),l,t)];e.value&&(o=[(0,i.st)(n,r.A.sioc("content"),e.value,t)]);var d=e.value;if(e.lastSent&&l!==e.lastSent)throw new Error("Out of order, last sent expected '"+l+"' but found '"+e.lastSent+"'");if(e.lastSent=d,!v)throw new Error("no updater");v.update(u,o,function(n,r,i,o){r?(E(),C(e),(0,c.Rm)("    Patch ok '"+l+"' -> '"+d+"' "),4===e.state?(e.state=3,k(e)):3===e.state||(2===e.state?(e.state=1,a(e)):e.state=0)):((0,c.Rm)("    patch FAILED "+o.status+" for '"+l+"' -> '"+d+"': "+i),409===o.status?(C(e,"color: black;  background-color: #fdd;"),e.state=0,(0,s.beep)(.5,512),setTimeout(function(){v.requestDownstreamAction(t,N)},1e3)):(C(e,"color: black;  background-color: #fdd;"),e.state=0,x("    Error "+o.status+" sending data: "+i,!0),(0,s.beep)(1,128)))})};e.addEventListener("input",function(t){switch(C(e,void 0,!0),(0,c.Rm)("Input event state "+e.state+" value '"+e.value+"'"),e.state){case 3:case 4:case 2:return;case 1:return void(e.state=2);case 0:case void 0:e.state=1,a(e)}})},S=function(t,n,i){var a=g.any(n,r.A.sioc("content"));a=a?a.value:"";var o=e.createElement("tr");i?m.insertBefore(o,t):t&&t.nextSibling?m.insertBefore(o,t.nextSibling):m.appendChild(o);var s=o.appendChild(e.createElement("input"));return s.subject=n,s.setAttribute("type","text"),s.value=a,l?(C(s,""),_(s,n)):(C(s,"color: #222; background-color: #fff"),(0,c.Rm)("Note can't add listeners - not logged in")),s},T=function(e,a){var s,u,d,f,h,m=p,g=0,w=null;e?("input"!==e.tagName.toLowerCase()&&(0,c.Rm)("return pressed when current document is: "+e.tagName),s=e.subject,g=(g=m.any(s,y("indent")))?Number(g.value):0,a?(u=m.any(void 0,y("next"),s),d=s,f=u,w="newlinesAfter"):(u=s,d=m.any(s,y("next")),f=d,w="newlinesBefore"),h=e.parentNode):(u=n,d=n,h=void 0);var b=(0,o.xV)(t),A=b.uri.slice(-4),x=[(0,i.st)(u,y("next"),d,t)],E=[(0,i.st)(u,y("next"),b,t),(0,i.st)(b,y("next"),d,t),(0,i.st)(b,r.A.dc("author"),l,t),(0,i.st)(b,r.A.sioc("content"),"",t)];if(g>0&&E.push((0,i.st)(b,y("indent"),g,t)),(0,c.Rm)("    Fresh chunk "+A+" proposed"),!v)throw new Error("no updater");v.update(x,E,function(e,t,n,r){if(t){var i=S(h,b,a);C(i),i.focus(),w&&((0,c.Rm)("    Fresh chunk "+A+" updated, queue = "+f[w]),f[w]-=1,f[w]>0&&((0,c.Rm)("    Implementing queued newlines = "+d.newLinesBefore),T(i,a)))}else(0,c.Rm)("    ERROR writing new line "+A+": "+n)})},R=function(){var e={},t=0;function i(e){x(e),t++}if(!g.the(n,y("next")))return i("No initial next pointer"),!1;for(var a,o=n;(a=g.the(o,y("next")))||i("No next pointer from "+o),!a.sameTerm(n);){o=a;var s=a.uri.split("#")[1];if(e[a.uri])return i("Loop!"),!1;e[a.uri]=!0;var c=g.each(a,y("next")).length;1!==c&&i("Should be 1 not "+c+" next pointer for "+s),(c=g.each(a,y("indent")).length)>1&&i("Should be 0 or 1 not "+c+" indent for "+s),1!==(c=g.each(a,r.A.sioc("content")).length)&&i("Should be 1 not "+c+" contents for "+s),1!==(c=g.each(a,r.A.dc("author")).length)&&i("Should be 1 not "+c+" author for "+s),g.statementsMatching(void 0,r.A.sioc("contents")).forEach(function(t){e[t.subject.value]||i("Loose chunk! "+t.subject.value)})}return!t},L=function(){if(1!==g.each(n,y("next")).length){var e="Pad: Inconsistent data - NEXT pointers: "+g.each(n,y("next")).length;return(0,c.Rm)(e),void(d.statusArea&&(d.statusArea.textContent+=e))}for(var t,i=[],a=g.the(n,y("next"));!a.sameTerm(n);a=g.the(a,y("next")))for(var o=0;o<m.children.length;o++){var s=m.children[o];s.firstChild&&s.firstChild.subject.sameTerm(a)&&(i[a.uri]=s.firstChild)}for(var l=m.children.length-1;l>=0;l--)i[(t=m.children[l]).firstChild.subject.uri]||m.removeChild(t);t=m.firstChild;for(var u=g.the(n,y("next"));!u.sameTerm(n);u=g.the(u,y("next"))){var p=g.any(u,r.A.sioc("content")).value;if(t&&i[u.uri]){var f=t.firstChild;p!==f.value&&(f.value=p),C(f),f.state=0,delete f.lastSent,t=t.nextSibling}else S(t,u,!0)}},I=function(e){if(e.refresh)e.refresh();else for(var t=0;t<e.children.length;t++)I(e.children[t])},P=!1,N=function(){if(P)(0,c.Rm)("   Already reloading - stop");else{P=!0;var e=1e3,n=function(){if((0,c.Rm)("try reload - timeout = "+e),!v)throw new Error("no updater");v.reload(v.store,t,function(r,i,a){P=!1,r?((0,c.Rm)("    reloaded OK"),E(),R()?I(m):x("CONSISTENCY CHECK FAILED")):0===a.status?(x("Network error refreshing the pad. Retrying in "+e/1e3),P=!0,e*=2,setTimeout(n,e)):x("Error "+a.status+"refreshing the pad:"+i+". Stopped. "+t)})};n()}};if(m.refresh=L,m.reloadAndSync=N,l||(0,c.Rm)("Warning: must be logged in for pad to be edited"),f)(0,c.Rm)("Existing pad."),R()?(L(),g.holds(n,y("next"),n)&&T()):(0,c.Rm)(m.textContent="Inconsistent data. Abort");else{(0,c.Rm)("No pad exists - making new one.");var O=[(0,i.st)(n,r.A.rdf("type"),y("Notepad"),t),(0,i.st)(n,r.A.dc("author"),l,t),(0,i.st)(n,r.A.dc("created"),new Date,t),(0,i.st)(n,y("next"),n,t)];if(!v)throw new Error("no updater");v.update([],O,function(e,t,n){t?((0,c.Rm)("Initial pad created"),T()):x(n||"")})}return m}function g(e,t){for(var n=[],r=t.the(e,f("next"));!r.sameTerm(e);r=t.the(r,f("next")))n.push(r);return n}function v(e){return e.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")}function y(e,t){var n=g(e,t),i="<html>\n  <head>\n",a=t.anyValue(e,r.A.dct("title"));a&&(i+="    <title>".concat(v(a),"</title>\n")),i+="  </head>\n  <body>\n";var o=0;function s(e){for(;o>e;o--)i+="</ul>\n"}return n.forEach(function(e){var n=t.anyJS(e,f("indent")),a=t.anyJS(e,r.A.sioc("content"));if(a){var c=v(a);if(n<0){s(0);var l=n>=-3?4+n:1;i+="\n<h".concat(l,">").concat(c,"</h").concat(l,">\n")}else n>0?(s(n),function(e){for(;o<e;o++)i+="<ul>\n"}(n),i+="<li>".concat(c,"</li>\n")):(s(n),i+="<p>".concat(c,"</p>\n"))}}),s(0),i+="  </body>\n</html>\n"}},8160(e,t,n){n.d(t,{E:()=>r});const r="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0},8226(e,t,n){n.d(t,{sc:()=>r});const r=n(5429).sc},8249(e,t,n){n.d(t,{Od:()=>u,YJ:()=>c,vt:()=>d,yv:()=>s});var r=n(4329),i=n(4976),a=n(8226),o=(new TextDecoder("utf-8"),new TextEncoder),s="https://w3id.org/security#";function c(){return{id:"",created:"",dateDeleted:"",content:"",maker:"",sig:""}}function l(e){var t,n=(0,a.sc)(o.encode((t=e,JSON.stringify(t))));return(0,i.My)(n)}function u(e,t,n){return r.ko.verify(e,l(t),n)}function d(e,t){return(0,i.My)(r.ko.sign(l(e),t))}},8251(e,t,n){n.d(t,{l:()=>f});var r=n(467),i=n(4756),a=n.n(i),o=n(1795),s=n(5175),c=n(3468),l=n(6564),u=n(675),d=n(9238),p=n(4961);function f(e,t,n,i,f,h,m){var g;function v(){return(v=(0,r.A)(a().mark(function t(n,r){var o,s,l,u,d,f;return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=1;break}throw new Error("autocompleteField:  No name set.");case 1:if(!(o=w.the(i,C,null,h))){t.next=2;break}if(s=w.any(o,k,null,h),!(o.equals(n)&&s&&s.sameTerm(r))){t.next=2;break}return t.abrupt("return");case 2:return l=o?w.statementsMatching(i,C,o,h).concat(w.statementsMatching(o,k,null,h)):[],u=[(0,p.st)(i,C,n,h),(0,p.st)(n,k,r,h)],t.prev=3,t.next=4,null===(d=w.updater)||void 0===d?void 0:d.updateMany(l,u);case 4:t.next=6;break;case 5:return t.prev=5,f=t.catch(3),m(!1,f),A.appendChild(c.F(e,"Autocomplete form data update error:"+f,null,f)),t.abrupt("return");case 6:m(!0,"");case 7:case"end":return t.stop()}},t,null,[[3,5]])}))).apply(this,arguments)}function y(){return(y=(0,r.A)(a().mark(function t(n,r){var o,s,l,u,d,p;return a().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=w.the(i,C,null,h)){t.next=1;break}return m(!1,"NO data to elete"),A.appendChild(c.F(e,"Autocomplete delete: no old data!")),t.abrupt("return");case 1:return s=w.statementsMatching(i,C,o,h).concat(w.statementsMatching(o,k,null,h)),l=[],t.prev=2,t.next=3,null===(u=w.updater)||void 0===u?void 0:u.updateMany(s,l);case 3:t.next=5;break;case 4:return t.prev=4,p=t.catch(2),d=new Error("Autocomplete form data delete error:"+p),m(!1,p),A.appendChild(c.F(e,d,null,p)),t.abrupt("return");case 5:m(!0,"");case 6:case"end":return t.stop()}},t,null,[[2,4]])}))).apply(this,arguments)}if("NamedNode"!==i.termType)throw new Error("Sorry this field only works on NamedNode subjects (for editable)");var w=s.M_,b=f.doc?f.doc():null,A=e.createElement("div");t&&t.appendChild(A);var x=e.createElement("div");x.setAttribute("class","formFieldName"),x.setAttribute("style",u.i.formFieldNameBoxStyle),A.appendChild(x);var E=e.createElement("div");E.setAttribute("class","formFieldValue"),A.appendChild(E);var C=w.any(f,o.A.ui("property"));if(!C)return A.appendChild(c.F(e,"Error: No property given for autocomplete field: "+f));var k=w.any(f,o.A.ui("labelProperty"))||o.A.schema("name"),_=w.any(f,o.A.ui("dataSource"));if(!_)return A.appendChild(c.F(e,"Error: No data source given for autocomplete field: "+f));var S={label:w.anyJS(_,o.A.schema("name"),null,_.doc()),logo:w.any(_,o.A.schema("logo"),null,_.doc())},T=w.any(f,o.A.ui("targetClass"),null,f.doc())||w.any(_,o.A.ui("targetClass"),null,_.doc());T&&(S.targetClass=T),S.objectURIBase=w.any(_,o.A.ui("objectURIBase"),null,_.doc())||void 0;var R=w.anyJS(_,o.A.ui("endpoint"),null,_.doc());if(R){if(S.endpoint=R,S.searchByNameQuery=w.anyJS(_,o.A.ui("searchByNameQuery"),null,_.doc()),!S.searchByNameQuery)return A.appendChild(c.F(e,"Error: No searchByNameQuery given for endpoint data Source: "+f));S.insitituteDetailsQuery=w.anyJS(_,o.A.ui("insitituteDetailsQuery"),null,_.doc())}else{var L=w.anyJS(_,o.A.ui("searchByNameURI"));if(!L)return A.appendChild(c.F(e,"Error: No searchByNameURI OR sparql endpoint given for dataSource: "+_));S.searchByNameURI=L}var I=w.anyJS(f,o.A.ui("suppressEmptyUneditable"),null,b),P=null===(g=w.updater)||void 0===g?void 0:g.editable(h.uri),N={permanent:!0,targetClass:S.targetClass,queryParams:S};N.size=w.anyJS(f,o.A.ui("size"),null,b)||void 0;var O=w.any(i,C,void 0,h);if(O)N.currentObject=O,N.currentName=w.any(N.currentObject,k,null,h);else if(O=w.any(f,o.A.ui("default")))N.currentObject=O,N.currentName=w.any(N.currentObject,k,null,h);else if(I&&!P)return A.style.display="none",A;x.appendChild(l.bk(e,C,f));var M={editable:P,dbLookup:!0};return(0,d.A)(e,i,M,N,function(e,t){return v.apply(this,arguments)},function(e,t){return y.apply(this,arguments)}).then(function(e){E.appendChild(e)},function(t){E.appendChild(c.F(e,"Error rendering autocomplete ".concat(f,": ").concat(t),"#fee",t))}),A}},8425(e,t,n){n.d(t,{AB:()=>u,ED:()=>d,S3:()=>p,cX:()=>h});var r=n(467),i=n(4756),a=n.n(i),o=n(7423),s=n(5175),c=n(1795),l=n(8852),u=function(e){var t;try{var n=(0,l.X)(e);t="".concat(n,"/profile/keys/publicKey.ttl")}catch(e){o.z3(e)}return t},d=function(e){var t;try{var n=(0,l.X)(e);t="".concat(n,"/settings/keys/privateKey.ttl")}catch(e){o.z3(e)}return t};function p(e,t){return f.apply(this,arguments)}function f(){return(f=(0,r.A)(a().mark(function e(t,n){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,g(t,n,"publicKey");case 1:return e.abrupt("return",e.sent);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(e,t){return m.apply(this,arguments)}function m(){return(m=(0,r.A)(a().mark(function e(t,n){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,g(t,n,"privateKey");case 1:return e.abrupt("return",e.sent);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function g(e,t,n){return v.apply(this,arguments)}function v(){return(v=(0,r.A)(a().mark(function e(t,n,r){var i,l,u;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=1,s.M_.fetcher.load(n);case 1:return i=s.M_.any(t,c.A.solid(r)),e.abrupt("return",null==i?void 0:i.value);case 2:if(e.prev=2,404!==(l=e.catch(0)).response.status){e.next=7;break}return o.Rm("createIfNotExists: doc does NOT exist, will create... "+n),e.prev=3,e.next=4,s.M_.fetcher.webOperation("PUT",n,{data:"",contentType:"text/turtle"});case 4:e.next=6;break;case 5:throw e.prev=5,u=e.catch(3),o.Rm("createIfNotExists doc FAILED: "+n+": "+u),u;case 6:return delete s.M_.fetcher.requested[n],e.abrupt("return",void 0);case 7:throw o.Rm("createIfNotExists doc FAILED: "+n+": "+l),l;case 8:case"end":return e.stop()}},e,null,[[0,2],[3,5]])}))).apply(this,arguments)}},8516(e,t,n){n.d(t,{v:()=>p});var r=n(3378),i=n(967),a=n(5175),o=n(1795),s=n(4961),c=n(675),l=n(9612),u=n(4608),d={icons:r.Pt,ns:o.A,rdf:s,style:c.i,widgets:u};function p(e,t,n,r,o){t=t||a.hV.store,r=r.doc();var c,u,p=d.ns,f=s.Namespace("http://www.w3.org/2005/01/wf/flow#"),h=s.Namespace("http://purl.org/dc/terms/"),m=!!(o=o||{}).newestFirst,g="white-space: pre-wrap; width: 90%; font-size:100%; border: 0.07em solid #eee; padding: .2em 0.5em; margin: 0.1em 1em 0.1em 1em;",v=e.createElement("div"),y=a.hV.store.updater,w=function(t,n){var r=e.createElement("a");return n&&n.uri&&(r.setAttribute("href",n.uri),r.addEventListener("click",d.widgets.openHrefInOutlineMode,!0),r.setAttribute("style","color: #3B5998; text-decoration: none; ")),r.textContent=t,r},b=function(t,n){var r=e.createElement("pre");return r.setAttribute("style",n||"color: grey"),v.appendChild(r),r.appendChild(e.createTextNode(t)),r},A=function(e){b(e,"color: #800;")};function x(e){var t=a.hV.store.any(e,d.ns.foaf("nick"));return t?""+t.value:""+l.P(e)}function E(t,n,r,i){var o=t.appendChild(w(x(n),n));n.uri&&a.hV.store.fetcher.nowOrWhenFetched(n.doc(),void 0,function(e,t){o.textContent=x(n)}),t.appendChild(e.createElement("br")),t.appendChild(w(r,i))}function C(e,n){var r,i,a={};for(r=n.firstChild;r;r=r.nextSibling)r.AJAR_subject&&(a[r.AJAR_subject.uri]=!0);var o=t.each(e,p.wf("message")),s={};for(o.forEach(function(e){s[e.uri]=!0,a[e.uri]||k(e)}),r=n.firstChild;r;)i=r.nextSibling,r.AJAR_subject&&!s[r.AJAR_subject.uri]&&n.removeChild(r),r=i}var k=function(e){var n={"?msg":e,"?creator":t.any(e,p.foaf("maker")),"?date":t.any(e,h("created")),"?content":t.any(e,p.sioc("content"))};_(n,!0)},_=function(r,i){var a=r["?creator"],o=r["?msg"],s=r["?date"],l=r["?content"],u=s.value,p=e.createElement("tr");p.AJAR_date=u,p.AJAR_subject=o;for(var f=!1,h=c.firstChild;h;h=h.nextSibling)if(u>h.AJAR_date&&m||u<h.AJAR_date&&!m){c.insertBefore(p,h),f=!0;break}f||c.appendChild(p);var v=e.createElement("td");p.appendChild(v),E(v,a,d.widgets.shortDate(u),o);var w=e.createElement("td");p.appendChild(w);var b=e.createElement("p");b.setAttribute("style",g+(i?"background-color: #e8ffe8;":"background-color: #white;")),w.appendChild(b),b.textContent=l.value;var x=e.createElement("td");p.appendChild(x);var k=e.createElement("button");x.appendChild(k),k.textContent="-",p.setAttribute("class","hoverControl"),k.setAttribute("class","hoverControlHide"),k.setAttribute("style","color: red;"),k.addEventListener("click",function(r){x.removeChild(k);var i=e.createElement("button");i.textContent="cancel",x.appendChild(i).addEventListener("click",function(e){x.removeChild(a),x.removeChild(i),x.appendChild(k)},!1);var a=e.createElement("button");a.textContent="Delete message",x.appendChild(a).addEventListener("click",function(e){x.removeChild(a),x.removeChild(i),function(e){var r=t.statementsMatching(e).concat(t.statementsMatching(void 0,void 0,e));y.update(r,[],function(e,t,r){t?C(n,c):A("Cant delete messages:"+r)})}(o)},!1)},!1)};(c=e.createElement("table")).fresh=!1,v.appendChild(c),c.setAttribute("style","width: 100%;");var S,T=function(){var a=e.createElement("tr"),o=e.createElement("td"),c=e.createElement("td"),l=e.createElement("td");a.appendChild(o),a.appendChild(c),a.appendChild(l),a.AJAR_date="9999-01-01T00:00:00Z";var f,m,v=function(){f.setAttribute("class","pendingedit"),f.disabled=!0;var i=[],o=new Date,c=""+o.getTime(),l=s.term(o),m=t.sym(r.uri+"#Msg"+c);i.push(new s.Statement(n,p.wf("message"),m,r)),i.push(new s.Statement(m,p.sioc("content"),t.literal(f.value),r)),i.push(new s.Statement(m,h("created"),l,r)),u&&i.push(new s.Statement(m,p.foaf("maker"),u,r));y.update([],i,function(n,r,i){if(r){var o={"?msg":m,"?content":t.literal(f.value),"?date":l,"?creator":u};_(o,!1),f.value="",f.setAttribute("class",""),f.disabled=!1}else a.appendChild(d.widgets.errorMessageBlock(e,"Error writing message: "+i))})};a.appendChild(e.createElement("br"));var w={div:c,dom:e};return i.ensureLoggedIn(w).then(function(t){u=t.me,E(o,u,"",null),f=e.createElement("textarea"),c.innerHTML="",c.appendChild(f),f.rows=3,f.setAttribute("style",g+"background-color: #eef;"),f.addEventListener("keyup",function(e){13===e.keyCode&&(e.altKey||v())},!1),l.innerHTML="",(m=d.widgets.button(e,d.icons.iconBase+"noun_383448.svg","Send")).setAttribute("style",d.style.buttonStyle+"float: right;"),m.addEventListener("click",v,!1),l.appendChild(m)}),a}();if(m?c.insertBefore(T,c.firstChild):c.appendChild(T),o.query)S=o.query;else{S=new s.Query("Messages");var R={};["msg","date","creator","content"].forEach(function(e){S.vars.push(R[e]=s.variable(e))}),S.pat.add(n,f("message"),R.msg),S.pat.add(R.msg,p.dct("created"),R.date),S.pat.add(R.msg,p.foaf("maker"),R.creator),S.pat.add(R.msg,p.sioc("content"),R.content)}return t.query(S,_,void 0,function(){c.fresh=!0}),v.refresh=function(){C(n,c)},v}},8565(e,t,n){n.d(t,{E6:()=>c,bB:()=>l,mG:()=>d,nF:()=>p});var r=n(467),i=n(4756),a=n.n(i),o=n(4961),s=n(1795);function c(){return(0,o.sym)(document.location.origin).site()}function l(e,t){return u.apply(this,arguments)}function u(){return(u=(0,r.A)(a().mark(function e(t,n){var r,i,c,l,u;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n.any(t,null,s.A.ldp("Container"),t)){e.next=2;break}return e.next=1,n.fetcher.webOperation("GET",t.uri,n.fetcher.initFetchOptions(t.uri,{headers:{accept:"text/turtle"}}));case 1:r=e.sent,i=r.responseText,(0,o.parse)(i,n,t.uri,"text/turtle");case 2:e.next=4;break;case 3:return e.prev=3,u=e.catch(0),console.error("Error loading pod "+t+": "+u),e.abrupt("return",null);case 4:if(n.holds(t,s.A.rdf("type"),s.A.space("Storage"),t)){e.next=5;break}return console.warn("Pod  "+t+" does not declare itself as a space:Storage"),e.abrupt("return",null);case 5:if(!(c=n.any(t,s.A.solid("owner"),null,t)||n.any(null,s.A.space("storage"),t,t))){e.next=10;break}return e.prev=6,e.next=7,n.fetcher.load(c.doc());case 7:e.next=9;break;case 8:return e.prev=8,e.catch(6),console.warn("Unable to load profile of pod owner "+c),e.abrupt("return",null);case 9:return n.holds(c,s.A.space("storage"),t,c.doc())||console.warn("Pod owner ".concat(c," does NOT list pod ").concat(t," as their storage")),e.abrupt("return",c);case 10:return l=(0,o.sym)("".concat(t.uri,"profile/card#me")),e.prev=11,e.next=12,n.fetcher.load(l);case 12:e.next=14;break;case 13:return e.prev=13,e.catch(11),console.error("Ooops. Guessed wrong pod owner webid {$guess} : can't load it."),e.abrupt("return",null);case 14:if(!n.holds(l,s.A.space("storage"),t,l.doc())){e.next=15;break}return console.warn("Using guessed pod owner webid but it links back."),e.abrupt("return",l);case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}},e,null,[[0,3],[6,8],[11,13]])}))).apply(this,arguments)}function d(e,t){return e.anyValue(t,s.A.vcard("fn"),null,t.doc())||e.anyValue(t,s.A.foaf("name"),null,t.doc())||t.uri}function p(e,t){var n,r,i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=null,s=0,c=function(){s=a.leading?Date.now():0,o=null,i=e.apply(n,r),o||(n=r=null)};return function(){var l=Date.now();s||a.leading||(s=l);var u=t-(l-s);return n=this,r=arguments,u<=0||u>t?(o&&(clearTimeout(o),o=null),s=l,i=e.apply(n,r),o||(n=r=null)):o||!1===a.trailing||(o=setTimeout(c,u)),i}}},8613(e,t,n){n.d(t,{T:()=>d});var r=n(5175),i=n(7423),a=n(3378),o=n(967),s=n(1795),c=n(9612),l=n(3291),u=r.hV.store;function d(e,t,n){var r=e.dom,d=e.div;if(e.me&&!e.me.uri)throw new Error("newThingUI:  Invalid userid: "+e.me);var p="padding: 0.7em; width: 2em; height: 2em;",f=d.appendChild(r.createElement("img")),h=!1;f.setAttribute("src",a.Pt.iconBase+"noun_34653_green.svg"),f.setAttribute("style",p),f.setAttribute("title","Add another tool");var m=function(e){var t=d.appendChild(r.createElement("pre"));t.setAttribute("style","background-color: pink"),t.appendChild(r.createTextNode(e))};function g(e){for(var t=0;t<y.length;t++){var n=p+e;y[t].disabled&&(n+="opacity: 0.3;"),y[t].setAttribute("style",n)}}function v(e){h=!h,f.setAttribute("style",p+(h?"background-color: yellow;":"")),g(h?"":"display: none;")}f.addEventListener("click",v);var y=[],w=Object.values(n).filter(function(e){return e.mintNew}),b=w.reduce(function(e,t){return t.mintClass&&(e[t.mintClass.uri]=(e[t.mintClass.uri]||0)+1),e},{});w.forEach(function(n){var a=e.div.appendChild(r.createElement("img"));a.setAttribute("src",n.icon);var d=n.mintClass?b[n.mintClass.uri]>1?"".concat(c.P(n.mintClass)," (using ").concat(n.name," pane)"):c.P(n.mintClass):n.name+" @@";a.setAttribute("title","Make new "+d),a.setAttribute("style",p+"display: none;"),y.push(a),a.disabled||a.addEventListener("click",function(f){var h;!function(e){g("display: none;"),e.setAttribute("style",p+"background-color: yellow;")}(a),h={event:f,folder:e.folder||null,iconEle:a,pane:n,noun:d,noIndexHTML:!0,div:e.div,me:e.me,dom:e.dom,refreshTarget:e.refreshTarget},new Promise(function(n,a){var d;function p(n,c){(0,o.ensureLoadedProfile)(e).then(function(e){var o=Object.assign({newBase:c,folder:h.folder||void 0,workspace:n},h);for(var l in h)o[l]=h[l];i.Rm("newThingUI: Minting new ".concat(o.pane.name," at ").concat(o.newBase)),h.pane.mintNew(t,o).then(function(e){if(!e||!e.newInstance)throw new Error("Cannot mint new - missing newInstance");if(e.folder){var t=e.newInstance.uri.slice(e.folder.uri.length).includes("/");i.Rm("  new thing is packge? "+t),t?u.add(e.folder,s.A.ldp("contains"),u.sym(e.newBase),e.folder.doc()):u.add(e.folder,s.A.ldp("contains"),e.newInstance,e.folder.doc()),e.refreshTarget&&e.refreshTarget.refresh&&e.refreshTarget.refresh()}else{var n=h.div.appendChild(r.createElement("p"));n.setAttribute("style","font-size: 120%;"),n.innerHTML="Your <a target='_blank' href='"+e.newInstance.uri+"'><b>new "+h.noun+"</b></a> is ready to be set up. <br/><br/><a target='_blank' href='"+e.newInstance.uri+"'>Go to your new "+h.noun+".</a>"}v()}).catch(function(e){m(e),a(e)})},function(e){m("Error logging on: "+e)})}var f=h.pane;h.noun=f.mintClass?c.P(f.mintClass):f.name,h.appPathSegment=h.noun.slice(0,1).toUpperCase()+h.noun.slice(1),h.folder?l.RG(r,u,h.div,s.A.foaf("name"),null,h.noun).then(function(e){if(e){var t=h.folder.uri;t.endsWith("/")||(t+="/"),p(null,t=t+encodeURIComponent(e)+"/")}else v()}):(d=(0,o.selectWorkspace)(r,{noun:h.noun,appPathSegment:h.appPathSegment},p),h.div.appendChild(d))})})})}},8677(e,t,n){n.r(t),n.d(t,{addDefaults:()=>d,defaultPreferredLanguages:()=>u,filterByLanguage:()=>g,getPreferredLanguages:()=>h,getPreferredLanguagesFor:()=>p,languageCodeURIBase:()=>l});var r=n(467),i=n(4756),a=n.n(i),o=n(7423),s=n(5175),c=n(1795),l="https://www.w3.org/ns/iana/language-code/",u=["en","fr","de","it","ar"];function d(e){return e||(e=[]),e.concat(u.filter(function(t){return!e.includes(t)}))}function p(e){return f.apply(this,arguments)}function f(){return(f=(0,r.A)(a().mark(function e(t){var n,r,i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.doc(),e.next=1,null===(n=s.M_.fetcher)||void 0===n?void 0:n.load(r);case 1:if(i=s.M_.any(t,c.A.schema("knowsLanguage"),null,r)){e.next=2;break}return e.abrupt("return",u);case 2:if(o=[],i.elements.forEach(function(e){var t=s.M_.any(e,c.A.solid("publicId"),null,r);if(t)if(t.value.startsWith(l)){var n=t.value.slice(l.length);o.push(n)}else console.error("What should be a language code ".concat(t.value," does not start with ").concat(l));else console.warn("getPreferredLanguages: No publiID of language.")}),!(o.length>0)){e.next=3;break}return console.log('     User knows languages with codes: "'.concat(o.join(","),'"')),e.abrupt("return",d(o));case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function h(){return m.apply(this,arguments)}function m(){return(m=(0,r.A)(a().mark(function e(){var t,n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,s.jO.currentUser();case 1:if(!(t=e.sent)){e.next=3;break}return e.next=2,p(t);case 2:if(!(n=e.sent)){e.next=3;break}return e.abrupt("return",n);case 3:if("undefined"==typeof navigator){e.next=5;break}if(!navigator.languages){e.next=4;break}return e.abrupt("return",d(navigator.languages.map(function(e){return e.split("-")[0]})));case 4:if(!navigator.language){e.next=5;break}return e.abrupt("return",d([navigator.language.split("-")[0]]));case 5:return e.abrupt("return",u);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function g(e,t){var n={};e.forEach(function(e){var t=e.subject.value;n[t]=n[t]||[],n[t].push(e)});var r=t||u;r.reverse();var i=[];for(var a in n){var s=n[a].map(function(e){var t=e.name["xml:lang"];return[r.indexOf(t),e]});s.sort(),s.reverse(),i.push(s[0][1])}return o.Rm(" Filter by language: ".concat(e.length," -> ").concat(i.length)),i}},8702(e,t,n){n.r(t),n.d(t,{AUTOCOMPLETE_LIMIT:()=>d,ESCOResultToBindings:()=>k,bindingToTerm:()=>E,dbPediaTypeMap:()=>y,dbpediaParameters:()=>v,escoParameters:()=>g,fetcherOptionsJsonPublicData:()=>m,getDbpediaDetails:()=>V,getWikidataDetails:()=>D,getWikidataDetailsOld:()=>F,getWikidataLocation:()=>H,instituteDetailsWikidataQuery:()=>h,loadFromBindings:()=>C,loadPublicDataThing:()=>M,queryESCODataByName:()=>_,queryPublicDataByName:()=>R,queryPublicDataConstruct:()=>N,queryPublicDataSelect:()=>I,variableNameToPredicateMap:()=>x,wikidataClasses:()=>f,wikidataIncomingClassMap:()=>A,wikidataOutgoingClassMap:()=>w,wikidataParameters:()=>b});var r=n(467),i=n(4756),a=n.n(i),o=n(4961),s=n(5175),c=n(7423),l=n(1795),u=n(8677),d=200,p=/\$\(subject\)/g,f={Corporation:"http://www.wikidata.org/entity/Q6881511",EducationalOrganization:"http://www.wikidata.org/entity/Q178706",GovernmentOrganization:"http://www.wikidata.org/entity/Q327333",MedicalOrganization:"http://www.wikidata.org/entity/Q4287745",MusicGroup:"http://www.wikidata.org/entity/Q32178211",NGO:"http://www.wikidata.org/entity/Q163740",Occupation:"http://www.wikidata.org/entity/Q28640",Project:"http://www.wikidata.org/entity/Q170584",ResearchOrganization:"http://www.wikidata.org/entity/Q31855",SportsOrganization:"http://www.wikidata.org/entity/Q4438121"},h='prefix vcard: <http://www.w3.org/2006/vcard/ns#>\nCONSTRUCT\n{  wd:Q49108 vcard:fn ?itemLabel.\nwd:Q49108 rdf:type ?klass. ?klass rdfs:label ?klassLabel; rdfs:comment ?klassDescription .\nwd:Q49108 schema:logo ?logo;\n   schema:image ?image;\n   schema:logo  ?sealImage;\n   schema:subOrganization  ?subsidiary .\n      ?subsidiary rdfs:label ?subsidiaryLabel .\n ?supersidiary schema:subOrganization wd:Q49108 .\n      ?supersidiary rdfs:label ?supersidiaryLabel .\n  wd:Q49108 schema:location ?location .\n     ?location  schema:elevation  ?elevation .\n     ?location  wdt:P131  ?region .  ?region rdfs:label ?regionLabel .\n     ?location wdt:P625 ?coordinates .\n     ?location  schema:country  ?country . ?country rdfs:label ?countryLabel .\n}\nWHERE\n{  optional {wd:Q49108 rdfs:label ?itemLabel} .\n  optional {wd:Q49108 wdt:P154 ?logo .}\n  optional {wd:Q49108 wdt:P31 ?klass .}\n  optional {wd:Q49108 wdt:P158  ?sealImage .}\n  optional {wd:Q49108 wdt:P18 ?image .}\n\n  optional { wd:Q49108       wdt:P355 ?subsidiary . }\n  optional { ?supersidiary   wdt:P355 wd:Q49108. }\n\n  optional { wd:Q49108 wdt:P276 ?location .\n\n    optional { ?location  schema:eleveation  ?elevation }\n    optional { ?location  wdt:P131  ?region }\n    optional { ?location wdt:P625 ?coordinates }\n    optional {  ?location  wdt:P17  ?country }\n  }\n  SERVICE wikibase:label { bd:serviceParam wikibase:language "fr,en,de,it". }\n}',m={credentials:"omit",headers:new Headers({Accept:"application/json"})},g={label:"ESCO",logo:s.M_.sym("https://ec.europa.eu/esco/portal/static_resource2/images/logo/logo_en.gif"),searchByNameURI:"https://ec.europa.eu/esco/api/search?language=$(language)&type=occupation&text=$(name)"},v={label:"DBPedia",logo:s.M_.sym("https://upload.wikimedia.org/wikipedia/commons/thumb/7/73/DBpediaLogo.svg/263px-DBpediaLogo.svg.png"),searchByNameQuery:'select distinct ?subject, ?name where {\n    ?subject a $(targetClass); rdfs:label ?name\n    FILTER regex(?name, "$(name)", "i")\n  } LIMIT $(limit)',endpoint:"https://dbpedia.org/sparql/"},y={AcademicInsitution:"http://umbel.org/umbel/rc/EducationalOrganization"},w={AcademicInsitution:"http://www.wikidata.org/entity/Q4671277",Enterprise:"http://www.wikidata.org/entity/Q6881511",Business:"http://www.wikidata.org/entity/Q4830453",NGO:"http://www.wikidata.org/entity/Q79913",CharitableOrganization:"http://www.wikidata.org/entity/Q708676",Insitute:"http://www.wikidata.org/entity/Q1664720"},b={label:"WikiData",limit:3e3,logo:s.M_.sym("https://www.wikimedia.org/static/images/project-logos/wikidatawiki.png"),endpoint:"https://query.wikidata.org/sparql",searchByNameQuery:'SELECT ?subject ?name\n  WHERE {\n    ?klass wdt:P279* $(targetClass) .\n    ?subject wdt:P31 ?klass .\n    ?subject rdfs:label ?name.\n    FILTER regex(?name, "$(name)", "i")\n  } LIMIT $(limit) ',insitituteDetailsQuery:'CONSTRUCT\n{  wd:Q49108 schema:name ?itemLabel;\n             schema:logo ?logo;\n              schema:logo  ?sealImage;\n             schema:subOrganization  ?subsidiary .\n                 ?subsidiary schema:name ?subsidiaryLabel .\n}\nWHERE\n{\n   wd:Q49108 # rdfs:label ?itemLabel ;\n             wdt:P154 ?logo;\n              wdt:P158  ?sealImage ;\n             wdt:P355  ?subsidiary .\n          #  ?subsidiary rdfs:label ?subsidiaryLabel .\n\n  SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE], fr". }\n}'},A={"http://www.wikidata.org/entity/Q15936437":l.A.schema("CollegeOrUniversity"),"http://www.wikidata.org/entity/Q1664720":l.A.schema("EducationalOrganization"),"http://www.wikidata.org/entity/Q43229":l.A.schema("Organization"),"http://www.wikidata.org/entity/Q3918":l.A.schema("CollegeOrUniversity"),"http://www.wikidata.org/entity/Q170584":l.A.schema("Project"),"http://www.wikidata.org/entity/Q327333":l.A.schema("GovernmentOrganization"),"http://www.wikidata.org/entity/Q2221906":l.A.schema("Place"),"http://www.wikidata.org/entity/Q167037":l.A.schema("Corporation")},x={targetClass:l.A.rdf("type"),sealImage:l.A.schema("logo"),shortName:l.A.foaf("nick"),subsidiary:l.A.schema("subOrganization"),city:l.A.vcard("locality"),state:l.A.vcard("region"),country:l.A.vcard("country-name"),homepage:l.A.foaf("homepage"),lat:l.A.schema("latitude"),long:l.A.schema("longitude")};function E(e){var t=e.type.toLowerCase();if("uri"===t||"iri"===t)return s.M_.sym(e.value);if("literal"===t)return e["xml:lang"]?new o.Literal(e.value,e["xml:lang"]):new o.Literal(e.value);throw new Error('bindingToTerm: Unexpected type "'.concat(e.type,'" in sparql binding}'))}function C(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:x,a={};c.Rm("loadFromBindings:  subject: ".concat(t)),c.Rm("                       doc: ".concat(r)),n.forEach(function(e){for(var t in e){var n=e[t],r=JSON.stringify(n);a[t]=a[t]||new Set,a[t].add(r)}});var s=function(n){var s=a[n];c.Rm("    results ".concat(n," -> ").concat(s)),s.forEach(function(a){var s,u=JSON.parse(a),d=u.type,p=u.value;if("uri"===d)s=e.sym(p);else{if("literal"!==d)throw new Error("loadFromBindings:  unexpected type: ".concat(d));s=new o.Literal(p,u.language,u.datatype)}if("type"===n)A[p]?s=A[p]:c.R8("Unmapped Wikidata Class: "+p);else if("coordinates"===n){c.Rm("         @@@ hey a point: "+p);var f=/.*\(([-0-9.-]*) ([-0-9.-]*)\)/.exec(p);if(f){var h=l.A.xsd("float"),m=new o.Literal(f[1],null,h),g=new o.Literal(f[2],null,h);e.add(t,l.A.schema("longitude"),g,r),e.add(t,l.A.schema("latitude"),m,r)}else c.Rm("Bad coordinates syntax: "+p)}else{var v=i[n]||l.A.schema(n);e.add(t,v,s,r),c.Rm("  public data ".concat(v," ").concat(s,"."))}})};for(var u in a)s(u)}function k(e){return e._embedded.results.map(function(e){return{name:{value:e.title,type:"literal"},subject:{type:"IRI",value:e.uri}}})}function _(e,t,n){return S.apply(this,arguments)}function S(){return(S=(0,r.A)(a().mark(function e(t,n,r){var i,o,l,u,p,f;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r.searchByNameURI){e.next=1;break}throw new Error("Missing queryTarget.searchByNameURI on queryESCODataByName");case 1:return o=r.limit||d,l=r.searchByNameURI.replace("$(name)",t).replace("$(limit)",""+o).replace("$(targetClass)",n.toNT()),c.Rm("Querying ESCO data - uri: "+l),e.next=2,null===(i=s.M_.fetcher)||void 0===i?void 0:i.webOperation("GET",l,m);case 2:if(u=e.sent,p=(null==u?void 0:u.responseText)||"",c.Rm("    Query result  text"+p.slice(0,500)+"..."),0!==p.length){e.next=3;break}throw new Error("Wot no text back from ESCO query "+l);case 3:return f=JSON.parse(p),c.Rm("    ESCO Query result JSON"+JSON.stringify(f,null,4).slice(0,500)+"..."),e.abrupt("return",k(f));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function T(e){var t=e.indexOf("SPARQL-QUERY");if(t<0)return e;c.R8("  ### Fixing JSON with wikidata error code injection "+e.slice(t,t+200));var n=e.lastIndexOf("}, {");return e.slice(0,n)+" } ] } } "}function R(e,t,n,r){return L.apply(this,arguments)}function L(){return(L=(0,r.A)(a().mark(function e(t,n,r,i){var o,l,p,f,h,g,v,y,w,b,A,x;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=function(e){var r=i.limit||d;return e.replace("$(name)",t).replace("$(limit)",""+r).replace("$(language)",l).replace("$(targetClass)",n.toNT())},n){e.next=1;break}throw new Error("queryPublicDataByName: No class provided");case 1:return e.next=2,(0,u.getPreferredLanguages)();case 2:if(A=e.sent){e.next=3;break}A=u.defaultPreferredLanguages;case 3:if(l=A[0]||"en",!i.searchByNameQuery){e.next=4;break}return p=o(i.searchByNameQuery),c.Rm("Querying public data - sparql: "+p),e.abrupt("return",I(p,i));case 4:if(!i.searchByNameURI){e.next=13;break}return f=o(i.searchByNameURI),e.prev=5,e.next=6,null===(g=s.M_.fetcher)||void 0===g?void 0:g.webOperation("GET",f,m);case 6:h=e.sent,e.next=8;break;case 7:throw e.prev=7,x=e.catch(5),new Error("Exception when trying to fetch ".concat(f," \n ").concat(x));case 8:if(v=h.responseText||"",200===h.status){e.next=9;break}throw new Error("HTTP error status ".concat(h.status," trying to fetch ").concat(f," "));case 9:if(c.Rm("    Query result  text"+v.slice(0,500)+"..."),0!==v.length){e.next=10;break}throw new Error("queryPublicDataByName: No text back from public data query "+f);case 10:if(y=T(v),w=JSON.parse(y),c.Rm("    API Query result JSON"+JSON.stringify(w,null,4).slice(0,500)+"..."),!w._embedded){e.next=11;break}return c.Rm("      Looks like ESCO"),b=k(w),e.abrupt("return",b);case 11:throw alert("Code me: unrecognized API return format"),new Error("*** Need to add code to parse unrecognized API JSON return\n".concat(JSON.stringify(w,null,4)));case 12:e.next=14;break;case 13:throw new Error("Query source must have either rest API or SPARQL endpoint.");case 14:case"end":return e.stop()}},e,null,[[5,7]])}))).apply(this,arguments)}function I(e,t){return P.apply(this,arguments)}function P(){return(P=(0,r.A)(a().mark(function e(t,n){var r,i,o,l,u,d,p,f,h,m;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.endpoint){e.next=1;break}throw new Error("Missing queryTarget.endpoint required for queryPublicDataSelect");case 1:return(i=new URL(n.endpoint)).searchParams.append("query",t),o=i.href,c.Rm(" queryPublicDataSelect uri: "+o),(l=new Headers).append("Accept","application/json"),u={credentials:"omit",headers:l},e.next=2,null===(r=s.M_.fetcher)||void 0===r?void 0:r.webOperation("GET",o,u);case 2:if(d=e.sent,0!==(p=(null==d?void 0:d.responseText)||"").length){e.next=3;break}throw new Error("No text back from query "+o);case 3:return f=T(p),h=JSON.parse(f),c.Rm("    Query result JSON"+JSON.stringify(h,null,4).slice(0,100)+"..."),m=h.results.bindings,e.abrupt("return",m);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function N(e,t,n){return O.apply(this,arguments)}function O(){return(O=(0,r.A)(a().mark(function e(t,n,r){var i,l,u,d,p,f,h,m;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c.Rm("queryPublicDataConstruct: sparql:",t),r.endpoint){e.next=1;break}throw new Error("Missing queryTarget.endpoint required for queryPublicDataConstruct");case 1:return(l=new URL(r.endpoint)).searchParams.append("query",t),u=l.href,c.Rm(" queryPublicDataConstruct uri: "+u),(d=new Headers).append("Accept","text/turtle"),p={credentials:"omit",headers:d},e.next=2,null===(i=s.M_.fetcher)||void 0===i?void 0:i.webOperation("GET",u,p);case 2:if(f=e.sent,h=(null==f?void 0:f.responseText)||"No response text?",m=h.length>500?h.slice(0,200)+" ... "+h.slice(-200):h,c.Rm("    queryPublicDataConstruct result text:"+m),0!==h.length){e.next=3;break}throw new Error("queryPublicDataConstruct: No text back from construct query:"+u);case 3:(0,o.parse)(h,s.M_,n.uri,"text/turtle");case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function M(e,t,n){return B.apply(this,arguments)}function B(){return(B=(0,r.A)(a().mark(function e(t,n,r){var i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.uri.startsWith("https://dbpedia.org/resource/")){e.next=1;break}return e.abrupt("return",V(t,n,r));case 1:if(!r.uri.match(/^https?:\/\/www\.wikidata\.org\/entity\/.*/)){e.next=3;break}return e.next=2,D(t,n,r);case 2:e.next=4;break;case 3:return i=r.uri.startsWith("http:")?t.sym("https:"+r.uri.slice(5)):r,(o=new Headers).append("Accept","text/turtle"),e.abrupt("return",t.fetcher.load(i,{credentials:"omit",headers:o}));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function D(e,t,n){return U.apply(this,arguments)}function U(){return(U=(0,r.A)(a().mark(function e(t,n,r){var i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=/wd:Q49108/g,o=h.replace(i,r.toNT()),e.next=1,N(o,r,b);case 1:c.Rm("getWikidataDetails: loaded.",r);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function F(e,t,n){return j.apply(this,arguments)}function j(){return(j=(0,r.A)(a().mark(function e(t,n,r){var i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i='select distinct *  where {\n  optional { $(subject)  wdt:P31  ?targetClass } # instance of\n  optional { $(subject)  wdt:P154  ?logo }\n  optional { $(subject)  wdt:P158  ?sealImage }\n# optional { $(subject)  wdt:P159  ?headquartersLocation }\n\noptional { $(subject)  wdt:P17  ?country }\noptional { $(subject)  wdt:P18  ?image }\noptional { $(subject)  wdt:P1813  ?shortName }\n\noptional { $(subject)  wdt:P355  ?subsidiary }\n# SERVICE wikibase:label { bd:serviceParam wikibase:language "fr,en,de,it" }\n}'.replace(p,r.toNT()),e.next=1,I(i,b);case 1:o=e.sent,C(t,r,o,r.doc());case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function H(e,t,n){return W.apply(this,arguments)}function W(){return(W=(0,r.A)(a().mark(function e(t,n,r){var i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i='select distinct *  where {\n\n  $(subject) wdt:P276 ?location .\n\n  optional { ?location  wdt:P2044  ?elevation }\n  optional { ?location  wdt:P131  ?region }\n  optional { ?location wdt:P625 ?coordinates }\noptional {  ?location  wdt:P17  ?country }\n\n# SERVICE wikibase:label { bd:serviceParam wikibase:language "fr,en,de,it" }\n}'.replace(p,r.toNT()),c.Rm(" location query sparql:"+i),e.next=1,I(i,b);case 1:o=e.sent,c.Rm(" location query bindings:",o),C(t,r,o,r.doc());case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function V(e,t,n){return z.apply(this,arguments)}function z(){return(z=(0,r.A)(a().mark(function e(t,n,r){var i,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i="select distinct ?city, ?state, ?country, ?homepage, ?logo, ?lat, ?long,  WHERE {\n    OPTIONAL { <".concat(r,"> <http://dbpedia.org/ontology/city> ?city }\n    OPTIONAL { ").concat(r," <http://dbpedia.org/ontology/state> ?state }\n    OPTIONAL { ").concat(r," <http://dbpedia.org/ontology/country> ?country }\n    OPTIONAL { ").concat(r," foaf:homepage ?homepage }\n    OPTIONAL { ").concat(r," foaf:lat ?lat; foaf:long ?long }\n    OPTIONAL { ").concat(r," <http://dbpedia.org/ontology/country> ?country }\n   }"),e.next=1,I(i,v);case 1:o=e.sent,C(t,r,o,r.doc()),c.Rm("Finished getDbpediaDetails.");case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}},8852(e,t,n){n.d(t,{X:()=>a});var r=n(5175),i=n(1795),a=function(e){var t,n,a=null===(t=r.M_.any(e,i.A.space("preferencesFile"),null,e.doc()))||void 0===t?void 0:t.value;if(!(a=null===(n=a)||void 0===n?void 0:n.split("/").slice(0,-2).join("/")))throw new Error("prefererencesFile is expected to exist in ".concat(e));return a}},9086(e,t,n){n.d(t,{K:()=>c,ZZ:()=>s,rg:()=>l});var r=n(5175),i=n(4158),a=n(3468),o=r.hV.store,s={};function c(e){var t=o,n=t.findTypeURIs(e),r=t.bottomTypeURIs(n),i=[];for(var a in r)i.push(a);return i[0]}function l(e,t){var n=c(t),r=s[n];return(0,i.debug)("paneUtils: Going to implement field "+t+" of type "+n),r||function(e,r){var i=(0,a.F)(e,"No handler for field "+t+" of type "+n);return r&&r.appendChild(i),i}}},9238(e,t,n){n.d(t,{A:()=>y});var r=n(467),i=n(4756),a=n.n(i),o=n(1795),s=n(3378),c=n(5175),l=n(386),u=n(3291),d=n(9612),p=n(3693);function f(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return h(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var m=s.Pt.iconBase+"noun_34653_green.svg",g=s.Pt.iconBase+"noun_Search_875351.svg",v=s.Pt.iconBase+"noun_253504.svg";function y(e,t,n,r,i,a){return w.apply(this,arguments)}function w(){return w=(0,r.A)(a().mark(function e(t,n,i,s,h,y){var w,b,A,x,E,C,k,_,S,T,R,L,I,P,N,O,M,B,D,U,F,j,H;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(D=function(){B?((0,p.L)(M,!1),(0,p.L)(L,!1),(0,p.L)(I,!1)):((0,p.L)(M,!0),(0,p.L)(L,!1),(0,p.L)(I,!1))},R=function(){return(R=(0,r.A)(a().mark(function e(t){var r,i,o,s;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=f(t),e.prev=1,r.s();case 2:if((i=r.n()).done){e.next=4;break}return o=i.value,e.next=3,h(n,o);case 3:e.next=2;break;case 4:e.next=6;break;case 5:e.prev=5,s=e.catch(1),r.e(s);case 6:return e.prev=6,r.f(),e.finish(6);case 7:case"end":return e.stop()}},e,null,[[1,5,6,7]])}))).apply(this,arguments)},T=function(e){return R.apply(this,arguments)},S=function(){return(S=(0,r.A)(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!F){e.next=1;break}j.removeChild(F),F=void 0,e.next=2;break;case 1:return e.next=2,C();case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)},_=function(e){return S.apply(this,arguments)},k=function(){return(k=(0,r.A)(a().mark(function e(){var n;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(F=t.createElement("div")).setAttribute("style","display: flex; flex-flow: wrap;"),n=F,e.next=1,(0,p.r)(t,s,U,w);case 1:n.appendChild.call(n,e.sent),F.appendChild(L),F.appendChild(I),F.appendChild(M),F.appendChild(P),j.appendChild(F);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)},C=function(){return k.apply(this,arguments)},E=function(){F&&(j.removeChild(F),F=void 0)},x=function(){return(x=(0,r.A)(a().mark(function e(r){var i;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,u.RG(t,c.M_,j,o.A.vcard("url"),void 0,"Solid ID");case 1:if(i=e.sent){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",h(n,i));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)},A=function(e){return x.apply(this,arguments)},b=function(){return(b=(0,r.A)(a().mark(function e(t,n){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s.permanent?((0,p.L)(M,!0),(0,p.L)(L,!1),(0,p.L)(I,!1)):E(),e.abrupt("return",h(t,n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)},w=function(e,t){return b.apply(this,arguments)},(L=u.kz(t)).setAttribute("data-testid","accept-button"),(I=u.x7(t)).setAttribute("data-testid","cancel-button"),P=t.createElement("div"),N=s.targetClass?d.P(s.targetClass):"item",(O=u.Qy(t,P,N,y)).setAttribute("data-testid","delete-button"),(M=u.x6(t,v,"Edit",function(e){B=!B,D()})).setAttribute("data-testid","edit-button"),B=!0,U={acceptButton:L,cancelButton:I,editButton:M,deleteButton:O},F=void 0,(j=t.createElement("div")).style.display="flex",j.style.flexDirection="row",!s.permanent&&!s.currentObject){e.next=1;break}return e.next=1,C();case 1:return i.editable&&(j.style.width="100%",i.manualURIEntry&&(H=j.appendChild(u.x6(t,m,i.idNoun,A)),l.DK(H,T,void 0)),!i.dbLookup||s.currentObject||s.permanent||j.appendChild(u.x6(t,g,i.idNoun,_))),D(),e.abrupt("return",j);case 2:case"end":return e.stop()}},e)})),w.apply(this,arguments)}},9271(e,t,n){n.d(t,{CQ:()=>v,CW:()=>g,Ei:()=>p,F8:()=>y,TH:()=>w,Vl:()=>h,Vr:()=>m,WQ:()=>f,jm:()=>c,lD:()=>o,qh:()=>d,rE:()=>l,ry:()=>u,xn:()=>s});const r=BigInt(2**32-1),i=BigInt(32);function a(e,t=!1){return t?{h:Number(e&r),l:Number(e>>i&r)}:{h:0|Number(e>>i&r),l:0|Number(e&r)}}function o(e,t=!1){const n=e.length;let r=new Uint32Array(n),i=new Uint32Array(n);for(let o=0;o<n;o++){const{h:n,l:s}=a(e[o],t);[r[o],i[o]]=[n,s]}return[r,i]}const s=(e,t,n)=>e>>>n,c=(e,t,n)=>e<<32-n|t>>>n,l=(e,t,n)=>e>>>n|t<<32-n,u=(e,t,n)=>e<<32-n|t>>>n,d=(e,t,n)=>e<<64-n|t>>>n-32,p=(e,t,n)=>e>>>n-32|t<<64-n;function f(e,t,n,r){const i=(t>>>0)+(r>>>0);return{h:e+n+(i/2**32|0)|0,l:0|i}}const h=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),m=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,g=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),v=(e,t,n,r,i)=>t+n+r+i+(e/2**32|0)|0,y=(e,t,n,r,i)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(i>>>0),w=(e,t,n,r,i,a)=>t+n+r+i+a+(e/2**32|0)|0},9287(e,t,n){n.d(t,{I1:()=>i,lx:()=>a,ts:()=>o});var r=n(675),i=function(e,t,n){var r=e.createElement("tr");return r.appendChild(e.createElement("td")).appendChild(t),r.subject=n,r},a=function(e,t){e.addEventListener("click",t)},o=function(e,t,n){var i=t.appendChild(e.createElement("div"));i.setAttribute("style",r.i.imageDivStyle),i.appendChild(n),n.setAttribute("draggable","false")}},9326(e,t,n){n.d(t,{O:()=>a,w:()=>i});var r=n(3378);function i(e,t,n){var i=e.createElement("a");i.setAttribute("href",t.uri),t.uri.startsWith("http")&&i.setAttribute("target","_blank");var a=i.appendChild(e.createElement("img"));return a.setAttribute("src",n||r.i1+"go-to-this.png"),a.setAttribute("style","margin: 0.3em;"),i}var a=function(e,t,n){var r=i(e,n);t.appendChild(r).classList.add("HoverControlHide"),t.appendChild(e.createElement("br"))}},9394(e,t,n){n.d(t,{A:()=>s});var r=n(4243),i=n(3893),a=n(7800),o=n(519);function s(e){return(0,r.A)(e)||(0,i.A)(e)||(0,a.A)(e)||(0,o.A)()}},9417(e,t,n){n.d(t,{A:()=>r});const r={authEndpoint:"",fallbackAuthEndpoint:"https://databox.me/",signupEndpoint:"https://solidproject.org/use-solid/",signupWindowHeight:600,signupWindowWidth:1024,key:"",cert:""}},9509(e,t,n){n.d(t,{r5:()=>b,rg:()=>y});var r=n(467),i=n(4756),a=n.n(i),o=n(4961),s=n(5175),c=n(7423),l=n(3378),u=n(1795),d=n(3291),p=n(3468),f=n(2465),h=n(3262);function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return g(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function v(e){"Notification"in window?"granted"===Notification.permission?new Notification(e):"denied"!==Notification.permission&&Notification.requestPermission().then(function(t){"granted"===t&&new Notification(e)}):c.R8("This browser does no t support desktop notification")}function y(e,t,n,r,i,a){return w.apply(this,arguments)}function w(){return(w=(0,r.A)(a().mark(function e(t,n,r,i,o,s){var c,l,u,d,p;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,(0,h.Uh)(t,r,i,o,s);case 1:c=e.sent,o.selectedMessage&&o.selectedMessage.sameTerm(r)&&(c.style.backgroundColor="yellow",o.selectedElement=c,n.selectedElement=c),l=!1,u=n.firstChild;case 2:if(u){e.next=3;break}return e.abrupt("continue",5);case 3:if(d=!0===o.newestfirst,!((p=c.AJAR_date)>u.AJAR_date&&d||p<u.AJAR_date&&!d)){e.next=4;break}return n.insertBefore(c,u),l=!0,e.abrupt("continue",5);case 4:u=u.nextSibling,e.next=2;break;case 5:l||n.appendChild(c);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function b(e,t,n,r){return A.apply(this,arguments)}function A(){return A=(0,r.A)(a().mark(function e(t,n,i,g){var w,b,A,x,E,C,k,_,S,T,R,L,I,P,N,O,M,B,D,U,F,j,H,W,V,z,$,J,q,K,G,Z;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return D=function(){return(D=(0,r.A)(a().mark(function e(){var t,n,r,i,o,s,c,l,u,d;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=function(){g.selectedElement?g.selectedElement.scrollIntoView({block:"center"}):z.inputRow.scrollIntoView&&z.inputRow.scrollIntoView(U)},t=function(){u&&u.selectedElement&&u.selectedElement.scrollIntoView({block:"center"})},g.selectedMessage&&(i=g.selectedMessage.doc()),$&&(o=$.doc()),(s=i||o)&&(c=new Date,l=j.leafDocumentFromDate(c),r=l.sameTerm(s)),!s||r){e.next=2;break}return d=j.dateFromLeafDocument(s),e.next=1,_(d,r);case 1:u=e.sent,H.appendChild(u),J.messageTable=u,q.messageTable=u,t(),setTimeout(t,1e3),e.next=4;break;case 2:return e.next=3,P();case 3:J.messageTable=z,q.messageTable=z;case 4:return e.next=5,O(null,n);case 5:H.addEventListener("scroll",O),g.solo&&document.body.addEventListener("scroll",O);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)},B=function(){return D.apply(this,arguments)},M=function(){return(M=(0,r.A)(a().mark(function e(t,n){var r,i,o,s,c;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!Z){e.next=1;break}return e.abrupt("return");case 1:Z=!0,r=!n,i=150;case 2:if(!(H.scrollTop<i&&J.messageTable&&!J.messageTable.initial&&J.messageTable.extendBackwards)){e.next=6;break}if(0!==H.scrollHeight){e.next=3;break}return setTimeout(O,2e3),Z=!1,e.abrupt("return");case 3:return s=H.scrollHeight-H.scrollTop,e.next=4,J.messageTable.extendBackwards();case 4:if(o=e.sent,r&&(H.scrollTop=H.scrollHeight-s),n&&n(),!o){e.next=5;break}return e.abrupt("continue",6);case 5:e.next=2;break;case 6:if(!(g.selectedMessage&&H.scrollHeight-H.scrollTop-H.clientHeight<i&&q.messageTable&&!q.messageTable.final&&q.messageTable.extendForwards)){e.next=9;break}return c=H.scrollTop,e.next=7,q.messageTable.extendForwards();case 7:if(o=e.sent,r&&(H.scrollTop=c),n&&n(),!o){e.next=8;break}return e.abrupt("continue",9);case 8:e.next=6;break;case 9:Z=!1;case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)},O=function(e,t){return M.apply(this,arguments)},N=function(){return(N=(0,r.A)(a().mark(function e(){var t,n,o;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Date,n=j.leafDocumentFromDate(t),e.next=1,_(t,!0);case 1:return o=e.sent,H.appendChild(o),H.refresh=(0,r.A)(a().mark(function e(){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,L(new Date);case 1:return e.next=2,w(i,o);case 2:v(i);case 3:case"end":return e.stop()}},e)})),s.M_.updater.addDownstreamChangeListener(n,H.refresh),z=o,q.messageTable=z,e.abrupt("return",o);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)},P=function(){return N.apply(this,arguments)},I=function(){return(I=(0,r.A)(a().mark(function e(){var t,n,r;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=j.leafDocumentFromDate(new Date)).sameTerm(q.messageTable.chatDocument)){e.next=2;break}return z.inputRow&&(z.removeChild(z.inputRow),delete z.inputRow),n=q.messageTable.chatDocument,e.next=1,P();case 1:if(!s.M_.holds(n,u.A.rdfs("seeAlso"),t,n)){r=[o.st(n,u.A.rdfs("seeAlso"),t,n)];try{s.M_.updater.update([],r)}catch(e){alert("Unable to link old chat file to new one:"+e)}}case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)},L=function(){return I.apply(this,arguments)},R=function(){return R=(0,r.A)(a().mark(function e(n,i){var o,c,p,f,v,y,w,b,x,C,_,S,T,R,L,I,P,N,O,M;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:x=function(){return(x=(0,r.A)(a().mark(function e(t){return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!C.extendedForwards){e.next=1;break}k(!1,C),C.extendedForwards=!1,b(),e.next=3;break;case 1:return e.next=2,y();case 2:q.messageTable.scrollIntoView(U);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)},b=function(){if(c){var e=C.extendedForwards?!U:U,t=C.final?"noun_T-Block_1114657_000000.svg":function(e){return e?"noun_1369237.svg":"noun_1369241.svg"}(e);c.firstChild.setAttribute("src",l.Pt.iconBase+t)}},w=function(){return(w=(0,r.A)(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,E(!1);case 1:return t=e.sent,e.abrupt("return",t);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)},y=function(){return w.apply(this,arguments)},v=function(){if(o){var e=C.extendedBack?!U:U,t=C.initial?"noun_T-Block_1114655_000000.svg":function(e){return e?"noun_1369241.svg":"noun_1369237.svg"}(e);o.firstChild.setAttribute("src",l.Pt.iconBase+t)}},f=function(){return(f=(0,r.A)(a().mark(function e(){var t;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,E(!0);case 1:return(t=e.sent)?(o&&(o.firstChild.setAttribute("src",l.Pt.iconBase+"noun_T-Block_1114655_000000.svg"),o.disabled=!0),C.initial=!0):C.extendedBack=!0,v(),e.abrupt("return",t);case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)},p=function(){return f.apply(this,arguments)},o=null,c=null,(C=t.createElement("table")).style.width="100%",C.extendBackwards=p,C.extendForwards=y,C.date=n,_=j.leafDocumentFromDate(n),C.chatDocument=_,C.fresh=!1,C.setAttribute("style","width: 100%;"),i&&(C.final=!0,z=C,q.messageTable=C,S=(0,h.LV)(F,C,V,g),U?C.insertBefore(S,C.firstChild):C.appendChild(S),C.inputRow=S),T=t.createElement("tr"),(R=T.appendChild(t.createElement("td"))).style="text-align: center; vertical-align: middle; color: #888; font-style: italic;",R.textContent=d.XV(n.toISOString(),!0),L=T.appendChild(t.createElement("td")),g.includeRemoveButton&&L.appendChild(d.x7(t,function(e){H.parentNode.removeChild(H)})),C.extendedForwards=!1,U?C.appendChild(T):C.insertBefore(T,C.firstChild),I=s.M_.statementsMatching(null,u.A.wf("message"),null,_),!i&&I.length,P=m(I),e.prev=1,P.s();case 2:if((N=P.n()).done){e.next=4;break}return O=N.value,e.next=3,A(O.object,C);case 3:e.next=2;break;case 4:e.next=6;break;case 5:e.prev=5,M=e.catch(1),P.e(M);case 6:return e.prev=6,P.f(),e.finish(6);case 7:return C.fresh=!0,e.abrupt("return",C);case 8:case"end":return e.stop()}},e,null,[[1,5,6,7]])})),R.apply(this,arguments)},T=function(e,t){return R.apply(this,arguments)},S=function(){return(S=(0,r.A)(a().mark(function e(n,r){var i,o,l,u;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=j.leafDocumentFromDate(n),e.prev=1,e.next=2,s.M_.fetcher.createIfNotExists(i);case 2:e.next=7;break;case 3:if(e.prev=3,u=e.catch(1),o=t.createElement("table"),l=o.appendChild(t.createElement("tr")),!u.response||!u.response.status||404!==u.response.status){e.next=5;break}return e.next=4,T(n,r);case 4:return e.abrupt("return",e.sent);case 5:c.Rm("*** Error NON 404 for chat file "+i),l.appendChild(p.F(t,u,"pink"));case 6:return e.abrupt("return",l);case 7:return e.next=8,T(n,r);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e,null,[[1,3]])}))).apply(this,arguments)},_=function(e,t){return S.apply(this,arguments)},k=function(e,t){if(e?U:!U)for(;t.nextSibling;)H.removeChild(t.nextSibling);else for(;t.previousSibling;)H.removeChild(t.previousSibling);(e?J:q).messageTable=t},C=function(){return(C=(0,r.A)(a().mark(function e(t){var n,r,i,o,s,c;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=t?J:q).messageTable.date,!(t&&J.limit&&r<=J.limit)){e.next=2;break}if(z){e.next=1;break}return e.next=1,P();case 1:return e.abrupt("return",!0);case 2:return e.next=3,j.loadPrevious(r,t);case 3:if((r=e.sent)||t||z){e.next=4;break}return e.next=4,P();case 4:if(r){e.next=5;break}return e.abrupt("return",!0);case 5:return i=!1,t||(o=j.leafDocumentFromDate(new Date),s=j.leafDocumentFromDate(r),i=s.sameTerm(o)),e.next=6,_(r,i);case 6:return c=e.sent,n.messageTable=c,(t?U:!U)?H.appendChild(c):H.insertBefore(c,H.firstChild),e.abrupt("return",i);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)},E=function(e){return C.apply(this,arguments)},x=function(){return x=(0,r.A)(a().mark(function e(t,n){var r,i;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,f.oy)(t)||g.showDeletedMessages){e.next=1;break}return e.abrupt("return");case 1:if(r=s.M_.any(null,u.A.sioc("has_member"),t,t.doc()),(i=s.M_.any(t,u.A.sioc("id"),null,t.doc()))&&!r&&(r=s.M_.any(null,u.A.sioc("has_member"),i,t.doc())),!g.thread){e.next=5;break}if(!s.M_.holds(t,u.A.sioc("has_reply"),g.thread)){e.next=2;break}e.next=4;break;case 2:if(!r||!r.sameTerm(g.thread)){e.next=3;break}e.next=4;break;case 3:return e.abrupt("return");case 4:e.next=6;break;case 5:if(!r){e.next=6;break}return e.abrupt("return");case 6:if(n.fresh){e.next=7;break}return e.next=7,y(F,n,t,n.fresh,g,V);case 7:case"end":return e.stop()}},e)})),x.apply(this,arguments)},A=function(e,t){return x.apply(this,arguments)},b=function(){return b=(0,r.A)(a().mark(function e(t,n){var r,i,o,c,l,p,f,h,g;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(r={},i=n.firstChild;i;i=i.nextSibling)i.AJAR_subject&&(r[i.AJAR_subject.uri]=!0);c=s.M_.each(t,u.A.wf("message"),null,n.chatDocument),l={},p=m(c),e.prev=1,p.s();case 2:if((f=p.n()).done){e.next=4;break}if(h=f.value,l[h.uri]=!0,r[h.uri]){e.next=3;break}return e.next=3,A(h,n);case 3:e.next=2;break;case 4:e.next=6;break;case 5:e.prev=5,g=e.catch(1),p.e(g);case 6:return e.prev=6,p.f(),e.finish(6);case 7:for(i=n.firstChild;i;)o=i.nextSibling,i.AJAR_subject&&!l[i.AJAR_subject.uri]&&n.removeChild(i),i=o;for(i=n.firstChild;i;i=i.nextSibling)i.AJAR_subject&&d.uS(i);case 8:case"end":return e.stop()}},e,null,[[1,5,6,7]])})),b.apply(this,arguments)},w=function(e,t){return b.apply(this,arguments)},(g=g||{}).authorDateOnLeft=!1,U="1"===g.newestFirst||!0===g.newestFirst,F=new f.YM(i,g),j=F.dateFolder,H=t.createElement("div"),F.div=H,W=H.appendChild(t.createElement("div")),V={dom:t,statusArea:W,div:W},J={messageTable:null},q={messageTable:null},g.thread&&(K=g.thread,($=s.M_.any(null,u.A.sioc("has_reply"),K,K.doc()))&&(G=s.M_.any($,u.A.dct("created"),null,$.doc()))&&(J.limit=new Date(G.value))),Z=!1,e.next=1,B();case 1:return e.abrupt("return",H);case 2:case"end":return e.stop()}},e)})),A.apply(this,arguments)}},9612(e,t,n){n.d(t,{P:()=>c});var r=n(4158),i=n(5175),a=n(1795),o=n(4961),s={log:r,ns:a.A,rdf:o};function c(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(e){return t?e.slice(0,1).toUpperCase()+e.slice(1):e}function r(e){var t="";"/"===e.slice(-1)&&(e=e.slice(0,-1));for(var r=0;r<e.length;r++)"_"!==e[r]&&"-"!==e[r]?(t+=e[r],r+1<e.length&&e[r].toUpperCase()!==e[r]&&e[r+1].toLowerCase()!==e[r+1]&&(t+=" ")):t+=" ";return"has "===t.slice(0,4)&&(t=t.slice(4)),n(t)}var a=function(e){return i.M_.any(e,s.ns.ui("label"))||i.M_.any(e,s.ns.link("message"))||i.M_.any(e,s.ns.vcard("fn"))||i.M_.any(e,s.ns.foaf("name"))||i.M_.any(e,s.ns.dct("title"))||i.M_.any(e,s.ns.dc("title"))||i.M_.any(e,s.ns.rss("title"))||i.M_.any(e,s.ns.contact("fullName"))||i.M_.any(e,i.M_.sym("http://www.w3.org/2001/04/roadmap/org#name"))||i.M_.any(e,s.ns.cal("summary"))||i.M_.any(e,s.ns.foaf("nick"))||i.M_.any(e,s.ns.as("name"))||i.M_.any(e,s.ns.schema("name"))||i.M_.any(e,s.ns.rdfs("label"))||i.M_.any(e,i.M_.sym("http://www.w3.org/2004/02/skos/core#prefLabel"))}(e);if(a)return n(a.value);if("BlankNode"===e.termType)return"...";if("Collection"===e.termType)return"("+e.elements.length+")";var o=e.uri;if(void 0===o)return e.toString();try{o=o.split("/").map(decodeURIComponent).join("/")}catch(e){for(var c=o.length-3;c>0;c--)for(var u="0123456789abcefABCDEF";"%"===o[c]&&u.indexOf(o[c+1])>=0&&u.indexOf(o[c+2])>=0;)o=o.slice(0,c)+String.fromCharCode(parseInt(o.slice(c+1,c+3),16))+o.slice(c+3)}o=l(o,"/profile/card#me"),o=l(o,"#this");var d=(o=l(o,"#me")).indexOf("#");if(d>=0)return r(o.slice(d+1));var p=o.lastIndexOf("/",o.length-2);return p>=0&&p<e.uri.length?r(o.slice(p+1)):n(decodeURIComponent(e.uri))}function l(e,t){var n=-1*t.length;return e.slice(n)===t?e.slice(0,n):e}},9922(e,t,n){n.d(t,{A:()=>a});var r=n(2284),i=n(2327);function a(e){var t=(0,i.A)(e,"string");return"symbol"==(0,r.A)(t)?t:t+""}}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var a=n[e]={id:e,loaded:!1,exports:{}};return t[e](a,a.exports,r),a.loaded=!0,a.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};r.d(i,{$_:()=>p.$,BH:()=>l,BL:()=>o.B,Iw:()=>_,Of:()=>C.Of,Pt:()=>c.Pt,Qs:()=>E,Rm:()=>u,UP:()=>d.U,Ux:()=>k.Ux,Wp:()=>A,_f:()=>g,eV:()=>m,iD:()=>x,iF:()=>y.i,ns:()=>a.A,r5:()=>h.r5,tT:()=>S,tp:()=>w.I,um:()=>o.u,vJ:()=>v,vR:()=>b,vV:()=>f.v,vt:()=>s.v});var a=r(1795),o=r(5923),s=r(6589),c=r(3378),l=r(8677),u=r(4158),d=r(7580),p=r(6127),f=r(8516),h=r(9509),m=r(8153),g=r(3605),v=r(5148),y=r(675),w=r(2174),b=r(6670),A=r(52),x=r(967),E=r(4608),C=r(1648),k=r(7134),_=r(5912),S=window?window.document:null;"undefined"!=typeof window&&(window.UI={ns:a.A,acl:o.B,aclControl:o.u,create:s.v,createTypes:_,dom:S,icons:c.Pt,language:l,log:u,login:x,matrix:d.U,media:p.$,messageArea:f.v,infiniteMessageArea:h.r5,pad:m,participation:g,preferences:v,style:y.i,table:w.I,tabs:b,utils:A,widgets:E,initHeader:C.Of,initFooter:k.Ux});const T=i.BL,R=i.um,L=i.vt,I=i.Iw,P=i.tT,N=i.Pt,O=i.r5,M=i.Ux,B=i.Of,D=i.BH,U=i.Rm,F=i.iD,j=i.UP,H=i.$_,W=i.vV,V=i.ns,z=i.eV,$=i._f,J=i.vJ,q=i.iF,K=i.tp,G=i.vR,Z=i.Wp,Q=i.Qs;export{T as acl,R as aclControl,L as create,I as createTypes,P as dom,N as icons,O as infiniteMessageArea,M as initFooter,B as initHeader,D as language,U as log,F as login,j as matrix,H as media,W as messageArea,V as ns,z as pad,$ as participation,J as preferences,q as style,K as table,G as tabs,Z as utils,Q as widgets};
//# sourceMappingURL=solid-ui.esm.min.js.map